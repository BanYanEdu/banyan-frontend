!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("inet-core"),require("rxjs"),require("inet-ui"),require("@angular/forms"),require("ngx-bootstrap"),require("ngx-bootstrap/modal"),require("@angular/router"),require("rxjs/operators"),require("ngx-gallery")):"function"==typeof define&&define.amd?define("inet-social",["exports","@angular/core","@angular/common","inet-core","rxjs","inet-ui","@angular/forms","ngx-bootstrap","ngx-bootstrap/modal","@angular/router","rxjs/operators","ngx-gallery"],e):e((t=t||self)["inet-social"]={},t.ng.core,t.ng.common,t.inetCore,t.rxjs,t.inetUi,t.ng.forms,t.ngxBootstrap,t.modal,t.ng.router,t.rxjs.operators,t.ngxGallery)}(this,(function(t,e,i,n,o,s,a,r,c,l,p,d){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};var h={OpenGraph:"open-graph",LocalNews:"localnews"},u="FRIEND",g="COMPANY",v="INDIVIDUAL",f="Bạn bè",y="Công ty",b="Công khai",x="Mình tôi",_="fa-user",w="fa-cube",k="fa-globe",S="fa-lock";var C={policy:g,display:y,member:"EVERYONE"},M={policy:u,display:f,member:"EVERYONE"},E={policy:v,display:x,member:iNet.username},I={category:!0,id:0,icon:k,display:b,value:[]},O={category:!0,id:2,icon:w,display:y,value:[C]},P={category:!0,id:3,icon:_,display:f,value:[M]},D={category:!0,id:4,icon:S,display:x,value:[E]};var F=function(){function t(t,e,i,n,s,a){var r=this;this.httpClient=t,this.coreService=e,this.photoSwipe=i,this.socketService=n,this.fileFormatService=s,this.frontViewService=a,this.viewDate="dd/MM/yyyy HH:mm",this.activityChange=new o.Subject,this.commentChange=new o.Subject,this._removeTags=["link","meta","script","style","open-graph"],this._socket=this.socketService.onMessage.subscribe((function(t){var e=t.application,i=t.message&&t.message.msgID;"iSocial-Activity"===e?r.activityChange.next(i):"iSocial-Comment"===e&&r.commentChange.next(i)}))}return t.prototype.ngOnDestroy=function(){this._socket.unsubscribe()},t.prototype.listGroups=function(t){return this.getJSON("social/member/category",null,(function(e,i){t(e&&e.elements||[],i)}))},t.prototype.invitationReceiveList=function(t,e){return this.getJSON("social/invitation",t,e)},t.prototype.invitationSendList=function(t,e){return this.getJSON("social/invitation/mylist",t,e)},t.prototype.invitationRejectList=function(t,e){return this.getJSON("social/invitation/rejectedlist",t,e)},t.prototype.invitationCreate=function(t,e){return this.postJSON("social/invitation/create",t,e)},t.prototype.invitationDelete=function(t,e){return this.postJSON("social/invitation/delete",t,e)},t.prototype.invitationReject=function(t,e){return this.postJSON("social/invitation/rejected",t,e)},t.prototype.invitationAccept=function(t,e){return this.postJSON("social/invitation/accepted",t,e)},t.prototype.invitationSearch=function(t,e){return this.postJSON("social/member/search",t,e)},t.prototype.listFriends=function(t,e){return this.getJSON("social/member/list",t,(function(t,i){var n=t&&t.items||[];n.total=t&&t.total||0,e(n,i)}))},t.prototype.groupMemberCreate=function(t,e){return this.postJSON("social/member/create",t,(function(t,i){e(t,i)}))},t.prototype.groupMemberDelete=function(t,e){return this.postJSON("social/member/delete",t,(function(t,i){e(t,i)}))},t.prototype.searchMember=function(t,e){this.coreService.searchFirmAccount(t,(function(t,i){var n=t&&t.items||[];n.total=t&&t.total||0,e(n,i)}))},t.prototype.favoriteList=function(t,e){var i=this;return this.postJSON("social/activity/favorite",t,(function(t,n){t&&t.items&&t.items.forEach((function(t){t._favorite=!0,i.indexActivity(t)})),e(t,n)}))},t.prototype.activityWall=function(t,e){var i=this;return this.getJSON("social/activity/wall",t,(function(t,n){t&&t.items&&t.items.forEach(i.indexActivity.bind(i)),e(t,n)}))},t.prototype.activityLoad=function(t,e){var i=this;return this.getJSON("social/activity/load",t,(function(t,n){t&&i.indexActivity(t),e(t,n)}))},t.prototype.activityPost=function(t,e){var i=this;return this.postForm("social/activity/post",t,(function(t,n){t&&i.indexActivity(t),e(t,n)}))},t.prototype.activityUpdate=function(t,e){var i=this;return this.postForm("social/activity/update",t,(function(t,n){t&&i.indexActivity(t),e(t,n)}))},t.prototype.activityUpdateScope=function(t,e){return this.postForm("social/activity/scope",t,e)},t.prototype.activityRemove=function(t,e){return this.getJSON("social/activity/delete",t,e)},t.prototype.activityRemoveFile=function(t,e){return this.getJSON("social/activity/binaryremove",t,e)},t.prototype.activityLikeList=function(t,e){return this.getJSON("social/activity/likelist",t,e)},t.prototype.activityLike=function(t,e){return this.getJSON("social/activity/like",t,e)},t.prototype.activityUnLike=function(t,e){return this.getJSON("social/activity/unlike",t,e)},t.prototype.pollLoad=function(t,e){return this.getJSON("social/poll/load",t,e)},t.prototype.pollResult=function(t,e){return this.getJSON("social/poll/result",t,e)},t.prototype.pollVote=function(t,e){return this.getJSON("social/poll/vote",t,e)},t.prototype.pollPost=function(t,e){return this.postForm("social/activity/pollpost",t,e)},t.prototype.pollUpdate=function(t,e){return this.postForm("social/poll/update",t,e)},t.prototype.commentWall=function(t,e){var i=this;return this.getJSON("social/comment/wall",t,(function(t,n){t&&t.items&&t.items.forEach((function(t){return i.indexActivity(t)})),e(t,n)}))},t.prototype.commentPost=function(t,e){var i=this;return this.postForm("social/comment/post",t,(function(t,n){t&&i.indexActivity(t),e(t,n)}))},t.prototype.commentUpdate=function(t,e){var i=this;return this.postForm("social/comment/update",t,(function(t,n){t&&i.indexActivity(t),e(t,n)}))},t.prototype.commentRemove=function(t,e){return this.getJSON("social/comment/delete",t,e)},t.prototype.commentLike=function(t,e){return this.getJSON("social/comment/like",t,e)},t.prototype.commentUnLike=function(t,e){return this.getJSON("social/comment/unlike",t,e)},t.prototype.activityDownLoadUrl=function(t){return iNet.getPUrl("social/activity/download")+"?"+$.param(t)},t.prototype.activityViewUrl=function(t){return iNet.getPUrl("social/activity/inlineview")+"?"+$.param(t)},t.prototype.activityViewOnlineUrl=function(t){return iNet.getPUrl("unicorn/page/social/activity-viewer")+"?"+$.param(t)},t.prototype.commentDownLoadUrl=function(t){return iNet.getPUrl("social/comment/download")+"?"+$.param(t)},t.prototype.commentViewUrl=function(t){return iNet.getPUrl("social/comment/inlineview")+"?"+$.param(t)},t.prototype.commentViewOnlineUrl=function(t){return iNet.getPUrl("unicorn/page/social/comment-viewer")+"?"+$.param(t)},t.prototype.isCommentApp=function(t){return"iSocial-Comment"===t},t.prototype.isActivityApp=function(t){return"iSocial-Activity"===t},t.prototype.viewAttachment=function(t){iNet.hasOnlineEditor&&t.pathViewOnline||t.pathViewPdf?this.frontViewService.viewInline(t.pathViewOnline||t.pathViewPdf):window.open(t.pathDownLoad,"_blank")},t.prototype.viewImages=function(t,e){this.photoSwipe.open(t,e)},t.prototype.attachmentToFiles=function(t){var e=this,i=[];return t.forEach((function(t){i.push({name:t.file,type:t.mimetype,size:t.size,url:t.pathView,id:t.gridfsUUID,image:e.isImage(t.mimetype)})})),i},t.prototype.getJSON=function(t,e,i){return this.httpClient.getJSON(iNet.getPUrl(t),e).subscribe(i,(function(t){i(null,t)}))},t.prototype.postJSON=function(t,e,i){return this.httpClient.postJSON(iNet.getPUrl(t),e).subscribe(i,(function(t){i(null,t)}))},t.prototype.postForm=function(t,e,i){return this.httpClient.post(iNet.getPUrl(t),this.buildFormData(e)).subscribe(i,(function(t){i(null,t)}))},t.prototype.buildFormData=function(t){var e=this;if(t){var i=new FormData;return Object.keys(t).forEach((function(n){if("openGraph"!==n)if("message"===n){var o=e.secureMessageHtml(t[n]);t.openGraph&&(o+=e.createOpenGraphMessage(t.openGraph)),i.append(n,o)}else i.append(n,t[n])})),i}},t.prototype.indexActivity=function(t){t&&t.uuid&&(t.path&&(t.path=this.coreService.getSsoRedirect({url:t.path,application:t.application})),t.mpath&&(t.mpath=this.coreService.getSsoRedirect({url:t.mpath,application:t.application})),t.isCreator=t.creator===iNet.username,t._editable=t.isCreator&&!t.path,t._localNewsPin="PINNEWS"===t.type,this.formatMessageDisplay(t),this._indexAttachments(t),this.indexPolicies(t))},t.prototype._indexAttachments=function(t){var e=this;t.images=[],t.files=[],t.attachments.forEach((function(i){var n={binary:i.uuid},o=t.hasOwnProperty("activityID");o?(n.activity=t.activityID,n.comment=t.uuid,i.pathView=e.commentViewUrl(n),i.pathDownLoad=e.commentDownLoadUrl(n)):(n.activity=t.uuid,i.pathView=e.activityViewUrl(n),i.pathDownLoad=e.activityDownLoadUrl(n)),e.isImage(i.mimetype)?t.images.push(i):(e._isSupportViewOnline(i.file)&&(i.pathViewOnline=o?e.commentViewOnlineUrl(n):e.activityViewOnlineUrl(n)),e._isPdf(i.file)&&(i.pathViewPdf=i.pathView),t.files.push(i))}))},t.prototype._isSupportViewOnline=function(t){return this.fileFormatService.getEditFormats().indexOf(this._getExt(t))>-1},t.prototype._isPdf=function(t){return"pdf"===this._getExt(t)},t.prototype._getExt=function(t){var e=t.split(".");return e.length>1?e[e.length-1].toLowerCase():""},t.prototype.indexPolicies=function(t){var e=this;t._policies=[],t.published?t._policies.push(I):(t.policies.forEach((function(e){if(!e.inherit){var i={member:e.category,display:e.display||e.category,policy:e.policy};t._policies.push(i)}})),t._policies=this.splitPolicies(t._policies),t._policies.forEach((function(i,n){i.hasOwnProperty("icon")||(t._policies[n]={id:i.member,display:i.display,icon:e.getIconByType(i.policy),value:[i]})}))),t._policies.length<=4?(t._policiesStr="",t._policies.forEach((function(e){e!==D&&(t._policiesStr+=e.display+", ")})),t._policiesStr=t._policiesStr.slice(0,-2)):(t._policiesStr=t._policies[0].display,t._policiesStr+=" và "+(t._policies.length-2)+" người khác")},t.prototype.getIconByType=function(t){switch(t){case g:return w;case u:return _;default:return""}},t.prototype.splitPolicies=function(t){if(t.length>0){for(var e=void 0,i=void 0,n=0;n<t.length;n++){var o=t[n];this.isAllFriend(o)?i=o:this.isAllCompany(o)?e=o:this.isOnlyMe(o)&&(t[n]=D)}i?t[t.indexOf(i)]=P:e&&(t[t.indexOf(e)]=O)}return t},t.prototype.isAllCompany=function(t){return t.display===g&&t.policy===g},t.prototype.isAllFriend=function(t){return"EVERYONE"===t.member&&t.policy===u},t.prototype.isOnlyMe=function(t){return t.member===iNet.username&&t.policy===v},t.prototype.isImage=function(t){return t.indexOf("image")>-1},t.prototype.secureMessageHtml=function(t){var e=$("<div>").html(t);return e.find(this._removeTags.join(",")).remove(),e.text()},t.prototype.formatMessageDisplay=function(t){var e=this.parseSocialDataMessage(t);e[h.OpenGraph].length>0&&(t._openGraph=e[h.OpenGraph][0]),e[h.LocalNews].length>0&&(t._localNews=e[h.LocalNews][0],t._localNews.url=t.path);var i=t.message=this.secureMessageHtml(t.message);i=(i=n.HtmlUtils.formatHtmlDisplay(i)).replace(/(https?:\/\/[^\s]+)/g,(function(t){return'<a href="'+t+'" target="_blank" rel="nofollow noopener">'+t+"</a>"})),t._displayMessage=i},t.prototype.createOpenGraphMessage=function(t){return"uri_message:link_preview:"+this.encodeBase64(JSON.stringify(this.convertLinks(t)))},t.prototype.convertLinks=function(t){var e={};return e.title=t.title,e.image=t.image,e.description=t.description,e.url=t.url,e.finalUrl=t.site_name.toUpperCase(),e},t.prototype.encodeBase64=function(t){return window.btoa(unescape(encodeURIComponent(t)))},t.prototype.createLocalNewsMessage=function(t){return this._createTagMessage(h.LocalNews,t)},t.prototype.parseSocialDataMessage=function(t){var e={};for(var i in h){e[h[i]]=[]}var n=t.message,o=n.indexOf("uri_message");if(o>-1){var s=(n=n.substring(o)).split(":");if(3===s.length&&"uri_message"===s[0]&&"link_preview"===s[1])try{var a=JSON.parse(this.decodeBase64(s[2]));e[h.OpenGraph].push(a)}catch(t){}t.message=t.message.substring(0,o)}return e},t.prototype.decodeBase64=function(t){return decodeURIComponent(escape(window.atob(t)))},t.prototype._createTagMessage=function(t,e){var i=document.createElement(t);return i.innerText=JSON.stringify(e),i.style.display="none",i.hidden=!0,i.outerHTML},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:n.HttpClientService},{type:n.CoreService},{type:s.PhotoSwipe},{type:n.WebSocketClientService},{type:s.FileFormatService},{type:s.FrontViewService}]},t}();var A=function(){function t(){}return t.decorators=[{type:e.Component,args:[{selector:"social-wall",template:"<div socialActivityList></div>"}]}],t}(),L=function(){};var N=function(){function t(t,e){this.socialService=t,this.accentService=e,this.companyMode=!0,this.companyCategories=[O,D],this.communityCategories=[I,P,D],this.groups=[],this.contacts=[],this.members=[],this.friends=[],this.searchContacts=[],this.selectContacts=[],this.showMenu=!1,this.policies=[],this.customActive=!1,this._matchContacts=[],this._params={pageSize:10,pageNumber:0,loading:!1}}return t.prototype.ngOnInit=function(){var t=this;document.body.appendChild(this.shareModal._element.nativeElement),this.onCloseMenu=this.onCloseMenu.bind(this),document.addEventListener("click",this.onCloseMenu),this.init(),setTimeout((function(){t.activity?t.setPolicies(t.activity._policies):t.setPolicies()}),100)},t.prototype.ngOnDestroy=function(){document.removeEventListener("click",this.onCloseMenu),this._modalShowObserver.unsubscribe()},t.prototype.ngAfterViewInit=function(){var t=this;this._modalShowObserver=this.shareModal.onShown.subscribe((function(){t._focusInputMember(),t.searchMember()}))},t.prototype.init=function(){var t=this;if(this.companyMode){this.categories=this.companyCategories;this.socialService.searchMember({pageSize:-1},(function(e){e.forEach((function(e){var i=t._createSocialMember({member:e.username,display:e.fullname,policy:v});i.username=e.username,t.contacts.push(i)})),t._sortMembers(t.contacts)}))}else this.categories=this.communityCategories,this.socialService.listGroups((function(e){e.forEach((function(e){var i=t._createSocialMember({display:e,member:e,policy:u});i.group=!0,t.groups.push(i),t.contacts.push(i)})),t._sortMembers(t.groups),t._sortMembers(t.contacts)})),this.socialService.listFriends({pageSize:-1},(function(e){e.forEach((function(e){var i=t._createSocialMember({member:e.usercode,display:e.fullname,policy:v});i.username=e.usercode,t.friends.push(i),t.contacts.push(i)})),t._sortMembers(t.friends),t._sortMembers(t.contacts)}));this.categories.forEach((function(e){return e._index=t._indexKeyToSearch(e.display)})),this.contacts=this.categories.slice()},t.prototype.setDefault=function(){this._resetActive(),this._resetModal(),this.closeMenu()},t.prototype.setPolicies=function(t){this.setDefault(),(!t||t.length<1)&&(t=[this.categories[0]]),1===t.length&&(t[0].category||t[0].group)?t[0].active=!0:this.customActive=!0;for(var e=[],i=[],n=0;n<t.length;n++){var o=t[n];e.push(o.display),i=i.concat(o.value)}this.policies=i,this.display=e.join(", "),this.displayIcon=t[0].icon,this.members=t},t.prototype.injectPolicies=function(t){return this.policies.length<1?t.published=!0:t.element=JSON.stringify(this.policies),t},t.prototype.selectMember=function(t){this.setPolicies([t]),this.closeMenu()},t.prototype.onCloseMenu=function(){this.isOpening()||(this.showMenu=!1)},t.prototype.openSelectCustom=function(){this.selectContacts=this.members.slice(),this.shareModal.show(),this._updateSelectContacts()},t.prototype.closeMenu=function(){this.showMenu=!1},t.prototype.openMenu=function(){this.showMenu=!0},t.prototype.searchMember=function(){var t=this._indexKeyToSearch(this._getSearchKeyword());this._matchContacts=t?this.contacts.filter((function(e){return e._index.indexOf(t)>-1||"string"==typeof e.id&&e.id.indexOf(t)>-1})):this.contacts,this._loadContacts(!0)},t.prototype.addMember=function(t){t.selected=!t.selected,t.selected?this.hasSelectedMember(t)||this.selectContacts.push(t):this.removeMember(t)},t.prototype.removeMember=function(t){var e=this.getIndexMemberSelected(t);e>-1&&(t.selected=!1,this.selectContacts.splice(e,1))},t.prototype.hasSelectedMember=function(t){return this.getIndexMemberSelected(t)>-1},t.prototype.getIndexMemberSelected=function(t){for(var e=0;e<this.selectContacts.length;e++)if(this.selectContacts[e].id===t.id)return e;return-1},t.prototype.isOpening=function(){return this.shareModal.isShown},t.prototype.cancelChanges=function(t){t.stopPropagation(),this.shareModal.hide()},t.prototype.saveChanges=function(t){t.stopPropagation(),this.setPolicies(this.selectContacts),this.shareModal.hide(),this.closeMenu()},t.prototype.onScrollContact=function(t){var e=t.target;!this._params.loading&&e.scrollHeight-(e.scrollTop+e.clientHeight)<=40&&this._loadContacts()},t.prototype._scrollTopModal=function(){this.contactList.nativeElement.scrollTop=0},t.prototype._updateSelectContacts=function(){var t=this;this.contacts.forEach((function(e){return e.selected=t.hasSelectedMember(e)}))},t.prototype._resetActive=function(){this.categories.forEach((function(t){return t.active=!1})),this.groups.forEach((function(t){return t.active=!1})),this.customActive=!1},t.prototype._resetModal=function(){this._params.loading=!1,this._params.pageNumber=0,this._matchContacts=[],this.selectContacts=[],this.searchContacts=[],this._setSearchKeyword("")},t.prototype._loadContacts=function(t){this._params.loading=!0,t&&(this._scrollTopModal(),this._params.pageNumber=0,this.searchContacts=[]),this.searchContacts=this.searchContacts.concat(this._matchContacts.slice(this._params.pageNumber*this._params.pageSize,(this._params.pageNumber+1)*this._params.pageSize)),this._params.pageNumber+=1,this._params.loading=!this._hasContacts()},t.prototype._hasContacts=function(){return this._matchContacts.length>this._params.pageNumber*this._params.pageSize},t.prototype._sortMembers=function(t){t.sort((function(t,e){return t.display.localeCompare(e.display)}))},t.prototype._indexKeyToSearch=function(t){return this.accentService.viToEn(t).toLowerCase()},t.prototype._createSocialMember=function(t){return{id:t.member,display:t.display,icon:this.socialService.getIconByType(t.policy),value:[t],_index:this._indexKeyToSearch(t.display)}},t.prototype._focusInputMember=function(){this.inputMember.nativeElement.focus()},t.prototype._setSearchKeyword=function(t){this.inputMember.nativeElement.value=t},t.prototype._getSearchKeyword=function(){return this.inputMember.nativeElement.value},t.decorators=[{type:e.Component,args:[{selector:"[socialShareMember]",template:'<div class="group-share">\n    <button (click)="$event.stopPropagation(); showMenu = !showMenu" class="share-button btn btn-light active btn-sm" tabindex="-1" [title]="display">\n        <div class="share-button_contain">\n            <div class="share-button__padding">\n                <i class="fa" [ngClass]="displayIcon"></i>\n            </div>\n            <div class="share-button__content">\n                <div>{{display}}</div>\n            </div>\n            <div>\n                <i class="fa fa-caret-down"></i>\n            </div>\n        </div>\n    </button>\n    <ul (click)="$event.stopPropagation()" class="dropdown-menu share-menu" [ngClass]="{\'show\': showMenu}">\n        <li class="dropdown-header">\n            Ai sẽ nhìn thấy nội dung này?\n        </li>\n\n        <li class="dropdown-item" *ngFor="let category of categories" (click)="selectMember(category)">\n            <i class="fa {{category.icon}} group-share-icon"></i> {{ category.display }}\n            <i [hidden]="!category.active" class="fa fa-check category-check"></i>\n        </li>\n\n        <li class="dropdown-item" (click)="openSelectCustom()">\n            <i class="fa fa-cog group-share-icon"></i> Tùy chọn...\n            <div *ngIf="customActive">\n                <div class="custom-display">{{display}}</div>\n                <i class="fa fa-check category-check"></i>\n            </div>\n        </li>\n\n        <div *ngIf="groups.length" class="seperate"></div>\n        <li *ngFor="let group of groups" class="dropdown-item" (click)="selectMember(group)">\n            <i class="fa group-share-icon" [ngClass]="group.icon"></i> {{group.display}}\n            <i [hidden]="!group.active" class="fa fa-check category-check"></i>\n        </li>\n    </ul>\n</div>\n\n<div class="modal fade" bsModal #shareModal="bs-modal" tabindex="-1" role="dialog">\n  <div class="modal-dialog">\n    <div class="modal-content">\n        <div class="modal-header">\n            <h5 class="modal-title pull-left">Chia sẻ</h5>\n            <button type="button" class="btn btn-primary btn-sm pull-right" (click)="saveChanges($event)" tabindex="-1">\n                Xong\n            </button>\n        </div>\n        <div class="modal-body">\n            <div class="auto-tag form-control contact-search">\n                <div *ngFor="let member of selectContacts" class="auto-tag-item">\n                    <span>{{member.display}}</span>\n                    <i class="fa fa-times" (click)="removeMember(member)"></i>\n                </div>\n                <input #searchInput (keyup)="searchMember()" type="text" class="auto-tag-input" placeholder="Tìm kiếm bạn bè...">\n            </div>\n\n            <div #contactList (scroll)="onScrollContact($event)" class="contact-list">\n                <div class="list-item list-avatar" *ngFor="let member of searchContacts" (click)="addMember(member)">\n                    <img *ngIf="member.username; else icon" userAvatar [usercode]="member.username" class="list-item__image">\n                    <ng-template #icon>\n                        <i class="list-item__icon fa" [ngClass]="member.icon"></i>\n                    </ng-template>\n                    <div class="list-item__content">{{member.display}}</div>\n                    <label class="checkbox-container">\n                        <input type="checkbox" [checked]="member.selected" disabled>\n                        <span class="checkmark"></span>\n                    </label>\n                </div>\n            </div>\n        </div>\n    </div>\n  </div>\n</div>\n',styles:['.auto-tag{display:flex;flex-wrap:wrap;height:auto;padding-bottom:0}.auto-tag .auto-tag-item{display:flex;align-items:center;border-radius:4px;background:#eee;padding:0 10px;white-space:nowrap;margin:0 5px 5px 0}.auto-tag .auto-tag-item i{cursor:pointer;padding:5px;margin-right:-5px}.auto-tag .auto-tag-input{border:0;outline:0}.checkbox-container{display:block;position:relative;cursor:pointer;font-size:22px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:20px;min-height:20px;margin:0}.checkbox-container input{position:absolute;opacity:0;cursor:pointer}.checkbox-container .checkmark{position:absolute;top:0;left:0;height:20px;width:20px;background-color:#eee;border-radius:4px}.checkbox-container .checkmark:after{content:"";position:absolute;display:none;left:8px;top:4px;width:5px;height:10px;border:solid #fff;border-width:0 3px 3px 0;transform:rotate(45deg)}.checkbox-container:hover .checkmark{background-color:#ccc}.checkbox-container input:checked+.checkmark{background-color:#2196f3}.checkbox-container input:checked+.checkmark:after{display:block}.list-avatar{padding:5px 10px;overflow:hidden;cursor:pointer;margin-bottom:5px;display:flex;align-items:center}.list-item__icon,.list-item__image{width:32px;height:32px;border-radius:50%}.list-item__icon{line-height:32px;text-align:center;background:rgba(0,0,0,.05);color:rgba(0,0,0,.5)}.list-item__content{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 15px;line-height:32px;flex-grow:1}',".share-menu{max-height:300px;max-width:300px;overflow:auto}.seperate{margin:5px 20px;border-top:1px solid #eee}.group-share{position:relative;display:inline-block}.group-share-icon{width:22px}.dropdown-header,.dropdown-item{position:relative;font-size:14px;cursor:pointer;padding-left:32px}.category-check{position:absolute;left:8px;top:7px}.share-button{max-width:300px}.share-button_contain{display:flex}.share-button__content,.share-button__padding{padding-right:5px}.share-button__content{overflow:hidden}.share-button__content div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.custom-display{font-size:13px;color:rgba(0,0,0,.6);line-height:15px;white-space:normal}.contact-list{height:300px;overflow:auto;margin-top:10px}@media (max-width:480px){.share-button{max-width:220px}.contact-search{max-height:140px;overflow:auto}.contact-list{height:200px}}"]}]}],t.ctorParameters=function(){return[{type:F},{type:n.AccentService}]},t.propDecorators={shareModal:[{type:e.ViewChild,args:["shareModal"]}],inputMember:[{type:e.ViewChild,args:["searchInput"]}],contactList:[{type:e.ViewChild,args:["contactList"]}],companyMode:[{type:e.Input}],activity:[{type:e.Input}]},t}();var U=function(){function t(t){this.el=t,this.hide()}return t.prototype.show=function(){this.el.nativeElement.hidden=!1},t.prototype.hide=function(){this.el.nativeElement.hidden=!0},t.decorators=[{type:e.Component,args:[{selector:"progress-indicator",template:'<div class="progress-material">\n    <div class="indeterminate"></div>\n</div>\n',styles:[":host{position:absolute;top:0;right:0;bottom:0;left:0;background:rgba(255,255,255,.5)}.progress,progress[value]{width:100%;border:none;margin:5px 0;height:5px;display:block;-moz-appearance:none;appearance:none;-webkit-appearance:none}.progress::-webkit-progress-bar,progress[value]::-webkit-progress-bar{background-color:#e2ecfe}.progress::-webkit-progress-value,progress[value]::-webkit-progress-value{background-color:#387ef5}.progress-material{position:relative;height:4px;display:block;width:100%;background-color:#e2ecfe;border-radius:2px;overflow:hidden}.progress-material .indeterminate{background-color:#387ef5}.progress-material .indeterminate:before{content:'';position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:2.1s cubic-bezier(.65,.815,.735,.395) infinite indeterminate;animation:2.1s cubic-bezier(.65,.815,.735,.395) infinite indeterminate}.progress-material .indeterminate:after{content:'';position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:2.1s cubic-bezier(.165,.84,.44,1) infinite indeterminate-short;animation:2.1s cubic-bezier(.165,.84,.44,1) infinite indeterminate-short;-webkit-animation-delay:1.15s;animation-delay:1.15s}@-webkit-keyframes indeterminate{0%{left:-35%;right:100%}100%,60%{left:100%;right:-90%}}@keyframes indeterminate{0%{left:-35%;right:100%}100%,60%{left:100%;right:-90%}}@-webkit-keyframes indeterminate-short{0%{left:-200%;right:100%}100%,60%{left:107%;right:-8%}}@keyframes indeterminate-short{0%{left:-200%;right:100%}100%,60%{left:107%;right:-8%}}"]}]}],t.ctorParameters=function(){return[{type:e.ElementRef}]},t}();var z=function(){function t(t){this.socialService=t,this.shareMemberEnable=!1,this.linkPreviewEnable=!1,this.enterPost=!1,this.showWithAnimation=!1,this.placeHolder="Nội dung chia sẻ...",this.companyMode=!0,this.onCancel=new e.EventEmitter,this.onPost=new e.EventEmitter,this.message="",this.files=[],this.removeFiles=[],this.linkRegex=/(https?:\/\/[^\s]+)/,this._clickOut=!1}return t.prototype.ngOnInit=function(){var t=this;this.postEl=this.postElement.nativeElement,this.messageEl.nativeElement.addEventListener("paste",(function(){setTimeout((function(){t.detectLink()}),0)})),this.focusOutHideForm=this.focusOutHideForm.bind(this),document.addEventListener("click",this.focusOutHideForm),this.activity&&this.editActivity(this.activity)},t.prototype.ngOnDestroy=function(){document.removeEventListener("click",this.focusOutHideForm)},t.prototype.focusOutHideForm=function(t){var e=this;t.target.isSameNode(this.postEl)||this.postEl.contains(t.target)||this._clickOut||(this._clickOut=!0,this.isFocusForm()||this.hasData()||this.isShareMemberOpening()||this.closeForm(),setTimeout((function(){e._clickOut=!1}),500))},t.prototype.isFocusForm=function(){return $(this.postEl).find(":focus").length>0},t.prototype.enterPostForm=function(t){this.enterPost&&(t.preventDefault(),this.postActivity())},t.prototype.postActivity=function(){var t=this.getData();t.message?(this.onPost.emit(t),this.indicator.show()):this.focusMessage()},t.prototype.getData=function(){for(var t={message:this.message},e=0;e<this.files.length;e++)this.files[e].id||(t["file-"+e]=this.files[e]);var i=this.getUuidFileRemoved();return i&&(t.gridfsUUID=i),this.activity&&(t.activity=this.activity.uuid),this.shareMember&&this.shareMember.injectPolicies(t),this.linkPreview&&this.linkPreview.getData()&&(t.openGraph=this.linkPreview.getData()),t},t.prototype.hasData=function(){return this.message||this.files.length},t.prototype.editActivity=function(t){this.resetForm(),this.activity=t,this.message=t.message,this.files=this.socialService.attachmentToFiles(t.attachments),this.focusMessage(),t._openGraph&&this.linkPreview&&this.linkPreview.setData(t._openGraph),this.showForm(!0),this.resizeInput()},t.prototype.resetForm=function(){this.message="",this.files.length=0,this.removeFiles.length=0,this.linkPreview&&this.linkPreview.clearData(),this.indicator&&this.indicator.hide(),this.resizeInput()},t.prototype.typeMessage=function(){this.message.trim()&&" "===this.message.slice(-1)&&this.detectLink()},t.prototype.closeForm=function(){this.resetForm(),this.hideForm(!0),this.activity&&(this.onCancel.emit(this.activity),this.activity=null)},t.prototype.showForm=function(t){var e=this;this.postEl.isShow||(this.showWithAnimation||t||(t=!0),t?(this.setFormHeight("auto"),this.postEl.style.overflow="visible"):(this.setPostHeight(),setTimeout((function(){e.setFormHeight("auto"),e.postEl.style.overflow="visible"}),400)),this.focusMessage(),this.postEl.isShow=!0)},t.prototype.hideForm=function(t){var e=this;this.postEl.isShow&&(this.showWithAnimation||t||(t=!0),t?this.setFormHeight(""):(this.setPostHeight(),setTimeout((function(){e.setFormHeight("")}),0)),this.postEl.style.overflow="hidden",this.postEl.isShow=!1)},t.prototype.isShareMemberOpening=function(){return this.shareMember&&this.shareMember.isOpening()},t.prototype.focusMessage=function(){this.messageEl.nativeElement.focus()},t.prototype.resizeInput=function(){var t=this;setTimeout((function(){t.messageAutoSize.adjust()}),0)},t.prototype.detectLink=function(){if(this.linkPreviewEnable&&this.linkPreview&&!this.linkPreview.isPreview()){var t=this.linkRegex.exec(this.message);t&&t.length>0&&this.linkPreview.setLink(t[0])}},t.prototype.setPostHeight=function(){this.setFormHeight(this.postEl.scrollHeight+"px")},t.prototype.setFormHeight=function(t){this.postEl.style.height=t},t.prototype.getUuidFileRemoved=function(){return this.removeFiles.filter((function(t){return t.id})).map((function(t){return t.id})).join(",")},t.decorators=[{type:e.Component,args:[{selector:"[activityPost]",template:'<div class="message-post" #postElement>\n    <textarea class="text-secondary"\n            rows="1"\n            [placeholder]="placeHolder"\n            #messageEl\n            appAutoSize\n            (input)="typeMessage()"\n            (keydown.esc)="closeForm()"\n            (keydown.enter)="enterPostForm($event)"\n            [(ngModel)]="message"\n            (click)="showForm()"></textarea>\n\n    <app-link-preview *ngIf="linkPreviewEnable"></app-link-preview>\n\n    <file-list class="social-block" [fileEl]="fileEl" [files]="files" (onRemove)="removeFiles.push($event)"></file-list>\n\n    <div class="message-post__bottom">\n        <button class="btn btn-light btn-sm active post-action__btn" tabindex="-1">\n            <i class="fa fa-image"></i>\n            <input #fileEl type="file" multiple class="file-post">\n        </button>\n\n        <div class="message-post__share" *ngIf="shareMemberEnable"\n             socialShareMember\n             [activity]="activity"\n             [companyMode]="companyMode"></div>\n\n        <div>\n            <button class="btn btn-light btn-sm active" (click)="closeForm()">ĐÓNG</button>\n            <button class="btn btn-primary btn-sm ml-1" (click)="postActivity()">\n                {{activity ? \'CẬP NHẬT\' : \'ĐĂNG\'}}\n            </button>\n        </div>\n    </div>\n</div>\n\n<progress-indicator></progress-indicator>\n',styles:[".social-block{display:block;margin-top:10px}:host{position:relative}.message-post{overflow:hidden;transition-duration:.3s;height:32px}.message-post__bottom{display:flex;flex-wrap:wrap;margin-top:-10px;margin-bottom:2px}.message-post__bottom>*{margin-top:10px}.message-post__share{margin-left:5px;margin-right:10px;flex-grow:1;display:inline-block}.post-action__btn{position:relative;overflow:hidden;min-width:34px}.post-avatar{float:left;height:40px;width:40px;border-radius:50%;margin-right:10px}textarea{border:0;width:100%;padding:5px 0;outline:0;background:inherit;resize:none;color:#6c757d;min-height:30px}.textarea-comment{padding:7px;background:#e3e5e5;border-radius:4px}file-chooser-list{margin:10px 0;display:block}.file-post{position:absolute;-webkit-appearance:none;-moz-appearance:none;appearance:none;top:0;right:0;bottom:0;left:0;width:100%;height:100%;opacity:0;z-index:100}"]}]}],t.ctorParameters=function(){return[{type:F}]},t.propDecorators={activity:[{type:e.Input}],shareMemberEnable:[{type:e.Input}],linkPreviewEnable:[{type:e.Input}],enterPost:[{type:e.Input}],showWithAnimation:[{type:e.Input}],placeHolder:[{type:e.Input}],companyMode:[{type:e.Input}],onCancel:[{type:e.Output}],onPost:[{type:e.Output}],postElement:[{type:e.ViewChild,args:["postElement"]}],messageEl:[{type:e.ViewChild,args:["messageEl"]}],shareMember:[{type:e.ViewChild,args:[N]}],messageAutoSize:[{type:e.ViewChild,args:[n.AutoSizeDirective]}],linkPreview:[{type:e.ViewChild,args:[s.LinkPreviewComponent]}],indicator:[{type:e.ViewChild,args:[U]}]},t}();var V=function(){function t(t){this.socialService=t,this.allowComment=!0,this.onLoad=new e.EventEmitter,this.onError=new e.EventEmitter,this.totalComments=0}return t.prototype.ngOnInit=function(){this.activity?this._loaded():this._loadActivity()},t.prototype._loadActivity=function(){var t,e=this;this.activityID?t={activity:this.activityID}:this.contextID&&this.application&&(t={contextID:this.contextID,application:this.application}),t?this.socialService.activityLoad(t,(function(t,i){i?e.onError.emit(i):t.errors?e.onError.emit(t):(e.activity=t,e._loaded())})):this.onError.emit({message:"NOT_FOUND"})},t.prototype._loaded=function(){this.onLoad.emit(this.activity)},t.decorators=[{type:e.Component,args:[{selector:"social-discussion",template:'<div *ngIf="activity" socialCommentList\n     [activity]="activity"\n     [allowComment]="allowComment"\n     (commentLoad)="totalComments = $event.total"></div>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:F}]},t.propDecorators={activityID:[{type:e.Input}],contextID:[{type:e.Input}],application:[{type:e.Input}],activity:[{type:e.Input}],allowComment:[{type:e.Input}],onLoad:[{type:e.Output}],onError:[{type:e.Output}]},t}();var T=function(){function t(t,i){this.socialService=t,this.modalService=i,this.onUpdated=new e.EventEmitter,this.onDeleted=new e.EventEmitter,this.editing=!1,this.viewDate=this.socialService.viewDate}return t.prototype.ngAfterViewInit=function(){if(this.policiesDisplay){for(var t=[],e=0;e<this.activity._policies.length;e++)if(t.push(this.activity._policies[e].display),t.length>=8){t.push("và "+(this.activity._policies.length-8)+" người khác...");break}$(this.policiesDisplay.nativeElement).tooltip({title:t.join("<br>"),html:!0})}},t.prototype.ngOnDestroy=function(){this.declineDelete()},t.prototype.activityEdit=function(){this.editing=!0},t.prototype.activityCancelEdit=function(){this.editing=!1},t.prototype.activityDelete=function(){this._modalRef=this.modalService.show(this.tmpConfirmDelete,{class:"modal-sm"})},t.prototype.confirmDelete=function(){var t=this;this.socialService.activityRemove({activity:this.activity.uuid},(function(e){e&&e.uuid&&t.onDeleted.emit(e)}))},t.prototype.declineDelete=function(){this._modalRef&&(this._modalRef.hide(),this._modalRef=null)},t.prototype.activityLike=function(){var t={activity:this.activity.uuid};this.activity.likeStatus=!this.activity.likeStatus,this.activity.likeStatus?(this.activity.likeCount++,this.socialService.activityLike(t,(function(t){}))):(this.activity.likeCount--,this.socialService.activityUnLike(t,(function(t){})))},t.prototype.activityUpdate=function(t){var e=this;this.socialService.activityUpdate(t,(function(t){t&&t.uuid&&(e.onUpdated.emit(t),e.editing=!1)}))},t.decorators=[{type:e.Component,args:[{selector:"[socialActivity]",template:'<div class="social-card">\n    <i *ngIf="activity._localNewsPin" class="social-mark fa fa-thumb-tack" title="Tin được ghim"></i>\n    <div>\n        <img userAvatar [usercode]="activity.creator" class="activity-info__avatar">\n\n        <div actionMore dropdown\n             *ngIf="activity._editable"\n             [data]="activity"\n             (onEdit)="activityEdit()"\n             (onDelete)="activityDelete()" class="social-action-more"></div>\n\n        <div style="overflow:hidden">\n            <div class="activity-info__name">\n                <b>{{ activity.fullname }}</b>\n                <span data-placement="bottom" #policiesDisplay *ngIf="activity._policiesStr">\n                    <i class="ml-1 fa fa-caret-right"></i>\n                    {{ activity._policiesStr }}\n                </span>\n            </div>\n            <div class="activity-info__time">\n                <span [title]="activity.posted | date:viewDate">{{ activity.posted | dateShortcut }}</span>\n            </div>\n        </div>\n    </div>\n\n    <div *ngIf="!editing; else activityPost">\n        <div messageBody [feed]="activity" style="margin-top:20px"></div>\n        <div class="social-block">\n            <button class="social-flat-btn" (click)="activityLike()" [ngClass]="{\'active\': activity.likeStatus}">\n                <i class="fa fa-thumbs-up"></i>\n                <span *ngIf="activity.likeCount">{{activity.likeCount}}</span>\n            </button>\n            <button class="social-flat-btn" (click)="commentList.focusForm()">\n                <i class="fa fa-comment"></i>\n                <span>{{activity.comments?.length || \'\'}}</span>\n            </button>\n        </div>\n    </div>\n\n    <div class="social-block activity-comment" socialCommentList #commentList [activity]="activity"></div>\n</div>\n\n<ng-template #activityPost>\n    <div activityPost\n         [activity]="activity"\n         [linkPreviewEnable]="true"\n         [shareMemberEnable]="true"\n         (onPost)="activityUpdate($event)"\n         (onCancel)="activityCancelEdit()" class="social-block"></div>\n</ng-template>\n\n<ng-template #tmpConfirmDelete>\n    <div class="modal-body text-center">\n        <p>Bản tin sẽ bị xoá và không thể phục hồi</p>\n        <button type="button" class="btn btn-secondary m-1" (click)="declineDelete()" >Huỷ</button>\n        <button type="button" class="btn btn-danger m-1" (click)="confirmDelete()" >Xoá</button>\n    </div>\n</ng-template>\n',styles:[".social-action-more{float:right;margin:-5px -10px 0 0}.social-flat-btn{line-height:26px;text-align:center;color:rgba(0,0,0,.5);margin-right:15px;display:inline-block;outline:0!important;border:0;padding:0 7px;background:0 0}.social-flat-btn i{line-height:inherit;font-size:16px}.social-flat-btn span{margin-left:5px}.social-flat-btn.active,.social-flat-btn:hover{color:#2067b0}.social-block{display:block;margin-top:10px}.social-card{position:relative;border-radius:2px;padding:15px;background:#fff;font-size:14px;margin-bottom:15px}.activity-info__avatar{float:left;width:40px;height:40px;border-radius:50%;overflow:hidden;margin-right:10px}.activity-info__name{color:#2067b0}.activity-info__time{font-size:12px;color:#6c757d}.activity-comment{border-top:1px solid rgba(0,0,0,.05);padding-top:5px;margin-bottom:-10px}"]}]}],t.ctorParameters=function(){return[{type:F},{type:r.BsModalService}]},t.propDecorators={activity:[{type:e.Input}],onUpdated:[{type:e.Output}],onDeleted:[{type:e.Output}],policiesDisplay:[{type:e.ViewChild,args:["policiesDisplay"]}],tmpConfirmDelete:[{type:e.ViewChild,args:["tmpConfirmDelete"]}]},t}();!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}(function(t,e){function i(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)})(e,t)}(L);var G=function(){function t(t){this.socialService=t,this.editable=!0,this.onUpdated=new e.EventEmitter,this.onDeleted=new e.EventEmitter,this.viewDate=this.socialService.viewDate}return t.prototype.commentCancelEdit=function(){this.editing=!1},t.prototype.commentEdit=function(){this.editing=!0},t.prototype.commentUpdate=function(t){var e=this;this.socialService.commentUpdate(t,(function(t){t&&t.uuid&&(e.commentCancelEdit(),e.onUpdated.emit(t))}))},t.prototype.commentDelete=function(){var t=this;this.socialService.commentRemove({comment:this.comment.uuid,activity:this.comment.activityID},(function(e){e&&e.uuid&&t.onDeleted.emit(e)}))},t.prototype.commentLike=function(){var t={activity:this.comment.activityID,comment:this.comment.uuid};this.comment.likeStatus=!this.comment.likeStatus,this.comment.likeStatus?(this.comment.likeCount++,this.socialService.commentLike(t,(function(t){}))):(this.comment.likeCount--,this.socialService.commentUnLike(t,(function(t){})))},t.decorators=[{type:e.Component,args:[{selector:"[socialComment]",template:'<div class="social-comment">\n\n    <img userAvatar [usercode]="comment.creator" class="social-comment__avatar">\n\n    <div *ngIf="!editing; else commentPost;">\n        <div actionMore dropdown\n             *ngIf="comment._editable"\n             [data]="comment"\n             (onEdit)="commentEdit()"\n             (onDelete)="commentDelete()" class="social-action-more"></div>\n        <div class="social-comment__content">\n            <b class="social-comment__name">{{ comment.fullname }} </b>\n            <span [innerHTML]="comment._displayMessage"></span>\n            <div *ngIf="comment.attachments.length" attachmentList [attachments]="comment.attachments" class="social-block"></div>\n\n            <div class="social-comment__action">\n            <span [title]="comment.posted | date:viewDate">\n                {{comment.posted | dateShortcut}}\n            </span>\n                <button class="social-flat-btn" (click)="commentLike()" [ngClass]="{\'active\': comment.likeStatus}">\n                    <i class="fa fa-thumbs-up"></i>\n                    <span *ngIf="comment.likeCount">{{comment.likeCount}}</span>\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <ng-template #commentPost>\n        <div commentPost\n             [commentEdit]="comment"\n             (onPost)="commentUpdate($event)"\n             (onCancel)="commentCancelEdit()" class="social-comment__content"></div>\n    </ng-template>\n\n</div>\n',styles:[".social-block{display:block;margin-top:10px}.social-action-more{float:right;margin:-5px -10px 0 0}.social-flat-btn{line-height:26px;text-align:center;color:rgba(0,0,0,.5);margin-right:15px;display:inline-block;outline:0!important;border:0;padding:0 7px;background:0 0}.social-flat-btn i{line-height:inherit;font-size:16px}.social-flat-btn span{margin-left:5px}.social-flat-btn.active,.social-flat-btn:hover{color:#2067b0}.social-comment{padding:7px 0;color:#212121;font-size:13px}.social-comment__avatar{width:30px;height:30px;border-radius:50%;margin-right:10px;float:left}.social-comment__content{overflow:hidden;line-height:16px}.social-comment__name{color:#2067b0}.social-comment__action{color:#6c757d;font-size:12px}.social-comment__more{cursor:pointer;color:#2067b0;margin-left:40px;padding-bottom:10px}"]}]}],t.ctorParameters=function(){return[{type:F}]},t.propDecorators={comment:[{type:e.Input}],editable:[{type:e.Input}],onUpdated:[{type:e.Output}],onDeleted:[{type:e.Output}]},t}();var R=function(){function t(){}return t.prototype.ngAfterViewInit=function(){var t=this;this.$modal=$(this.viewModal.nativeElement),this.$modal.on("hidden.bs.modal",(function(e){delete t.activity})),$(document.body).append(this.$modal)},t.prototype.ngOnDestroy=function(){this.$modal.remove()},t.prototype.viewActivity=function(t){var e=this;this.activity=t,setTimeout((function(){e.$modal.modal("show")}),100)},t.decorators=[{type:e.Component,args:[{selector:"app-social-modal-view",template:'<div #viewModal class="modal fade" tabindex="-1" role="dialog">\n    <div class="modal-dialog modal-lg" role="document">\n        <div class="modal-content">\n            <div class="modal-header">\n                <h5 class="modal-title">Thảo luận</h5>\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n            </div>\n            <div class="modal-body">\n                <div *ngIf="activity" socialActivity [activity]="activity"></div>\n            </div>\n        </div>\n    </div>\n</div>\n',styles:[""]}]}],t.ctorParameters=function(){return[]},t.propDecorators={viewModal:[{type:e.ViewChild,args:["viewModal"]}]},t}();var j=function(){function t(t){this.socialService=t}return t.prototype.ngOnChanges=function(t){t.activityId.currentValue!==t.activityId.previousValue&&this._load()},t.prototype.activityUpdated=function(t){this.activity=t},t.prototype._load=function(){var t=this;this.notFound=!1,this.socialService.activityLoad({activity:this.activityId},(function(e){e&&e.uuid?t.activity=e:t.notFound=!0}))},t.decorators=[{type:e.Component,args:[{selector:"social-activity-view",template:'<div *ngIf="activity" socialActivity [activity]="activity" (onUpdated)="activityUpdated($event)"></div>\n<h4 *ngIf="notFound" class="text-center" style="margin-top:70px">Không tìm thấy tin</h4>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:F}]},t.propDecorators={activityId:[{type:e.Input}]},t}();var H=function(){function t(){this.feed={}}return t.decorators=[{type:e.Component,args:[{selector:"[messageBody]",template:'<div *ngIf="feed._localNews; else message"\n  localNews [data]="feed._localNews"></div>\n\n<ng-template #message>\n  <a *ngIf="feed.path; else activityMessage;"\n     [href]="feed.path" target="_blank" rel="nofollow noopener" class="activity-path">\n    {{ feed.message }}\n  </a>\n  <ng-template #activityMessage>\n    <div [innerHTML]="feed._displayMessage" style="word-break:break-all"></div>\n  </ng-template>\n\n  <app-link-preview\n          *ngIf="feed._openGraph"\n          [openGraphData]="feed._openGraph"\n          [removable]="false" class="social-block"></app-link-preview>\n</ng-template>\n\n<div *ngIf="feed?.attachments?.length" attachmentList [attachments]="feed.attachments" class="social-block"></div>\n',styles:[".social-block{display:block;margin-top:10px}.activity-path{display:block;padding:10px;background:rgba(0,0,0,.02);color:#2067b0;border:1px solid rgba(0,0,0,.1)}"]}]}],t.propDecorators={feed:[{type:e.Input}]},t}();var B=function(){function t(){}return t.decorators=[{type:e.Component,args:[{selector:"[localNews]",template:'<div *ngIf="data" class="local-news">\n    <h3 class="local-news__title">\n        {{data.title}}\n    </h3>\n    <div class="local-news__image">\n        <img [src]="data.image">\n    </div>\n    <h4 class="local-news__description">\n        {{data.description}}\n    </h4>\n    <a [href]="data.url" target="_blank" class="local-news__url"></a>\n</div>',styles:[".local-news{margin:10px 0;padding:10px 0;position:relative;overflow:hidden;border-top:1px solid rgba(0,0,0,.1);border-bottom:1px solid rgba(0,0,0,.1)}.local-news__title{font:700 14px arial;color:#333;margin-bottom:5px}.local-news__description{color:#333;font:400 13px/16px arial;margin-bottom:5px;overflow:hidden}.local-news__image{position:relative;margin-right:10px;float:left;width:140px}.local-news__image img{width:100%;min-height:70px;border:1px solid rgba(0,0,0,.01)}.local-news__url{position:absolute;top:0;right:0;bottom:0;left:0;z-index:100}"]}]}],t.propDecorators={data:[{type:e.Input}]},t}();var J=function(){function t(){this.onEdit=new e.EventEmitter,this.onDelete=new e.EventEmitter}return t.prototype.ngOnInit=function(){this.data&&(this.isActivity=!this.data.activityID,this.hasAction=this.isActivity&&this.data._editable)},t.decorators=[{type:e.Component,args:[{selector:"[actionMore]",template:'<div class="action-more">\n  <i class="fa fa-ellipsis-h" dropdownToggle></i>\n  <ul *dropdownMenu class="dropdown-menu dropdown-menu-right" role="menu">\n    <li *ngIf="data._editable" role="menuitem" (click)="onEdit.emit($event)">\n      <a class="dropdown-item">\n        <i class="action-more-icon fa fa-edit"></i>\n        <span> Chỉnh sửa</span>\n      </a>\n    </li>\n    <li *ngIf="data._editable" role="menuitem" (click)="onDelete.emit($event)">\n      <a class="dropdown-item" style="color: #dc3545">\n        <i class="action-more-icon fa fa-trash"></i>\n        <span> Xóa</span>\n      </a>\n    </li>\n  </ul>\n</div>\n',styles:[".action-more{cursor:pointer;color:#6c757d;position:relative;width:30px;height:30px}.action-more ul{margin-top:-20px;font-size:13px;border:1px solid #eef2f4;box-shadow:0 0 34px 0 rgba(63,66,87,.1)}.action-more>i{width:30px;line-height:30px;text-align:center}.action-more-icon{width:20px}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={data:[{type:e.Input}],onEdit:[{type:e.Output}],onDelete:[{type:e.Output}]},t}();var W=function(){function t(t){this.socialService=t,this.category="All friends",this.members=[],this.params={pageSize:20,pageNumber:0},this.placeholder="Tìm kiếm bạn bè..."}return t.prototype.clearSearchValue=function(){},t.prototype.onSearch=function(t){this._searchMember(t)},t.prototype.ngOnInit=function(){this._searchMember("")},t.prototype.inviteFriend=function(t){t.added=!0,this.socialService.invitationCreate({member:t.username,memberName:t.fullname,type:"FRIEND",category:this.category},(function(t,e){}))},t.prototype._searchMember=function(t){var e=this;this.params.keyword!==t&&(this.params.keyword=t,this.params.pageNumber=0,clearTimeout(this._timer),this._timer=setTimeout((function(){e.socialService.invitationSearch(e.params,(function(i,n){if(e.params.keyword==t){var o=i||[],s=[];e.members=[],o.forEach((function(t){s.indexOf(t.username)<0&&(s.push(t.username),t.fullname||(t.fullname=t.username),e.members.push(t))}))}}))}),500))},t.decorators=[{type:e.Component,args:[{template:'<div class="grid-title">\n    Những người bạn có thể biết\n</div>\n<div class="grid-container">\n    <div class="grid-item" *ngFor="let member of members">\n        <img userAvatar [usercode]="member.username" class="grid-item__icon">\n        <div class="grid-item__content">\n            <div class="grid-content__ellipsis">{{member.fullname}}</div>\n            <div class="grid-content__brief">{{member.username}}</div>\n        </div>\n        <button *ngIf="!member.added;else added;" (click)="inviteFriend(member)" class="grid-item__btn btn btn-sm btn-primary" title="Thêm bạn">\n            <i class="fa fa-user-plus"></i>\n        </button>\n    </div>\n    <ng-template #added>\n        <button class="grid-item__btn btn btn-sm btn-success">\n            <i class="fa fa-check"></i>\n        </button>\n    </ng-template>\n</div>',styles:[".grid-title{color:rgba(0,0,0,.54);font-size:14px;margin:8px;font-weight:700}.grid-container{padding-bottom:20px;overflow:hidden}.grid-item{float:left;width:50%;padding:0 15px;margin-right:-1px;margin-bottom:-1px;border:1px solid rgba(0,0,0,.05);cursor:pointer;display:flex;height:90px;align-items:center}.grid-item__sm{height:80px}.grid-item__icon{width:60px;height:60px;line-height:60px;text-align:center;color:rgba(0,0,0,.54);border-radius:50%;font-size:26px;background:rgba(0,0,0,.05)}.grid-item__btn{line-height:20px;margin-left:5px}.grid-item__content{flex-grow:1;padding:0 10px 0 15px;line-height:20px;overflow:hidden;font-size:16px}.grid-content__brief,.grid-content__ellipsis{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.grid-content__brief{font-size:14px;color:rgba(0,0,0,.4)}@media (max-width:767px){.grid-item{width:100%}.grid-item__icon{width:40px;height:40px;line-height:40px}}",""]}]}],t.ctorParameters=function(){return[{type:F}]},t}();var q=function(){function t(t){this.socialService=t,this.category="Friends"}return t.prototype.ngOnInit=function(){this._loadReceiveInvite(),this._loadSendInvite()},t.prototype.acceptInvite=function(t){this.socialService.invitationAccept({member:t.inviter,category:t.category},(function(t,e){})),this.invitations.splice(this.invitations.indexOf(t),1),this.noInvitation=this.invitations.length<1},t.prototype.rejectInvite=function(t){this.socialService.invitationReject({member:t.inviter,category:t.category},(function(t,e){})),this.invitations.splice(this.invitations.indexOf(t),1),this.noInvitation=this.invitations.length<1},t.prototype.removeInvite=function(t){this.socialService.invitationDelete({member:t.usercode,category:t.category},(function(t,e){})),this.invitationsSend.splice(this.invitationsSend.indexOf(t),1),this.noInvitationSend=this.invitationsSend.length<1},t.prototype._loadReceiveInvite=function(){var t=this;this.socialService.invitationReceiveList({pageSize:-1},(function(e,i){t.invitations=e&&e.items||[],t.noInvitation=t.invitations.length<1}))},t.prototype._loadSendInvite=function(){var t=this;this.socialService.invitationSendList({pageSize:-1},(function(e,i){t.invitationsSend=e&&e.items||[],t.noInvitationSend=t.invitationsSend.length<1}))},t.decorators=[{type:e.Component,args:[{template:'<div class="grid-title">\n  Lời mời kết bạn\n</div>\n<div class="grid-container">\n  <div class="grid-item" *ngFor="let invite of invitations">\n      <img userAvatar [usercode]="invite.usercode" class="grid-item__icon">\n      <div class="grid-item__content">\n        <div class="grid-content__ellipsis">{{invite.fullname}}</div>\n          <div class="grid-content__brief">{{invite.usercode}}</div>\n      </div>\n      <button (click)="acceptInvite(invite)"\n              class="grid-item__btn btn btn-sm btn-primary"\n              title="Thêm bạn">\n          <i class="fa fa-check"></i>\n      </button>\n      <button (click)="rejectInvite(invite)"\n              class="grid-item__btn btn btn-sm btn-danger"\n              title="Từ chối">\n          <i class="fa fa-trash"></i>\n      </button>\n  </div>\n  <div class="grid-item grid-item__sm" *ngIf="noInvitation">\n      <i class="grid-item__icon fa fa-bell"></i>\n      <div class="grid-item__content">Chưa có lời mời kết bạn mới</div>\n  </div>\n</div>\n\n<div class="grid-title">\n  Lời mời đã gửi\n</div>\n<div class="grid-container">\n  <div class="grid-item" *ngFor="let invite of invitationsSend">\n      <img userAvatar [usercode]="invite.usercode" class="grid-item__icon">\n      <div class="grid-item__content">\n        <div class="grid-content__ellipsis">{{invite.username}}</div>\n        <div class="grid-content__brief">{{invite.usercode}}</div>\n      </div>\n      <button (click)="removeInvite(invite)" class="grid-item__btn btn btn-sm btn-danger">\n          <i class="fa fa-trash"></i>\n      </button>\n  </div>\n  <div class="grid-item grid-item__sm" *ngIf="noInvitationSend">\n      <i class="grid-item__icon fa fa-bell"></i>\n      <div class="grid-item__content">Chưa gửi lời mời kết bạn nào</div>\n  </div>\n</div>\n',styles:[".grid-title{color:rgba(0,0,0,.54);font-size:14px;margin:8px;font-weight:700}.grid-container{padding-bottom:20px;overflow:hidden}.grid-item{float:left;width:50%;padding:0 15px;margin-right:-1px;margin-bottom:-1px;border:1px solid rgba(0,0,0,.05);cursor:pointer;display:flex;height:90px;align-items:center}.grid-item__sm{height:80px}.grid-item__icon{width:60px;height:60px;line-height:60px;text-align:center;color:rgba(0,0,0,.54);border-radius:50%;font-size:26px;background:rgba(0,0,0,.05)}.grid-item__btn{line-height:20px;margin-left:5px}.grid-item__content{flex-grow:1;padding:0 10px 0 15px;line-height:20px;overflow:hidden;font-size:16px}.grid-content__brief,.grid-content__ellipsis{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.grid-content__brief{font-size:14px;color:rgba(0,0,0,.4)}@media (max-width:767px){.grid-item{width:100%}.grid-item__icon{width:40px;height:40px;line-height:40px}}",""]}]}],t.ctorParameters=function(){return[{type:F}]},t}();var X=function(){function t(t,e,i){var n=this;this.socialService=t,this.accentService=e,this.cacheStorage=i,this.placeholder="Tìm kiếm...",this.height="240px",this.members=[],this.selectMembers=[],this.showMembers=[],this.matchMembers=[],this._allEmployees="social_employees",this._allFriends="social_friends";var o=this.cacheStorage.getData(this._allEmployees);o?this._initMembers(JSON.parse(o)):this.cacheStorage.promiseQueue(this._allEmployees,(function(t){n.socialService.searchMember({pageSize:-1},(function(e){e&&e.length>0&&n.cacheStorage.setData(t,JSON.stringify(e)),n.cacheStorage.resolveQueue(t,n,[e])}))}),(function(t){return n._initMembers(t)})),this.cacheStorage.promiseQueue(this._allFriends,(function(t){n.socialService.listFriends({pageSize:-1},(function(e){n.cacheStorage.resolveQueue(t,n,[e])}))}),(function(t){return n._initMembers(t)}))}return t.prototype.ngOnInit=function(){this._search=this.search.nativeElement},t.prototype.resetData=function(){this.selectMembers=[],this.showMembers=[],this.matchMembers=[],this._search.value="",this.members.forEach((function(t){return delete t.selected}))},t.prototype.focusInput=function(){this._search.focus()},t.prototype.onSearch=function(){var t=this._search.value.trim();t?(t=this.accentService.viToEn(t.toLowerCase()),this.matchMembers=this.members.filter((function(e){return e._index.indexOf(t)>-1}))):this.matchMembers=this.members,this.showMembers=this.matchMembers},t.prototype.onScroll=function(){},t.prototype.addMember=function(t){t.selected=!t.selected,t.selected?this.selectMembers.push(t):this.removeMember(t)},t.prototype.removeMember=function(t){this.selectMembers.splice(this.selectMembers.indexOf(t),1)},t.prototype._initMembers=function(t){var e=this;t.forEach((function(t){return e._addMember(t)})),this._sortMembers()},t.prototype._addMember=function(t){t.username=t.username||t.usercode,this._hasMember(t)||(t._index=this.accentService.viToEn(t.fullname.toLowerCase())+" "+t.username,this.members.push(t))},t.prototype._sortMembers=function(){this.members.sort((function(t,e){return t.fullname.localeCompare(e.fullname)}))},t.prototype._hasMember=function(t){for(var e=0;e<this.members.length;e++)if(this.members[e].username===t.username)return!0},t.decorators=[{type:e.Component,args:[{selector:"[socialListUser]",template:'<div class="auto-tag form-control" style="max-height: 140px;overflow: auto;">\n  <div *ngFor="let member of selectMembers" class="auto-tag-item">\n    <span>{{member.fullname}}</span>\n    <i class="fa fa-times" (click)="removeMember(member)"></i>\n  </div>\n  <input #search (keyup)="onSearch()" type="text" class="auto-tag-input" [placeholder]="placeholder">\n</div>\n<div #contactList (scroll)="onScroll()"\n     style="overflow:auto;height: 240px;margin-top:10px">\n  <div class="list-item list-avatar" *ngFor="let member of showMembers" (click)="addMember(member)">\n    <img userAvatar [usercode]="member.username || member.usercode" class="list-item__image">\n    <div class="list-item__content">{{member.fullname}}</div>\n    <label class="checkbox-container">\n      <input type="checkbox" [checked]="member.selected" disabled>\n      <span class="checkmark"></span>\n    </label>\n  </div>\n</div>',styles:['.auto-tag{display:flex;flex-wrap:wrap;height:auto;padding-bottom:0}.auto-tag .auto-tag-item{display:flex;align-items:center;border-radius:4px;background:#eee;padding:0 10px;white-space:nowrap;margin:0 5px 5px 0}.auto-tag .auto-tag-item i{cursor:pointer;padding:5px;margin-right:-5px}.auto-tag .auto-tag-input{border:0;outline:0}.checkbox-container{display:block;position:relative;cursor:pointer;font-size:22px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:20px;min-height:20px;margin:0}.checkbox-container input{position:absolute;opacity:0;cursor:pointer}.checkbox-container .checkmark{position:absolute;top:0;left:0;height:20px;width:20px;background-color:#eee;border-radius:4px}.checkbox-container .checkmark:after{content:"";position:absolute;display:none;left:8px;top:4px;width:5px;height:10px;border:solid #fff;border-width:0 3px 3px 0;transform:rotate(45deg)}.checkbox-container:hover .checkmark{background-color:#ccc}.checkbox-container input:checked+.checkmark{background-color:#2196f3}.checkbox-container input:checked+.checkmark:after{display:block}.list-avatar{padding:5px 10px;overflow:hidden;cursor:pointer;margin-bottom:5px;display:flex;align-items:center}.list-item__icon,.list-item__image{width:32px;height:32px;border-radius:50%}.list-item__icon{line-height:32px;text-align:center;background:rgba(0,0,0,.05);color:rgba(0,0,0,.5)}.list-item__content{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 15px;line-height:32px;flex-grow:1}']}]}],t.ctorParameters=function(){return[{type:F},{type:n.AccentService},{type:n.CacheStorageService}]},t.propDecorators={placeholder:[{type:e.Input}],height:[{type:e.Input}],search:[{type:e.ViewChild,args:["search"]}]},t}();var K=function(){function t(){this.title="Thêm thành viên",this.onSelect=new e.EventEmitter}return t.prototype.ngOnInit=function(){document.body.appendChild(this.modal._element.nativeElement)},t.prototype.ngOnDestroy=function(){this.modal._element.nativeElement.remove()},t.prototype.open=function(){this.listUser.resetData(),this.modal.show()},t.prototype.onShown=function(){this.listUser.focusInput(),this.listUser.onSearch()},t.prototype.onSave=function(){this.onSelect.emit(this.listUser.selectMembers),this.modal.hide()},t.prototype.onCancel=function(){this.modal.hide()},t.decorators=[{type:e.Component,args:[{selector:"[socialGroupMember]",template:'<div class="modal fade" bsModal #modal="bs-modal" (onShown)="onShown()" tabindex="-1" role="dialog">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title pull-left">Thêm thành viên</h5>\n        <button type="button" class="close pull-right" (click)="modal.hide()" tabindex="-1">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <div socialListUser #listUser></div>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-primary" (click)="onSave()">Lưu</button>\n        <button type="button" class="btn btn-secondary" (click)="onCancel()">Đóng</button>\n      </div>\n    </div>\n  </div>\n</div>\n',styles:[""]}]}],t.ctorParameters=function(){return[]},t.propDecorators={title:[{type:e.Input}],onSelect:[{type:e.Output}],modal:[{type:e.ViewChild,args:["modal"]}],listUser:[{type:e.ViewChild,args:["listUser"]}]},t}();var Q=function(){function t(t){this.socialService=t,this.onCreate=new e.EventEmitter}return t.prototype.ngOnInit=function(){this._input=this.inputGroup.nativeElement,document.body.appendChild(this.modal._element.nativeElement)},t.prototype.ngOnDestroy=function(){this.modal._element.nativeElement.remove()},t.prototype.open=function(){this._input.value="",this.listUser.resetData(),this.modal.show()},t.prototype.onShown=function(){this._input.focus(),this.listUser.onSearch()},t.prototype.onSave=function(){var t=this,e={category:this._input.value.trim(),member:this.listUser.selectMembers.map((function(t){return t.username})).join(",")};e.category?e.member?(this.socialService.groupMemberCreate(e,(function(e){t.onCreate.emit(e)})),this.modal.hide()):this.listUser.focusInput():this._input.focus()},t.prototype.onCancel=function(){this.modal.hide()},t.decorators=[{type:e.Component,args:[{selector:"[socialGroupCreate]",template:'<div class="modal fade" bsModal #modal="bs-modal" (onShown)="onShown()" tabindex="-1" role="dialog">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title pull-left">Tạo nhóm</h5>\n        <button type="button" class="close pull-right" (click)="modal.hide()" tabindex="-1">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <div class="form-group">\n          <label>Tên nhóm</label>\n          <input #inputGroup type="text" class="form-control">\n        </div>\n        <div class="form-group">\n          <label>Thêm thành viên</label>\n          <div socialListUser #listUser></div>\n        </div>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-primary" (click)="onSave()">Tạo nhóm</button>\n        <button type="button" class="btn btn-secondary" (click)="onCancel()">Đóng</button>\n      </div>\n    </div>\n  </div>\n</div>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:F}]},t.propDecorators={onCreate:[{type:e.Output}],modal:[{type:e.ViewChild,args:["modal"]}],inputGroup:[{type:e.ViewChild,args:["inputGroup"]}],listUser:[{type:e.ViewChild,args:["listUser"]}]},t}();var Y=function(){function t(t,e,i,n){this.socialService=t,this.accentService=e,this.router=i,this.modalService=n,this.friends=[],this.members=[],this._prefix="/social/friend",this.placeholder="Tìm kiếm...",this._loadAllFriends()}return t.prototype.onSearch=function(t){this.searching=!!t,t?(t=this.accentService.viToEn(t),this.viewGroups?this.friends.forEach((function(e){e.hidden=e._index.indexOf(t)<0})):this.members.forEach((function(e){e.hidden=e._index.indexOf(t)<0}))):this.viewGroups?this.friends.forEach((function(t){return delete t.hidden})):this.members.forEach((function(t){return delete t.hidden}))},t.prototype.clearSearchValue=function(){},t.prototype.ngOnInit=function(){var t=this;this._router=this.router.events.pipe(p.filter((function(t){return t instanceof l.NavigationEnd}))).subscribe((function(){t._actionView()})),this._actionView()},t.prototype.ngOnDestroy=function(){this._router.unsubscribe()},t.prototype.createGroup=function(){this.modalCreateMember.open()},t.prototype.groupCreated=function(){this._loadGroups(),this._loadAllFriends()},t.prototype.viewGroup=function(t){this.router.navigate([this._prefix+"/"+t])},t.prototype.removeGroup=function(t,e){this.groupActive=t,this.modalGroupDeleteRef=this.modalService.show(e)},t.prototype.onDeleteGroup=function(){var t=this;this.modalGroupDeleteRef.hide(),this._loadFriends(this.groupActive,(function(e){t.socialService.groupMemberDelete({category:t.groupActive,member:t._getMemberStr(e)},(function(){t._loadGroups(),t._loadAllFriends(),t.viewGroups||t.toGroups()}))})),this.groups.splice(this.groups.indexOf(this.groupActive),1)},t.prototype.removeFriend=function(t,e){this.modalMemberDeleteRef=this.modalService.show(e),this.memberActive=t},t.prototype.onDeleteMember=function(){var t=this,e=[];this.memberActive.categories?this.memberActive.categories.forEach((function(i){e.push(t._deleteMemberPromise(t.memberActive.usercode,i))})):e.push(this._deleteMemberPromise(this.memberActive.usercode,this.memberActive.category)),Promise.all(e).then((function(e){t.groupView&&t._loadMembers(),t._loadAllFriends()})),this.modalMemberDeleteRef.hide()},t.prototype._deleteMemberPromise=function(t,e){var i=this;return new Promise((function(n,o){i.socialService.groupMemberDelete({category:e,member:t},n)}))},t.prototype.addMemberGroup=function(){this.modalAddMember.open()},t.prototype.saveMemberGroup=function(t){var e=this;this.socialService.groupMemberCreate({category:this.groupView,member:this._getMemberStr(t)},(function(){e._loadMembers(),e._loadAllFriends()}))},t.prototype.toGroups=function(){this.router.navigate([this._prefix])},t.prototype._viewGroup=function(){this.viewGroups=!0,this.groupView="",this.groups||this._loadGroups()},t.prototype._loadGroups=function(){var t=this;this.noGroups=!1,this.socialService.listGroups((function(e){t.groups=e,t.noGroups=e.length<1}))},t.prototype._viewGroupMember=function(t){this.viewMembers=!0,this.members=[],this.groupView=t,this._loadMembers()},t.prototype._loadMembers=function(){var t=this;this._loadFriends(this.groupView,(function(e){return t.members=e}))},t.prototype._loadAllFriends=function(){var t=this;this.friends=[],this.noFriends=!1,this._loadFriends("",(function(e){var i=[];e.forEach((function(e){var n=i.indexOf(e.usercode);n<0?(i.push(e.usercode),e.categories=[e.category],t.friends.push(e)):t.friends[n].categories.push(e.category)})),t.noFriends=t.friends.length<1}))},t.prototype._loadFriends=function(t,e){var i=this;this.socialService.listFriends({pageSize:-1,category:t},(function(t){t.forEach((function(t){t._index=i._indexSearch(t.fullname)+" "+t.usercode})),e(t)}))},t.prototype._getMemberStr=function(t){return t.map((function(t){return t.usercode||t.username})).join(",")},t.prototype._actionView=function(){this.viewGroups=this.viewMembers=!1;var t=this.router.url.split("/")[3];this.clearSearchValue(),t?this._viewGroupMember(decodeURIComponent(t)):this._viewGroup()},t.prototype._indexSearch=function(t){return this.accentService.viToEn(t.toLowerCase())},t.decorators=[{type:e.Component,args:[{template:'<div *ngIf="viewGroups; else memberTemplate">\n  <div class="group-toolbar">\n    <button *ngIf="viewGroups" class="btn btn-primary btn-sm" (click)="createGroup()">\n      <i class="fa fa-plus"></i>\n      <span>Tạo nhóm</span>\n    </button>\n  </div>\n  <div *ngIf="!searching">\n    <div class="grid-title">Nhóm</div>\n    <div class="grid-container">\n      <div class="grid-item" *ngFor="let group of groups" (click)="viewGroup(group)">\n        <i class="grid-item__icon fa fa-users"></i>\n        <div class="grid-item__content" [title]="group">\n          <div class="grid-content__ellipsis">{{group}}</div>\n        </div>\n        <button (click)="$event.stopPropagation(); removeGroup(group, templateConfirmGroup)"\n                class="btn btn-sm btn-danger grid-item__btn"\n                title="Xóa nhóm">\n          <i class="fa fa-trash"></i>\n        </button>\n      </div>\n      <div class="grid-item" *ngIf="noGroups">\n          <i class="grid-item__icon fa fa-bell"></i>\n          <div class="grid-item__content">Chưa có nhóm được tạo</div>\n      </div>\n    </div>\n  </div>\n  <div class="grid-title">Bạn bè</div>\n  <div class="grid-container">\n    <div class="grid-item" *ngFor="let friend of friends" [hidden]="friend.hidden">\n      <img userAvatar [usercode]="friend.usercode" class="grid-item__icon">\n      <div class="grid-item__content">\n        <div class="grid-content__ellipsis">{{friend.fullname}}</div>\n        <div class="grid-content__brief">{{friend.usercode}}</div>\n        \x3c!--<div>--\x3e\n          \x3c!--<div *ngFor="let group of friend.categories" class="group-item">{{group}}</div>--\x3e\n        \x3c!--</div>--\x3e\n      </div>\n      <button (click)="removeFriend(friend, templateConfirmMember)"\n              class="btn btn-sm btn-danger grid-item__btn"\n              title="Xóa bạn">\n        <i class="fa fa-trash"></i>\n      </button>\n    </div>\n    <div class="grid-item grid-item__sm" *ngIf="noFriends">\n      <i class="grid-item__icon fa fa-bell"></i>\n      <div class="grid-item__content">Chưa có bạn bè</div>\n    </div>\n  </div>\n</div>\n\n<ng-template #memberTemplate>\n  <div class="group-toolbar">\n    <button class="btn btn-primary btn-sm" (click)="toGroups()">\n      <i class="fa fa-arrow-left"></i>\n      <span>Trở về</span>\n    </button>\n    <button class="btn btn-primary btn-sm" (click)="addMemberGroup()">\n      <i class="fa fa-plus"></i>\n      <span>Thêm thành viên</span>\n    </button>\n    <button class="btn btn-danger btn-sm" (click)="removeGroup(groupView, templateConfirmGroup)">\n      <i class="fa fa-trash"></i>\n      <span>Xóa nhóm</span>\n    </button>\n  </div>\n\n  <div class="grid-title">{{groupView}}</div>\n\n  <div class="grid-container">\n    <div class="grid-item" *ngFor="let friend of members" [hidden]="friend.hidden">\n      <img userAvatar [usercode]="friend.usercode" class="grid-item__icon">\n      <div class="grid-item__content">\n        <div class="grid-content__ellipsis">{{friend.fullname}}</div>\n        <div class="grid-content__brief">{{friend.usercode}}</div>\n      </div>\n      <button (click)="removeFriend(friend, templateConfirmMember)"\n              class="btn btn-sm btn-danger grid-item__btn"\n              title="Xóa bạn">\n        <i class="fa fa-trash"></i>\n      </button>\n    </div>\n    <div class="grid-item grid-item__sm" *ngIf="members && !members.length">\n        <i class="grid-item__icon fa fa-bell"></i>\n        <div class="grid-item__content">Chưa có thành viên trong nhóm</div>\n    </div>\n  </div>\n\n</ng-template>\n\n<div socialGroupCreate #modalCreateMember (onCreate)="groupCreated()"></div>\n<div socialGroupMember #modalAddMember (onSelect)="saveMemberGroup($event)"></div>\n\n<ng-template #templateConfirmGroup>\n  <div class="modal-header">\n    <h4 class="modal-title pull-left">Xóa nhóm</h4>\n    <button type="button" class="close pull-right" (click)="modalGroupDeleteRef.hide()">\n      <span aria-hidden="true">&times;</span>\n    </button>\n  </div>\n  <div class="modal-body">\n    Xóa <b>{{groupActive}}</b> khỏi danh sách nhóm?\n  </div>\n  <div class="modal-footer">\n    <button type="button" class="btn btn-danger" (click)="onDeleteGroup()">Xóa nhóm</button>\n    <button type="button" class="btn btn-secondary" (click)="modalGroupDeleteRef.hide()">Hủy</button>\n  </div>\n</ng-template>\n<ng-template #templateConfirmMember>\n  <div class="modal-header">\n    <h4 class="modal-title pull-left">Xóa bạn bè</h4>\n    <button type="button" class="close pull-right" (click)="modalMemberDeleteRef.hide()">\n      <span aria-hidden="true">&times;</span>\n    </button>\n  </div>\n  <div class="modal-body">\n    Xóa <b>{{memberActive.fullname}}</b> khỏi nhóm\n    <b>{{memberActive.categories ? memberActive.categories.join(\', \') : memberActive.category}}</b>?\n  </div>\n  <div class="modal-footer">\n    <button type="button" class="btn btn-danger" (click)="onDeleteMember()">Xóa bạn</button>\n    <button type="button" class="btn btn-secondary" (click)="modalMemberDeleteRef.hide()">Hủy</button>\n  </div>\n</ng-template>',styles:[".grid-title{color:rgba(0,0,0,.54);font-size:14px;margin:8px;font-weight:700}.grid-container{padding-bottom:20px;overflow:hidden}.grid-item{float:left;width:50%;padding:0 15px;margin-right:-1px;margin-bottom:-1px;border:1px solid rgba(0,0,0,.05);cursor:pointer;display:flex;height:90px;align-items:center}.grid-item__sm{height:80px}.grid-item__icon{width:60px;height:60px;line-height:60px;text-align:center;color:rgba(0,0,0,.54);border-radius:50%;font-size:26px;background:rgba(0,0,0,.05)}.grid-item__btn{line-height:20px;margin-left:5px}.grid-item__content{flex-grow:1;padding:0 10px 0 15px;line-height:20px;overflow:hidden;font-size:16px}.grid-content__brief,.grid-content__ellipsis{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.grid-content__brief{font-size:14px;color:rgba(0,0,0,.4)}@media (max-width:767px){.grid-item{width:100%}.grid-item__icon{width:40px;height:40px;line-height:40px}}",".group-toolbar{margin:-20px -15px 20px;padding:7px 15px;background:rgba(0,0,0,.03)}.group-item{display:inline-block;margin-top:5px;font-size:12px;line-height:20px;padding:0 5px;overflow:hidden;border-radius:2px;color:#fff;background:#007bff;margin-right:5px}"]}]}],t.ctorParameters=function(){return[{type:F},{type:n.AccentService},{type:l.Router},{type:r.BsModalService}]},t.propDecorators={modalCreateMember:[{type:e.ViewChild,args:["modalCreateMember"]}],modalAddMember:[{type:e.ViewChild,args:["modalAddMember"]}]},t}();var Z=function(){function t(t){this.socialService=t,this.placeholder="Nội dung thảo luận..",this.onCancel=new e.EventEmitter,this.onPost=new e.EventEmitter,this.message="",this.files=[],this.removeFiles=[]}return t.prototype.ngOnInit=function(){this.commentEdit&&this.editComment(this.commentEdit)},t.prototype.enterPost=function(t){t.preventDefault(),this.doPost()},t.prototype.doPost=function(){var t=this.getData();if(!t.message)return this.focusMessage();this.onPost.emit(t),this.indicator.show()},t.prototype.doCancel=function(){this.onCancel.emit(this.commentEdit),this.commentEdit&&this.resetForm()},t.prototype.getData=function(){for(var t={message:this.message},e=0;e<this.files.length;e++)this.files[e].id||(t["file-"+e]=this.files[e]);return this.commentEdit&&(t.activity=this.commentEdit.activityID,t.comment=this.commentEdit.uuid,t.gridfsUUID=this._getRemoveFiles()),t},t.prototype.editComment=function(t){this.resetForm(),this.commentEdit=t,this.files=this.socialService.attachmentToFiles(t.attachments),this.message=t.message,this.focusMessage(),this._resizeInput()},t.prototype.resetForm=function(){this.message="",this.files.length=0,this.removeFiles.length=0,this._resizeInput(),this.indicator&&this.indicator.hide()},t.prototype.focusMessage=function(){this.messageEl.nativeElement.focus()},t.prototype._getRemoveFiles=function(){return this.removeFiles.filter((function(t){return t.id})).map((function(t){return t.id})).join(",")},t.prototype._resizeInput=function(){var t=this;setTimeout((function(){t.messageAutoSize.adjust()}),0)},t.decorators=[{type:e.Component,args:[{selector:"[commentPost]",template:'<div class="comment-input">\n    <textarea class="comment-textarea"\n              rows="1"\n              [placeholder]="placeholder"\n              #messageEl\n              appAutoSize\n              (keydown.esc)="doCancel()"\n              (keydown.enter)="enterPost($event)"\n              [(ngModel)]="message"></textarea>\n    <i class="comment-file__icon fa fa-image">\n        <input #fileEl type="file" multiple class="file-post">\n    </i>\n</div>\n\n<file-list class="social-block" [files]="files" [fileEl]="fileEl" (onRemove)="removeFiles.push($event)"></file-list>\n\n<div *ngIf="commentEdit">\n    <button class="btn btn-primary btn-sm mr-1" (click)="doPost()">CẬP NHẬT</button>\n    <button class="btn btn-light btn-sm active" (click)="doCancel()">HUỶ</button>\n</div>\n\n<progress-indicator></progress-indicator>\n',styles:[".social-block{display:block;margin-top:10px}:host{position:relative}.comment-input{position:relative;background:#e3e5e5;border-radius:4px;padding:7px 10px 3px;margin-bottom:10px}.comment-textarea{border:0;padding:0 40px 0 0;line-height:16px;margin:0;outline:0!important;width:100%;background:0 0}.comment-file__icon{position:absolute;right:0;top:0;width:30px;height:30px;line-height:30px;text-align:center;cursor:pointer}.file-post{position:absolute;-webkit-appearance:none;-moz-appearance:none;appearance:none;top:0;right:0;bottom:0;left:0;width:100%;height:100%;opacity:0;z-index:100}"]}]}],t.ctorParameters=function(){return[{type:F}]},t.propDecorators={placeholder:[{type:e.Input}],commentEdit:[{type:e.Input}],onCancel:[{type:e.Output}],onPost:[{type:e.Output}],messageEl:[{type:e.ViewChild,args:["messageEl"]}],messageAutoSize:[{type:e.ViewChild,args:[n.AutoSizeDirective]}],indicator:[{type:e.ViewChild,args:[U]}]},t}();var tt=function(){function t(t){var i=this;this.socialService=t,this.allowComment=!0,this.commentLoad=new e.EventEmitter,this.commentParams={pageSize:5,pageNumber:0},this.viewDate=this.socialService.viewDate,this._commentChange=this.socialService.commentChange.subscribe((function(t){t===i.activity.uuid&&i.load(!0)}))}return t.prototype.ngOnInit=function(){},t.prototype.ngOnChanges=function(t){this.load(!0)},t.prototype.ngOnDestroy=function(){this._commentChange.unsubscribe()},t.prototype.focusForm=function(){this.commentPost&&this.commentPost.focusMessage()},t.prototype.commentCreate=function(t){t.activity=this.activity.uuid,this.socialService.commentPost(t,this.commentPosted.bind(this))},t.prototype.load=function(t){var e=this;t?this.commentParams.pageNumber=0:this.commentParams.pageNumber++,this.commentParams.activity=this.activity.uuid,this.activity.comments||(this.activity.comments=[]),this.socialService.commentWall(this.commentParams,(function(t){(t&&t.items||[]).forEach((function(t){return e.replaceOrAddComment(t)})),e.activity.comments.sort((function(t,e){return e.posted-t.posted})),e.remainComments=t.total-(e.commentParams.pageNumber+1)*e.commentParams.pageSize||0,e.commentLoad.emit(t)}))},t.prototype.commentUpdated=function(t){this.replaceOrAddComment(t)},t.prototype.commentDeleted=function(t){this.removeComment(t.uuid)},t.prototype.commentPosted=function(t,e){t&&t.uuid&&this.commentPost&&(this.commentPost.resetForm(),this.replaceOrAddComment(t,!0))},t.prototype.getIndexComment=function(t){for(var e=0;e<this.activity.comments.length;e++)if(this.activity.comments[e].uuid===t)return e;return-1},t.prototype.replaceOrAddComment=function(t,e){var i=this.getIndexComment(t.uuid);i>-1?this.activity.comments[i]=t:this.activity.comments[e?"unshift":"push"](t)},t.prototype.removeComment=function(t){var e=this.getIndexComment(t);e>-1&&this.activity.comments.splice(e,1)},t.decorators=[{type:e.Component,args:[{selector:"[socialCommentList]",template:'<div *ngIf="allowComment" class="social-comment">\n    <img userAvatar class="social-comment__avatar">\n    <div commentPost (onPost)="commentCreate($event)" class="social-comment__content"></div>\n</div>\n\n<div socialComment\n     *ngFor="let comment of activity.comments"\n     [comment]="comment"\n     (onUpdated)="commentUpdated($event)"\n     (onDeleted)="commentDeleted($event)"\n>\n</div>\n\n<div *ngIf="remainComments > 0" (click)="load()" class="social-comment__more">Xem thêm..</div>\n',styles:[".social-block{display:block;margin-top:10px}.social-action-more{float:right;margin:-5px -10px 0 0}.social-flat-btn{line-height:26px;text-align:center;color:rgba(0,0,0,.5);margin-right:15px;display:inline-block;outline:0!important;border:0;padding:0 7px;background:0 0}.social-flat-btn i{line-height:inherit;font-size:16px}.social-flat-btn span{margin-left:5px}.social-flat-btn.active,.social-flat-btn:hover{color:#2067b0}.social-comment{padding:7px 0;color:#212121;font-size:13px}.social-comment__avatar{width:30px;height:30px;border-radius:50%;margin-right:10px;float:left}.social-comment__content{overflow:hidden;line-height:16px}.social-comment__name{color:#2067b0}.social-comment__action{color:#6c757d;font-size:12px}.social-comment__more{cursor:pointer;color:#2067b0;margin-left:40px;padding-bottom:10px}"]}]}],t.ctorParameters=function(){return[{type:F}]},t.propDecorators={activity:[{type:e.Input}],allowComment:[{type:e.Input}],commentLoad:[{type:e.Output}],commentPost:[{type:e.ViewChild,args:[Z]}]},t}();var et=function(){function t(t){var e=this;this.socialService=t,this.postEnable=!0,this.scroller=document,this.type="",this.application="",this.loader=function(t,i){return e.doLoadWall(t,i)},this.activities=[],this.showLoading=!0,this.hasMore=!1,this.params={pageSize:5,pageNumber:0},this._activityChange=this.socialService.activityChange.subscribe((function(t){t&&e.socialService.activityLoad({activity:t},(function(t){t&&t.uuid&&e._addActivity(t,!0)}))}))}return t.prototype.ngOnInit=function(){this.initScroller(),this.loadWall(!0)},t.prototype.ngOnDestroy=function(){this.removeEventScroller(),this._activityChange.unsubscribe()},t.prototype.removeActivityById=function(t){for(var e=0;e<this.activities.length;e++){if(this.activities[e].uuid===t)return void this.activities.splice(e,1)}},t.prototype.loadWall=function(t){var e=this;t&&(this.clearWall(),this.params.pageNumber=0,this.showLoading=!0,this.type&&(this.params.type=this.type),this.application&&(this.params.application=this.application)),this._loading=!0,this.loader(this.params,(function(t,i){return e._renderWall(t)}))},t.prototype.doLoadWall=function(t,e){this.socialService.activityWall(t,e)},t.prototype.clearWall=function(){this.activities.length=0},t.prototype._renderWall=function(t){var e=this;t&&((t.items||[]).forEach((function(t){return e._addActivity(t)})),this.hasMore=t.total>this.activities.length);this.showLoading=!1,setTimeout((function(){e._loading=!1,e._scrollBottomListener()}),1e3)},t.prototype.activityCreate=function(t){t.activity?this.socialService.activityUpdate(t,this._activityPosted.bind(this)):this.socialService.activityPost(t,this._activityPosted.bind(this))},t.prototype.activityUpdated=function(t){for(var e=0;e<this.activities.length;e++)if(this.activities[e].uuid===t.uuid)return void(this.activities[e]=t);this.activities.unshift(t)},t.prototype.activityDeleted=function(t){this.removeActivityById(t.uuid)},t.prototype.initScroller=function(){this._scrollBottomListener=this._scrollBottomListener.bind(this),this.scroller&&this.initEventScroller(this.scroller)},t.prototype.scrollToTop=function(){this.scroller&&(this.scroller.scrollTop=0)},t.prototype.initEventScroller=function(t){this.scroller=t,this.scroller.addEventListener("scroll",this._scrollBottomListener)},t.prototype.removeEventScroller=function(){this.scroller&&this.scroller.removeEventListener("scroll",this._scrollBottomListener)},t.prototype._scrollBottomListener=function(t){if(!this._loading&&this.hasMore){var e=t&&t.target||this.scroller,i=e.scrollingElement||e;if(i)i.scrollHeight-i.scrollTop-i.clientHeight<150&&(this.params.pageNumber++,this.loadWall())}},t.prototype._activityPosted=function(t,e){t&&t.uuid&&(this.activityPost.resetForm(),this.activityPost.hideForm(!0),this._addActivity(t,!0))},t.prototype._addActivity=function(t,e){this.removeActivityById(t.uuid),e?this.activities.unshift(t):this.activities.push(t)},t.decorators=[{type:e.Component,args:[{selector:"[socialActivityList]",template:'<div *ngIf="postEnable" class="social-card"\n     activityPost\n     #activityPost\n     [shareMemberEnable]="true"\n     [linkPreviewEnable]="true"\n     (onPost)="activityCreate($event)">\n</div>\n\n<div class="social-welcome" *ngIf="!showLoading && activities.length < 1">\n    <i class="fa fa-bell-o"></i>\n    <div>Chưa có nội dung nào</div>\n</div>\n\n<div class="social-loading" *ngIf="showLoading">\n    <i class="fa fa-spinner fa-spin"></i>\n</div>\n\n<div *ngFor="let activity of activities"\n     socialActivity\n     [activity]="activity"\n     (onDeleted)="activityDeleted($event)"\n     (onUpdated)="activityUpdated($event)">\n</div>\n\n<div class="card" *ngIf="hasMore">\n    <div class="card-body text-center">\n        Đang tải dữ liệu..\n    </div>\n</div>\n',styles:[".social-block{display:block;margin-top:10px}.social-card{position:relative;border-radius:2px;padding:15px;background:#fff;font-size:14px;margin-bottom:15px}.social-mark{position:absolute;top:-2px;left:-2px;padding:7px 9px;color:#fff}.social-mark:before{position:absolute;z-index:1}.social-mark:after{content:'';position:absolute;top:0;left:0;border-bottom:45px solid transparent;border-left:45px solid #faa807}.social-welcome{text-align:center;color:rgba(0,0,0,.54);margin-top:80px}.social-welcome i{font-size:60px;margin-bottom:20px;width:100px;height:100px;line-height:100px;border-radius:50%;background:rgba(0,0,0,.1)}.social-loading{text-align:center;margin-top:40px;color:rgba(0,0,0,.54)}.social-loading i{font-size:40px}.activity-column-active{margin:-7.5px}.activity-column-active .activity-column{float:left;width:50%;padding:0 7.5px}"]}]}],t.ctorParameters=function(){return[{type:F}]},t.propDecorators={activityPost:[{type:e.ViewChild,args:["activityPost"]}],postEnable:[{type:e.Input}],scroller:[{type:e.Input}],type:[{type:e.Input}],application:[{type:e.Input}],loader:[{type:e.Input}]},t}();var it=function(){function t(t){this.socialService=t,this.attachments=[],this.files=[]}return t.prototype.ngOnChanges=function(t){t.attachments&&this._indexFiles()},t.prototype.viewImage=function(t,e){var i={index:this._getImageIndex(t.id),clickElement:e};this.socialService.viewImages(this._images,i)},t.prototype.viewAttachment=function(t){var e=t.file,i=this._getAttachmentById(e.id);if(i)if(e.image){var n=t.event.target;"IMG"!==n.tagName&&(n=n.getElementsByTagName("img")[0]),this.viewImage(e,n)}else this.socialService.viewAttachment(i)},t.prototype._getAttachmentById=function(t){for(var e=0;e<this.attachments.length;e++)if(this.attachments[e].gridfsUUID===t)return this.attachments[e]},t.prototype._getImageIndex=function(t){for(var e=0;e<this._images.length;e++)if(this._images[e].id===t)return e;return 0},t.prototype._indexFiles=function(){this.files=this.socialService.attachmentToFiles(this.attachments),this._images=[];for(var t=0;t<this.files.length;t++)if(this.files[t].image){var e=this.attachments[t];this._images.push({src:e.pathView,id:e.gridfsUUID,w:1,h:1,sizeDynamic:!0})}},t.decorators=[{type:e.Component,args:[{selector:"[attachmentList]",template:'<file-list [files]="files" [removable]="false" (onClick)="viewAttachment($event)"></file-list>',styles:[""]}]}],t.ctorParameters=function(){return[{type:F}]},t.propDecorators={attachments:[{type:e.Input}]},t}();var nt=function(){function t(t,e){this.socialService=t,this.router=e,this.viewMoreEnable=!0,this.activities=[]}return t.prototype.ngOnInit=function(){this._loadLatest()},t.prototype.viewActivity=function(t){this.router.navigate(["social/activity/"+(t.activityID||t.uuid)])},t.prototype.viewMore=function(){this.router.navigate(["social"])},t.prototype._loadLatest=function(){var t=this;this.socialService.activityWall({pageSize:3},(function(e){var i=e&&e.items||[];i.length>0&&t._updateWithCommentLatest(i,(function(){i.sort((function(t,e){return(e.lastUpdate||e.posted)-(t.lastUpdate||t.posted)})),t.activities=i}))}))},t.prototype._updateWithCommentLatest=function(t,e){var i=this,n=[];t.forEach((function(e,o){n.push(new Promise((function(n){i.socialService.commentWall({pageSize:1,activity:e.uuid},(function(e){var i=e&&e.items||[];i.length>0&&(t[o]=i[0]),n()}))})))})),Promise.all(n).then((function(){return e()}))},t.decorators=[{type:e.Component,args:[{selector:"social-latest",template:'<div *ngFor="let item of activities" (click)="viewActivity(item)" class="social-latest__item">\n    <img userAvatar [usercode]="item.creator" class="social-latest__avatar">\n    <div class="social-latest__content">\n        <div>\n            <div class="social-latest__time">{{ (item.lastUpdate || item.posted) | dateShortcut }}</div>\n            <b>{{item.fullname}}</b>\n        </div>\n        <div [innerHTML]="item._displayMessage" class="social-latest__message"></div>\n    </div>\n</div>\n<div *ngIf="viewMoreEnable && activities.length" (click)="viewMore()"\n     class="social-latest__item text-center text-primary">Xem thêm</div>\n',styles:[".social-latest__item{padding:7px 10px;cursor:pointer;border-top:1px solid rgba(0,0,0,.05)}.social-latest__avatar{width:30px;height:30px;border-radius:50%;float:left}.social-latest__content{overflow:hidden;padding-left:10px}.social-latest__time{float:right;font-size:90%;opacity:.7}.social-latest__message{line-height:16px;max-height:32px;overflow:hidden}"]}]}],t.ctorParameters=function(){return[{type:F},{type:l.Router}]},t.propDecorators={viewMoreEnable:[{type:e.Input}]},t}();var ot=["unknown","text","archive","audio","video","png","jpg","gif","tiff","svg","ai","psd","dwg","avi","fla","mp2","mp3","mp4","aac","flac","wma","wav","mxf","iso","mdf","nrg","zip","7z","arj","rar","pdf","doc","rtf","txt","xls","ppt","css","csv","html","json","js","xml","dbf","exe"],st=["doc","docx","odt","ods","xls","xlsx","ppt","pps","pptm","pptx","pot","potx","dot","dotx","docm","dotx","csv","sxw"],at=["pdf","png","jpg","jpeg","gif"],rt=function(){function t(){}return t.prototype.getImagePath=function(){var t=iNet.commonImageFolder,e=t.lastIndexOf("/");return e===t.length-1?t.substring(0,e):t},t.prototype.getFileFormatPath=function(){return this.getImagePath()+"/format"},t.prototype.getUrlByExt=function(t){var e=this.getFileFormatPath();return ot.indexOf(t)>-1?e+"/"+t.toLowerCase()+".svg":e+"/unknown.svg"},t.prototype.getUrlByName=function(t){return this.getUrlByExt(this.getExtByName(t))},t.prototype.getExtByName=function(t){return t.split(".").pop().toLowerCase()||"unknown"},t.prototype.getEditFormats=function(){return st},t.prototype.getViewFormats=function(){return at},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[]},t}(),ct=function(){function t(t){this.formatService=t}return t.prototype.transform=function(t){return this.formatService.getExtByName(t)},t.decorators=[{type:e.Pipe,args:[{name:"fileExt"}]}],t.ctorParameters=function(){return[{type:rt}]},t}();var lt=function(){function t(t){this.formatService=t}return t.prototype.transform=function(t){return this.formatService.getUrlByName(t)},t.decorators=[{type:e.Pipe,args:[{name:"fileIcon"}]}],t.ctorParameters=function(){return[{type:rt}]},t}();var pt=function(){function t(){this.files=[],this.removable=!0,this.onClick=new e.EventEmitter,this.onRemove=new e.EventEmitter}return t.prototype.ngOnInit=function(){console.log("files",this.files.length,this.files),this.galleryOptions=[{width:"600px",height:"400px",thumbnailsColumns:4,imageAnimation:d.NgxGalleryAnimation.Slide},{breakpoint:800,width:"100%",height:"600px",imagePercent:80,thumbnailsPercent:20,thumbnailsMargin:20,thumbnailMargin:20},{breakpoint:400,preview:!1}],this.galleryImages=[{small:"https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max",medium:"https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max",big:"https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max"},{small:"https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max",medium:"https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max",big:"https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max"},{small:"https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max",medium:"https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max",big:"https://images.unsplash.com/photo-1470240731273-7821a6eeb6bd?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max"}],this._initFileEl()},t.prototype.clickFile=function(t,e){this.onClick.emit({file:t,event:e})},t.prototype.removeFile=function(t){var e=this.files.indexOf(t);e>-1&&(this.files.splice(e,1),this.onRemove.emit(t))},t.prototype.addFiles=function(t){for(var e=0;e<t.length;e++){var i=t[e];this._fileIsImage(i)&&(i.image=!0,this._readImageBase64(i)),this.files.push(i)}},t.prototype._initFileEl=function(){var t=this;this.fileEl&&this.fileEl.addEventListener("change",(function(e){var i=t.fileEl.files;i.length>0&&(t.addFiles(i),t.fileEl.value="")}))},t.prototype._readImageBase64=function(t){var e=new FileReader;e.readAsDataURL(t),e.onload=function(){t.url=e.result}},t.prototype._fileIsImage=function(t){return t.type&&t.type.indexOf("image")>-1},t.decorators=[{type:e.Component,args:[{selector:"file-list",template:'<ng-container *ngFor="let file of files">\n    <ng-template *ngTemplateOutlet="template ? template : fileItem; context: {file: file}">\n    </ng-template>\n</ng-container>\n<ng-template #fileItem let-file="file">\n    <div class="file-item" [title]="file.name" (click)="clickFile(file, $event)">\n        <img *ngIf="file.image; else icon" [src]="file.url" class="file-item__image">\n        <ngx-gallery [options]="galleryOptions" [images]="galleryImages"></ngx-gallery>\n\n        <ng-template #icon>\n            <img [src]="file.name | fileIcon" class="file-item__image_type">\n            <div class="file-item__name">{{file.name}}</div>\n        </ng-template>\n        <i *ngIf="removable" (click)="removeFile(file)" class="fa fa-times file-item__remove"></i>\n    </div>\n</ng-template>',styles:[":host{display:block}.file-item{display:flex;align-items:center;width:auto;height:100%;border-radius:2px;position:relative;margin-right:5px;margin-bottom:5px;overflow:hidden;padding:0 5px;cursor:pointer}.file-item__image_type{max-width:36px;max-height:36px;margin-bottom:5px;margin-top:5px;margin-right:5px}.file-item__name{font-size:12px;line-height:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.file-item__remove{position:absolute;right:3px;top:3px;cursor:pointer;width:24px;height:24px;line-height:24px;border-radius:50%;background:rgba(0,0,0,.2);color:#fff;text-align:center;font-size:12px}.file-item__remove:hover{background:rgba(0,0,0,.5)}"]}]}],t.propDecorators={fileEl:[{type:e.Input}],files:[{type:e.Input}],removable:[{type:e.Input}],template:[{type:e.Input}],onClick:[{type:e.Output}],onRemove:[{type:e.Output}]},t}();var dt=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[i.CommonModule,d.NgxGalleryModule],declarations:[lt,ct,pt],exports:[lt,ct,pt],providers:[rt]}]}],t}(),mt=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[i.CommonModule,a.FormsModule,s.PhotoSwipeModule,a.ReactiveFormsModule,s.OpenGraphModule,s.AutocompleteModule,r.BsDropdownModule.forRoot(),c.ModalModule.forRoot(),s.FrontViewModule,n.CoreModule,dt,s.DateTimeModule],exports:[U,z,T,et,it,G,Z,tt,N,H,B,J,R,A,V,j,W,q,Y,X,Q,K,nt],declarations:[U,z,T,et,it,G,Z,tt,N,H,B,J,R,A,V,j,W,q,Y,X,Q,K,nt],entryComponents:[q,W,Y],providers:[F,n.CacheStorageService,n.AccentService,s.FileFormatService]}]}],t}(),ht=function(){function t(){}return t.prototype.ngOnInit=function(){},t.decorators=[{type:e.Component,args:[{template:'<div style="padding:15px;height: calc(100vh - 120px);\n    overflow: auto;" class="d-flex">\n    <div class="social-home__left" socialActivityList></div>\n\n\n    <div style="width: 25%;margin-left: 15px;">\n        <div class="card text-white bg-primary mb-3">\n            <div class="card-header p-2 d-flex justify-content-between align-items-center">\n                <span>Mời người dùng</span>\n                <span style="font-size: 28px;"><i class="fa fa-plus-circle" aria-hidden="true"></i></span>\n            </div>\n        </div>\n\x3c!--        <div class="card mb-3">--\x3e\n\x3c!--            <div class="card-body">--\x3e\n\x3c!--                <h5 class="card-title">Card title</h5>--\x3e\n\x3c!--                <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6>--\x3e\n\x3c!--                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the--\x3e\n\x3c!--                    card\'s content.</p>--\x3e\n\x3c!--                <a href="#" class="card-link">Card link</a>--\x3e\n\x3c!--                <a href="#" class="card-link">Another link</a>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--        </div>--\x3e\n        <div class="card text-white mb-3" style="max-width: 18rem;">\n            <div class="card-header bg-info p-2 d-flex justify-content-between align-items-center">\n                <span>Tác vụ</span>\n                <span style="font-size: 19px;"><i class="fa fa-plus-circle" aria-hidden="true"></i></span>\n            </div>\n            <div class="card-body p-0">\n                <ul class="list-group list-group-flush">\n                    <li class="text-muted list-group-item d-flex justify-content-between align-items-center">\n                        <span>Đang xử lý</span>\n                        <span style="font-size: 13px;" class="badge badge-danger">3</span>\n                    </li>\n                    <li class="text-muted list-group-item d-flex justify-content-between align-items-center">\n                        <span>Thiết lập bởi tôi</span>\n                        <span style="font-size: 13px;" class="badge badge-primary">0</span>\n                    </li>\n                    <li class="text-muted list-group-item d-flex justify-content-between align-items-center">\n                        <span>Đang chờ</span>\n                        <span style="font-size: 13px;" class="badge badge-warning">5</span>\n                    </li>\n                </ul>\n            </div>\n        </div>\n\n    </div>\n\n</div>\n',styles:[".social-home{padding:15px}.social-home__right{display:none}.social-home__left{width:75%}"]}]}],t.ctorParameters=function(){return[]},t}(),ut=function(){function t(t,e){this.route=t,this.router=e}return t.prototype.ngOnInit=function(){var t=this;this._routerObserver=this.router.events.pipe(p.filter((function(t){return t instanceof l.NavigationEnd}))).subscribe((function(){return t._updateActivityId()})),this._updateActivityId()},t.prototype.ngOnDestroy=function(){this._routerObserver.unsubscribe()},t.prototype._updateActivityId=function(){var t=this.route.snapshot.paramMap;t.get("id")&&(this.activityId=t.get("id"))},t.decorators=[{type:e.Component,args:[{template:'<div style="padding:15px;">\n    <div class="social-home__right">\n        <social-right-layout></social-right-layout>\n    </div>\n    <div class="social-home__left">\n        <social-activity-view [activityId]="activityId"></social-activity-view>\n    </div>\n</div>\n',styles:[".social-home{padding:15px}.social-home__right{display:none}.social-home__left{width:75%}"]}]}],t.ctorParameters=function(){return[{type:l.ActivatedRoute},{type:l.Router}]},t}();var gt=[{path:"activity/social",component:ht},{path:"activity/social/activity/:id",component:ut},{path:"activity/social/**",redirectTo:"activity/social",pathMatch:"full"}],vt=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[l.RouterModule.forChild(gt)],exports:[l.RouterModule]}]}],t}(),ft=function(){function t(t){this.router=t,this.tabs=[{name:"Trang chủ",component:"",path:""},{name:"Bạn bè",component:Y,path:"/friend"},{name:"Lời mời",component:q,path:"/friend/invitation"},{name:"Tìm bạn",component:W,path:"/friend/browse"}],this.searchValue="",this.search=new a.FormControl,this.prefix=this.router.url.substring(0,this.router.url.indexOf("/friend"))}return t.prototype.ngOnInit=function(){var t=this;this._searchEl=$(this.searchEl.nativeElement),this.search.valueChanges.subscribe((function(e){t._searchable&&t._activeComponent.instance.onSearch(e.trim())}))},t.prototype.changeTab=function(t){this.searchValue=""},t.prototype.loadTabComponent=function(t){var e=this;this._activeComponent=t,this._searchable=t.instance.onSearch,this.placeholder=t.instance.placeholder||"Tìm kiếm...",this._searchable?(this._searchEl.show(),t.instance.clearSearchValue=function(){e.searchValue=""}):this._searchEl.hide()},t.decorators=[{type:e.Component,args:[{template:'<div class="friend-toolbar">\n    <div navigationTab\n         [tabs]="tabs"\n         [viewContainerRef]="_tabViewContainer"\n         [prefix]="prefix"\n         (onChange)="changeTab($event)"\n         (onLoad)="loadTabComponent($event)" class="friend-tab"></div>\n\n    <div #searchEl class="input-group search-input">\n        <div class="input-group-prepend">\n            <i class="input-group-text fa fa-search"></i>\n        </div>\n        <input type="text"\n               [formControl]="search"\n               [(ngModel)]="searchValue"\n               class="form-control" [placeholder]="placeholder">\n    </div>\n</div>\n<div class="friend-content">\n    <ng-container #tabViewContainer></ng-container>\n</div>\n',styles:[".friend-toolbar{border-bottom:1px solid rgba(0,0,0,.12);background:#e5e9ee;margin-bottom:20px;padding:10px 15px;min-height:58px}.friend-tab{float:left;margin-right:25px}.friend-content{padding:0 15px}.search-input{width:300px}@media (max-width:767px){.friend-content{padding:0}.friend-tab{margin:0 0 10px}.search-input{width:100%}}"]}]}],t.ctorParameters=function(){return[{type:l.Router}]},t.propDecorators={_tabViewContainer:[{type:e.ViewChild,args:["tabViewContainer",{read:e.ViewContainerRef}]}],searchEl:[{type:e.ViewChild,args:["searchEl"]}]},t}();var yt=function(){function t(){}return t.decorators=[{type:e.Component,args:[{selector:"social-right-layout",template:'<div class="social-home__nav" routerLink="/social/friend">Danh sách bạn bè</div>\n<div class="social-home__nav" routerLink="/social/friend/invitation">Lời mời kết bạn</div>\n<div class="social-home__nav" routerLink="/social/friend/browse">Thêm bạn</div>\n',styles:[".social-home__nav{cursor:pointer;border-radius:2px;margin-bottom:15px;padding:0 15px;height:50px;line-height:48px;color:rgba(0,0,0,.8);border:1px solid rgba(0,0,0,.1);background:#fff;font-size:18px}.social-home__nav:hover{color:#007bff;border:1px solid #007bff}"]}]}],t}(),bt=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[a.FormsModule,a.ReactiveFormsModule,mt,vt,s.NavigationTabModule],declarations:[ht,ft,ut,yt]}]}],t}();t.ActivityComponent=T,t.ActivityListComponent=et,t.ActivityPostComponent=z,t.ActivityViewComponent=j,t.FriendBrowseComponent=W,t.FriendInvitationComponent=q,t.SocialAppModule=bt,t.SocialComponent=A,t.SocialEmbedComponent=V,t.SocialGroupComponent=Y,t.SocialLatestComponent=nt,t.SocialModule=mt,t.SocialService=F,t.ɵa=dt,t.ɵb=lt,t.ɵc=rt,t.ɵd=ct,t.ɵe=pt,t.ɵf=U,t.ɵg=N,t.ɵh=it,t.ɵi=G,t.ɵj=Z,t.ɵk=tt,t.ɵl=H,t.ɵm=B,t.ɵn=J,t.ɵo=R,t.ɵp=X,t.ɵq=Q,t.ɵr=K,t.ɵs=vt,t.ɵt=ht,t.ɵu=ut,t.ɵv=ft,t.ɵw=yt,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=inet-social.umd.min.js.map