{"version":3,"sources":["ng://inet-calendar/src/utils/common/Accent.ts","ng://inet-calendar/src/utils/common/DateUtils.ts","ng://inet-calendar/src/utils/common/AjaxAPI.ts","ng://inet-calendar/src/utils/model/CalAttendeeType.ts","ng://inet-calendar/src/utils/CalConfigs.ts","ng://inet-calendar/src/utils/model/CalType.ts","ng://inet-calendar/src/utils/model/CalCategory.ts","ng://inet-calendar/src/utils/model/CalCategoryIcon.ts","ng://inet-calendar/src/utils/model/CalAttendeeRole.ts","ng://inet-calendar/src/utils/model/CalSubType.ts","ng://inet-calendar/src/utils/model/CalMode.ts","ng://inet-calendar/src/utils/CalendarCar.ts","ng://inet-calendar/src/utils/subfirm/Dictionary.ts","ng://inet-calendar/src/utils/model/CalAttendeeState.ts","ng://inet-calendar/src/utils/CalBuilder.ts","ng://inet-calendar/src/utils/CalConstants.ts","ng://inet-calendar/src/utils/xCalendar.ts","ng://inet-calendar/src/dialog-delete/dialog-delete.component.ts","ng://inet-calendar/src/CalendarUtils.ts","ng://inet-calendar/src/model/CalendarEvent.ts","ng://inet-calendar/src/dialog-view/dialog-view.component.ts","ng://inet-calendar/src/calendar.service.ts","ng://inet-calendar/src/calendar-today/calendar-today.component.ts","ng://inet-calendar/src/calendar.component.ts","ng://inet-calendar/src/dialog-repeat/dialog-repeat.component.ts","ng://inet-calendar/src/remote-module/filelist/list/file-list.component.ts","ng://inet-calendar/src/attachment-list/attachment-list.component.ts","ng://inet-calendar/src/form/calendar-form.component.ts","ng://inet-calendar/src/calendar-viewer/calendar-viewer.component.ts","ng://inet-calendar/src/calendar-widget/calendar-widget.component.ts","ng://inet-calendar/src/attendee-list/attendee-list.component.ts","ng://inet-calendar/src/calendar-routing.module.ts","ng://inet-calendar/src/remote-module/filelist/file-format.service.ts","ng://inet-calendar/src/remote-module/filelist/file-ext.pipe.ts","ng://inet-calendar/src/remote-module/filelist/file-icon.pipe.ts","ng://inet-calendar/src/remote-module/filelist/file-list.module.ts","ng://inet-calendar/src/remote-module/time-picker/time-picker-modal/time-picker-modal.component.ts","ng://inet-calendar/src/remote-module/time-picker/time-picker-modal.directive.ts","ng://inet-calendar/src/remote-module/time-picker/time-picker-modal.module.ts","ng://inet-calendar/src/calendar.module.ts"],"names":["accents_arr","no_accents_arr","vnToLatin","str","replace","a","index","indexOf","DateUtils","firstDay","getWeekRange","date","startDate","this","getDateStartWeek","endDate","Date","setDate","getDate","startWeek","endWeek","getDayIndexOnWeek","undefined","getDay","distance","getFullYear","getMonth","getDateEndWeek","dayOfYear","jan","setTime","getTime","Math","ceil","getWeek","dayInYear","getDateFromWeek","w","y","dateIsToday","now","compareDate","setHours","weekIsToday","isSameWeek","b","AjaxAPI","getUrl","url","domain","firmPrefix","iNet","urls","split","join","getPUrl","sendRequest","options","$","ajax","postForm","extend","type","cache","contentType","processData","data","toString","form","FormData","k","append","window","ajaxSecure","ALIAS","ORGAN","USER","CalConfigs","name","value","description","COMMUNITY","ORGANIZATION","DEPARTMENT","IMPORTANT","CAR","INVITATION","PERSONAL","PREPARER","OBSERVER","CHAIRMAN","MEMBER","CREATOR","MEET_PEOPLE","CREATE","PUBLISH","SENT","CANCEL","VERIFY","OTHER","CalendarCar","subFirmDict","carDefault","uuid","carRef","driverRef","prototype","loadCars","callback","_loadList","createOrUpdateCars","_this","update","parseJsonValue","reference","create","loadDrivers","createOrUpdateDrivers","ref","list","results","values","JSON","parse","e","SubFirmDictionary","success","error","dictID","remove","items","NEEDS_ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED","COMPLETED","IN_PROCESS","NONE","OTHERS","moment","moment_","CalBuilder","TIME_NEW_UPDATE","roleUrl","MODE","CalMode","ROLE","CalAttendeeRole","calSubType","CalSubType","calCategory","CalCategory","dateUtils","calAttendeeType","CalAttendeeType","calAttendeeState","CalAttendeeState","calType","CalType","subFirmDic","carUtils","configs","resources","days","statuses","allDay","hour","minute","_userRoles","_mapEvents","_queue","_organs","_myOrgans","typeIsDepartment","typeIsCommunity","typeIsOrganization","catIsInvitation","category","catIsPersonal","catIsCar","catIsImportant","formatDateStr","formatDate","getConfigValue","formatTimeStr","formatDateTimeStr","format","getEventStatus","mode","isCreate","isPublish","isSent","isCancel","isOther","_applyConfig","apply","length","forEach","config","obj","getConfigObj","push","i","addQueue","executor","Promise","resolve","then","fn","ready","_loadOrgans","organs","_getOrganOnInit","cacheSessionStorage","key","sessionStorage","getItem","time","removeItem","setItem","stringify","localStorage","cacheDataTemp","_cacheStore","setOrgId","orgid","_cacheOrgId","getOrgId","organId","id","getHourMinute","getHours","getMinutes","Number","event","indexEvent","updateEventByRole","params","loadRole","getEventByObjectId","element","isReviewer","reviewUpdate","isOwnReviewer","meIsCreator","ownerReviewUpdate","cancel","reviewCancel","ownerReviewCancel","reviewNotify","deleteAttachment","loadOrganMembers","searchAttendee","_searchAttendee","members","sort","fullname","localeCompare","elements","filter","item","alias","member","_indexAccount","account","toLowerCase","username","display","insertPrefixAttendee","loadDepartments","order","getMyOrg","keyCache","usercode","_convertOrg","visibleMyOrgans","organ","_organ","getOrgById","firmUUID","groupType","getAllOrg","pageSize","visibleOrgans","slice","role","isAuth","myOrgans","myOrgan","j","splice","myOrg","unshift","getTreeOrg","tree","children","parentID","parentOrgan","indexOrgSearch","_index","firmName","isMyOrg","org","loadEvent","loadEventReview","updateState","notes","formatTextUpdate","loadGroupEvent","modifyEvent","loadOrgEvents","_loadOnDifferYear","_loadOrgEvents","loadCommunityEvents","_loadCommunityEvents","useOrgId","loadAllPublishEvents","_loadAllPublishEvents","removeOrgId","loadPublishEvents","getReviewEvents","_getReviewEvents","getViewEvents","_getViewEvents","reviewSearchEvents","_reviewSearchEvents","getOwnEvents","_getOwnEvents","getListEvents","promises","_options","isViewer","all","events","concat","removeEventDuplicate","sortEvents","day","sortEventStart","sortEventPriority","_sort","_order","moveFirst","tmp","arr","orderBy","prev","searchEventsByKeywords","keywords","objectId","_indexed","indexEventMembers","subjectDisplay","formatTextDisplay","subject","locationDisplay","location","indexRepeat","indexEventAttribute","indexEventDate","indexEventSearch","indexCustom","categoryIcon","CalCategoryIcon","department","departID","attendees","attendeeDisplay","attendeeValue","creator","isCreator","usernameIsMe","creatorStr","chairmanStr","_groupMember2String","memberStr","prepareStr","watcherStr","observerStr","membersDecode","groupAttendeeByOrgan","organName","attribute","_subType","initEvent","calEvent","_initEventDate","startTime","from","toTime","to","year","_allday","timeStr","startTimeStr","toTimeStr","hourStr","start","end","createTime","createDate","createDateStr","updateTime","updateDate","updateDateStr","hourUpdated","recentUpdated","lastUpdateStr","getTextForMinutes","_members","attachments","file","rrule","obj_1","rrmode","wkdays","lstart","until","repeat","reviewer","own_reviewer","viewer","getQueryParams","query","search","equalIndex","buildQueryString","encodeURIComponent","getUserAvatar","getPermissionOnEvent","currentOrganId","save","saveCreate","permissions","canReview","canOwnReviewEvent","canReviewUpdate","isEditMyEvent","canUpdateOwnEvent","approve","reject","send","revert","delete","hasFirmAttendee","canExternalUpdateEvent","updateAttendee","print","exportInvitation","_templateId","canReviewEvent","canUpdateAttendee","ownOrganId","isFirmEvent","searchAnyAttendee","searchUserAsAttendee","users","searchOrganAsAttendee","orgs","getOrgNameById","keyword","limit","attendee","memberToAttendee","loadOrgByKeyword","map","organToAttendee","aliasToAttendee","loadAttendeeByName","loadUserByKeyword","user","getFileUrl","_role","getUrlByOrgId","folder","getFileViewUrl","getOrgByUid","orgId","getOrgByPrefix","prefix","loadRoles","organIds","generateEventWeekView","segEvents","this_1","generateEventView","getLastUpdateSegEvents","lastUpdate","segEvent","lastUpdateEvent","getDisplayByDay","dayStr","isToday","buildMembers","groupAttendeeByOrganRole","groupByOrgans","Object","keys","internalUpdate","isMyOrgan","externalUpdate","canRemoveAttendee","canUpdateState","readTime","attendeeIsMe","buildMemberStr","buildMemberShow","modifyDataUpdate","attendeeJson","newAttendees","remainAttendees_1","attendeeRemoveJson","attendeeAddJson","firms","orgName","uriPrefix","organiId","viewEventOnModal","plugins","xcalendar","openView","minutes","parseInt","round","groupEventBySession","allday","morning","afternoon","evening","groupEventByPerson","persons","eventByDays","person","eventDays","memberIsAttendee","groupEventByLeaders","loadLeaders","leaders","dataLeaders","otherEvents","leader","isFound","attendde","text","$fragment","html","find","getAttendeeByUsername","getAttendeeIsMe","eventIsViewed","cacheResponse","option","_buildAjaxOptions","keyCache_1","dataCached","_option","isLocalFirm","path","groupEventByCar","cars","car","carData","_carUUID","filterMeetPeopleEvents","endOfYear","params1_1","options1_1","params2_1","options2_1","loadMonthEvents","setMonth","getRangeParams","getExportUrl","getWeekParams","weekRange","dateEqualWeekParams","weekParams","eventIsOnRange","verifyDuplicateEvents","duplicateEvents","allEvents","detector","isExist","needVerifyDuplicate","isEventPublished","actionPublish","isTimeChanged","subjectDisplayWithMaxLength","maxLength","substr","dictCreate","dictUpdate","dictRemove","dictList","leaderCreateOrUpdate","leaderRemove","xCalendar","CalendarDialogDelete","calendarService","onDelete","EventEmitter","dialogTitle","dialogContent","ngAfterViewInit","_initDialogDelete","ngOnDestroy","_destroyDialogDelete","hide","confirmDialog","removeEvent","emit","show","_$dialogDelete","dialogDelete","nativeElement","bind","document","body","addEventListener","on","stopPropagation","removeEventListener","Component","args","selector","template","CalendarService","Input","Output","ViewChild","ModalDirective","locale","CalendarUtils","getRepeatText","repeatTypes","label","_getTextRepeatWeek","weekDays","title","displayDay","toUpperCase","displayDate","displayWeek","displayMonth","displayTime","computePosByPoint","padding","direction","bounds","getBoundingClientRect","halfHeight","height","halfWidth","width","pos","left","x","top","innerWidth","innerHeight","deltaTop","pageY","deltaBottom","pageX","deltaLeft","deltaRight","max","position","elementBounds","computePosByTargetEl","target","jsEvent","targetBounds","deltaRect","right","bottom","maxX","maxY","targetHeight","targetWidth","scrollingElement","scrollTop","scrollLeft","CalendarEvent","repeatText","timeDisplay","HtmlUtils","formatHtmlDisplay","summary","myAttendee","CalendarDialogViewComponent","router","onChange","_initModalView","_addScrollUpdatePos","_destroyModalView","_removeScrollUpdatePos","editEvent","navigate","calendarEvent","changeEvent","_onChange","viewEvent","_targetEl","_jsEvent","_syncBodyHeight","_preventScrolling","setTimeout","_openModal","_showModal","_$modalView","css","viewDeleteModal","clearTimeout","_scrollTimer","maxHeight","modalView","_scrollUpdatePos","_timer","transformCss","-webkit-transition-duration","transition-duration","opacity","-webkit-transform","transform","Router","suggestService","componentFactoryResolver","injector","appRef","locationKeySuggestion","_fns","_ready","_triggerReady","searchLocation","content","loadSuggestion","saveLocation","saveSuggestion","createEvent","updateEvent","attendeeSearch","loadAttendees","loadEvents","_initViewModal","_viewModalRef","instance","hideViewModal","componentFactory","resolveComponentFactory","attachView","hostView","Injectable","SuggestionService","ComponentFactoryResolver","Injector","ApplicationRef","CalendarTodayComponent","colors","_date","loadTodayEvents","_initEventStatus","onViewEvent","targetEl","progressing","ended","pending","statusText","statusColor","style","background-color","CalendarComponent","route","resourceLoader","notify","viewTypes","CalendarViewMode","CalendarMode","timeGridDay","columnHeaderText","titleFormat","calendar","timeGridWeek","dayGridMonth","defaultMode","calendarConfig","dayGridPlugin","timeGridPlugin","interactionPlugin","themeSystem","allDaySlot","allDayText","header","nowIndicator","navLinks","editable","droppable","eventLimit","selectable","selectMirror","weekends","views","businessHours","daysOfWeek","endTime","eventDrop","arg","_updateEventTime","eventResize","select","_selectRange","eventClick","_viewEvent","eventDragStart","_hideViewDialog","datesRender","_calendarChange","_modeCache","_events","assign","_getDataView","view","_init","destroy","_routerObserver","unsubscribe","Calendar","calendarRef","render","pipe","NavigationEnd","subscribe","_onNavigated","oldEvent","err","showMessage","status","reloadEvents","_createEvent","_loadEvents","forceChange","_eventTimer","_loadRangeEvents","dataBase64","btoa","valueOf","info","dayGridDay","changeView","_updateInfo","viewTitle","active","_checkIsToday","_updateViewParams","range","activeStart","activeEnd","_dateInRange","_outOfRange","_currentRange","_getRange","_renderEvents","removeAllEventSources","currentStart","currentEnd","eventInputs","eventInput","textColor","color","_addEventSource","currentTarget","addEventSource","viewData","defaultView","defaultDate","onPrev","onNext","next","onToday","_getCalendarMode","segments","snapshot","modeView","_cacheModeView","calendarWidget","ActivatedRoute","ResourceLoaderService","NotificationService","CalendarDialogRepeatComponent","onRepeat","dateFormat","$modal","repeatModal","appendChild","is","modal","openRepeat","initData","saveRepeat","getRepeatData","changeWeekDay","checked","getWeekDayChecked","changeDate","FileListComponent","files","removable","onClick","onRemove","ngOnInit","_initFileEl","clickFile","removeFile","addFiles","_fileIsImage","_readImageBase64","fileEl","reader","FileReader","readAsDataURL","onload","result","AttachmentListComponent","modalService","ngOnChanges","changes","_attachmentToFiles","modalRef","viewAttachment","open","removeAttachment","_file","confirmMessage","fileList","fileID","mimetype","size","gridfsUUID","BsModalService","CalendarFormComponent","http","formData","state","_attendees","Observable","subscriber","attendeeModal","trim","debounceTime","distinctUntilChanged","locationSearch","paramMap","get","_initForm","eventNotFound","event_1","atob","titleInput","focus","setRepeatData","_getFormData","showLoading","_onSuccess","_updateMyState","_validate","_hasAttendee","addAttendee","timeError","_clearRepeat","onEditRepeat","preventDefault","goBack","history","back","onRemoveEvent","hours","HttpClientService","CalendarViewerComponent","limitEvent","CalendarViewerMode","MONTH","onActive","dates","weekDates","defineProperty","_render","setEvents","dateViewer","_getDateViewer","clearEvents","toDay","_prevMonth","_prevWeek","_nextMonth","_nextWeek","activeDate","dateActive","outOfRange","focusDate","_renderMonth","_renderWeek","_getDateStartWeek","_createWeekDate","_renderTitle","_renderWeekTitle","today","_isToday","weekTitles","viewerDate","dateTitle","startWeekFromNow","WEEK","CalendarWidgetComponent","changeMonth","calendarViewer","activeDateViewer","activeDateTitle","_groupEventByDate","group","groups","CalendarAttendeeListComponent","differs","expandable","expandEnable","expanded","differ","ngDoCheck","diff","generateDetail","removeAttendee","accept","unknown","_stateText","stateText","expandAttendees","getStateIcon","cls","IterableDiffers","routes","component","redirectTo","pathMatch","CalendarRoutingModule","NgModule","imports","RouterModule","forChild","exports","FILES_FORMAT","FILES_EDIT_FORMAT","FILES_VIEW_FORMAT","FileFormatService","getImagePath","commonImageFolder","lastIndex","lastIndexOf","substring","getFileFormatPath","getUrlByExt","ext","getUrlByName","getExtByName","pop","getEditFormats","getViewFormats","FileExtPipe","formatService","Pipe","FileIconPipe","FileListModule","CommonModule","declarations","providers","TimePickerModalComponent","el","arrowkeys","hourStep","minuteStep","mousewheel","readonlyInput","secondsStep","showMinutes","showSpinners","_timeDate","_formatDate","detach","addClass","$modalContent","isSameNode","close","ElementRef","DEFAULT_VALUE_ACCESSOR","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","TimePickerModalDirective","multi","valueChange","onFocus","timePickerModal","getDateInput","console","writeValue","propagateChange","registerOnChange","registerOnTouched","bounding","getValue","times","setMinutes","Directive","HostListener","TimePickerModalModule","TimepickerModule","forRoot","FormsModule","CalendarModule","BsDatepickerModule","ModalModule","TypeaheadModule","ReactiveFormsModule","CoreModule","HttpClientModule","entryComponents"],"mappings":"irCACIA,EAAc,CAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5C,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5C,IAAI,IAAI,IAAI,IACZ,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5C,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IACxC,IAAI,IAAI,IAAI,IAAI,IAChB,IACA,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5C,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IACxC,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5C,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IACxC,IAAI,IAAI,IAAI,IAAI,IAChB,KAEEC,EAAiB,CACnB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IACxC,IAAI,IAAI,IAAI,IAAI,IAAI,IACpB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IACxC,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5C,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IACxC,IAAI,IAAI,IAAI,IAAI,IAChB,IACA,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5C,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IACxC,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAC5C,IAAI,IAAI,IAAI,IAAI,IAChB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IACxC,IAAI,IAAI,IAAI,IAAI,IAChB,KAGSC,EAAS,SAAIC,GACtB,OAAOA,EAAIC,QAAQ,qBAAmB,SAAYC,OAC5CC,EAAQN,EAAYO,QAAQF,GAChC,OAAOC,EAAQ,EAAID,EAAIJ,EAAeK,OC7C/BE,EAAY,CAEnBC,SAAU,EAEVC,sBAAaC,EAAYF,OACjBG,EAAYC,KAAKC,iBAAiBH,EAAMF,GACxCM,EAAU,IAAIC,KAAKJ,GAEvB,OADAG,EAAQE,QAAQF,EAAQG,UAAY,GAC7B,CACHC,UAAWP,EACXQ,QAASL,IAIjBM,kBAAA,SAAkBV,EAAYF,GAM1B,YAJiBa,IAAbb,GAA0BA,EAAW,KACrCA,EAAWI,KAAKJ,UAGhBE,EAAKY,SAAWd,EACT,EAAIE,EAAKY,SAAWd,EAEpBE,EAAKY,SAAWd,GAI/BK,iBAAA,SAAiBH,EAAYF,OACrBe,EAAWX,KAAKQ,kBAAkBV,EAAMF,GAG5C,OAFAE,EAAO,IAAIK,KAAKL,EAAKc,cAAed,EAAKe,WAAYf,EAAKO,YACrDD,QAAQN,EAAKO,UAAYM,GACvBb,GAGXgB,eAAA,SAAehB,EAAYF,OACnBM,EAAUF,KAAKC,iBAAiBH,EAAMF,GAE1C,OADAM,EAAQE,QAAQF,EAAQG,UAAY,GAC7BH,GAGXa,UAAA,SAAUjB,OACFkB,EAAM,IAAIb,KAAKL,EAAKc,cAAe,EAAG,GAE1C,OADAI,EAAIC,QAAQD,EAAIE,UAAY,GACrBC,KAAKC,MAAMtB,EAAKoB,UAAYF,EAAIE,WAAa,QAGxDG,QAAA,SAAQvB,EAAYF,GACA,IAAIO,KAAKL,EAAKc,cAAe,EAAG,OAC5CN,EAAYN,KAAKC,iBAAiBH,EAAMF,GACxC0B,EAAYtB,KAAKe,UAAUT,GAC/B,OAAOa,KAAKC,KAAKE,EAAY,IAGjCC,gBAAA,SAAgBC,EAAWC,GAEvB,OAAO,IAAItB,KAAKsB,EAAG,EADV,EAAc,GAATD,EAAI,KAItBE,YAAA,SAAY5B,OACJ6B,EAAM,IAAIxB,KACVyB,EAAc,IAAIzB,KAAKL,GAG3B,OAFA6B,EAAIE,SAAS,EAAG,EAAG,EAAG,GACtBD,EAAYC,SAAS,EAAG,EAAG,EAAG,GACvBF,EAAIT,YAAcU,EAAYV,WAGzCY,YAAA,SAAYhC,GACR,OAAOE,KAAKqB,QAAQvB,KAAUE,KAAKqB,QAAQ,IAAIlB,OAGnD4B,WAAA,SAAWvC,EAASwC,GAChB,OAAOhC,KAAKqB,QAAQ7B,KAAOQ,KAAKqB,QAAQW,KCpErCC,EAAU,CAEnBC,gBAAQC,EAAaC,EAAiBC,GACpC,GAAGF,EAAIzC,QAAQ,QAAU,EACvB,OAAOyC,EAKT,GAHAA,GADAC,EAASA,GAAUE,KAAKJ,OAAO,QAClB3C,QAAQ,MAAO4C,GAGxBE,EAAY,KACVE,EAAOJ,EAAIK,MAAM,KACrBD,EAAK,GAAKF,EACVF,EAAMI,EAAKE,KAAK,KAGlB,OAAON,GAITO,iBAASP,EAAaC,EAAiBC,GACrC,OAAOrC,KAAKkC,OAAOC,EAAKC,EAAQC,GAAcC,KAAKD,aAIrDM,qBAAaC,GACX,OAAOC,EAAEC,KAAKF,IAIhBG,kBAAUH,GAUR,IARAA,EAAUC,EAAEG,OAAO,GAAIJ,EAAS,CAC9BK,KAAM,OACNC,OAAO,EACPC,aAAa,EACbC,aAAa,KAIJC,MAAQT,EAAQS,KAAKC,WAAW5D,QAAQ,YAAc,EAAE,KAC3D6D,EAAO,IAAIC,SACf,IAAI,IAAIC,KAAKb,EAAQS,KACnBE,EAAKG,OAAOD,EAAGb,EAAQS,KAAKI,IAE9Bb,EAAQS,KAAOE,EAGnB,OAAOvD,KAAK2C,YAAYC,KAMxBe,OAAa,OACf1B,EAAQU,YAAcgB,OAAa,KAAEC,mBCxDnCC,MAAQ,QACRC,MAAQ,MACRC,KAAO,QCHAC,EAA8B,CACrC,CACIC,KAAM,mBACNC,MAAO,mBACPC,YAAa,wCAEjB,CACIF,KAAM,cACNC,MAAO,aACPC,YAAa,2BAEjB,CACIF,KAAM,cACNC,MAAO,QACPC,YAAa,gCAEjB,CACIF,KAAM,kBACNC,MAAO,KACPC,YAAa,6CAEjB,CACIF,KAAM,mBACNC,OAAO,EACPC,YAAa,sDAEjB,CACIF,KAAM,qBACNC,OAAO,EACPC,YAAa,sCAGjB,CACIF,KAAM,eACNC,MAAO,OACPC,YAAa,0DAGjB,CACIF,KAAM,UACNC,MAAO,OACPC,YAAa,6CAEjB,CACIF,KAAM,oBACNC,MAAO,KACPC,YAAa,mEAIjB,CACIF,KAAM,aACNC,MAAO,OACPC,YAAa,uDAEjB,CACIF,KAAM,kBACNC,OAAO,EACPC,YAAa,8DAGjB,CACIF,KAAM,cACNC,MAAO,WACPC,YAAa,4EAEjB,CACIF,KAAM,qBACNC,MAAO,YACPC,YAAa,0FAGjB,CACIF,KAAM,qBACNC,OAAO,EACPC,YAAa,sBAIjB,CACIF,KAAM,wBACNC,OAAO,EACPC,YAAa,qCAEjB,CACIF,KAAM,2BACNC,OAAO,EACPC,YAAa,wCAGjB,CACIF,KAAM,kBACNC,MAAO,YACPC,YAAa,gEAGjB,CACIF,KAAM,uBACNC,MAAO,QACPC,YAAa,iCAGjB,CACIF,KAAM,kBACNC,OAAO,EACPC,YAAa,qDAGjB,CACIF,KAAM,uBACNC,OAAO,EACPC,YAAa,2CAGjB,CACIF,KAAM,sBACNC,OAAO,EACPC,YAAa,8BAGjB,CACIF,KAAM,wBACNC,OAAO,EACPC,YAAa,6BAEjB,CACIF,KAAM,mBACNC,OAAO,EACPC,YAAa,wBAEjB,CACIF,KAAM,8BACNC,MAAO,IACPC,YAAa,yCAEjB,CACIF,KAAM,iBACNC,OAAO,EACPC,YAAa,oCAEjB,CACIF,KAAM,wBACNC,OAAO,EACPC,YAAa,sDAEjB,CACIF,KAAM,+BACNC,OAAO,EACPC,YAAa,6CAEjB,CACIF,KAAM,6BACNC,OAAO,EACPC,YAAa,6BAEjB,CACIF,KAAM,iCACNC,OAAO,EACPC,YAAa,0CAEjB,CACIF,KAAM,6BACNC,MAAO,IACPC,YAAa,4CAEjB,CACIF,KAAM,uBACNC,MAAO,GACPC,YAAa,sDAEjB,CACIF,KAAM,kBACNC,MAAO,OACPC,YAAa,8BAEjB,CACIF,KAAM,gBACNC,MAAO,QACPC,YAAa,+BAEjB,CACIF,KAAM,4BACNC,MAAO,QACPC,YAAa,2ECtLjBC,UAAY,YACZC,aAAe,eACfC,WAAa,iBCFbC,UAAY,YACZC,IAAM,MACNC,WAAa,aACbC,SAAW,eCHXA,SAAW,aACXH,UAAY,aACZC,IAAM,YACNC,WAAa,qBCHbE,SAAW,WACXC,SAAW,WACXC,SAAW,WACXC,OAAS,SACTC,QAAU,cCJVC,YAAc,wBACdN,SAAW,4BCDXO,OAAA,EACAC,QAAA,EACAC,KAAA,EACAC,OAAA,EACAC,OAAA,EACAC,MAAA,6HCJJ,IAAAC,EAAA,WAYE,SAAAA,EAAYC,GAVZxF,KAAAyF,WAAa,CACXxB,KAAM,WACNyB,KAAM,IAGR1F,KAAA2F,OAAiB,kBACjB3F,KAAA4F,UAAoB,qBAKlB5F,KAAKwF,YAAcA,EA0CvB,OAvCED,EAAAM,UAAAC,SAAA,SAASC,GACP/F,KAAKgG,UAAUhG,KAAK2F,OAAQI,IAG9BR,EAAAM,UAAAI,mBAAA,SAAmB5C,EAAsB0C,GAAzC,IAAAG,EAAAlG,KACOqD,EAAKqC,KAKR1F,KAAKwF,YAAYW,OAAO9C,GAAI,SAAGA,GAAS,OAAA6C,EAAKE,eAAe/C,EAAM0C,OAJlE1C,EAAKY,KAAOjE,KAAK2F,OACjBtC,EAAKgD,UAAYrG,KAAK2F,OACtB3F,KAAKwF,YAAYc,OAAOjD,GAAI,SAAGA,GAAS,OAAA6C,EAAKE,eAAe/C,EAAM0C,QAMtER,EAAAM,UAAAU,YAAA,SAAYR,GACV/F,KAAKgG,UAAUhG,KAAK4F,UAAWG,IAGjCR,EAAAM,UAAAW,sBAAA,SAAsBnD,EAAsB0C,GAA5C,IAAAG,EAAAlG,KACOqD,EAAKqC,KAKR1F,KAAKwF,YAAYW,OAAO9C,GAAI,SAAGA,GAAS,OAAA6C,EAAKE,eAAe/C,EAAM0C,OAJlE1C,EAAKY,KAAOjE,KAAK4F,UACjBvC,EAAKgD,UAAYrG,KAAK4F,UACtB5F,KAAKwF,YAAYc,OAAOjD,GAAI,SAAGA,GAAS,OAAA6C,EAAKE,eAAe/C,EAAM0C,QAMtER,EAAAM,UAAAG,UAAA,SAAUS,EAAaV,GAAvB,IAAAG,EAAAlG,KACEA,KAAKwF,YAAYkB,KAAKD,GAAG,SAAGE,GAAY,OAAAT,EAAKE,eAAeO,EAAQ,GAAIZ,OAG1ER,EAAAM,UAAAO,eAAA,SAAe/C,EAAsB0C,OAC/Ba,EAAS,GACb,IACEA,EAASC,KAAKC,MAAMzD,EAAKa,OACzB,MAAO6C,IACThB,EAASa,EAAQvD,IAErBkC,EAvDA,GCCA,IAAAyB,EAAA,WAAA,SAAAA,KAiDA,OA/CIA,EAAAnB,UAAAS,OAAA,SAAOjD,EAAsB0C,GACzBlD,EAAEC,KAAK,CACHG,KAAM,OACNd,IAAKnC,KAAKkC,OAAO,6BACjBmB,KAAMA,EACN4D,QAAO,SAAG5D,GAAS,OAAA0C,EAAS1C,IAC5B6D,MAAK,WAAQ,OAAAnB,EAAS,UAI9BiB,EAAAnB,UAAAM,OAAA,SAAO9C,EAAsB0C,GACzB1C,EAAK8D,OAAS9D,EAAK8D,QAAU9D,EAAKqC,KAClC7C,EAAEC,KAAK,CACHG,KAAM,OACNd,IAAKnC,KAAKkC,OAAO,6BACjBmB,KAAMA,EACN4D,QAAO,SAAG5D,GAAS,OAAA0C,EAAS1C,IAC5B6D,MAAK,WAAQ,OAAAnB,EAAS,UAI9BiB,EAAAnB,UAAAuB,OAAA,SAAO/D,EAAsB0C,GACzB1C,EAAK8D,OAAS9D,EAAK8D,QAAU9D,EAAKqC,KAClC7C,EAAEC,KAAK,CACHX,IAAKnC,KAAKkC,OAAO,6BACjBmB,KAAMA,EACN4D,QAAO,SAAG5D,GAAS,OAAA0C,EAAS1C,IAC5B6D,MAAK,WAAQ,OAAAnB,EAAS,UAI9BiB,EAAAnB,UAAAa,KAAA,SAAKL,EAAmBN,GACpBlD,EAAEC,KAAK,CACHX,IAAKnC,KAAKkC,OAAO,2BACjBmB,KAAM,CACFgD,UAAWA,GAEfY,QAAO,SAAG5D,GAAS,OAAA0C,EAAS1C,GAAQA,EAAKgE,OAAS,KAClDH,MAAK,WAAQ,OAAAnB,EAAS,QAK9BiB,EAAAnB,UAAA3D,OAAA,SAAOC,GACH,OAAOG,KAAKI,QAAQP,IAG5B6E,EAjDA,UCFIM,aAAe,eACfC,SAAW,WACXC,SAAW,WACXC,UAAY,YACZC,UAAY,YACZC,UAAY,YACZC,WAAa,aACbC,KAAO,OACPC,OAAS,UCUPC,EAASC,EACfrE,OAAe,OAAIoE,EAKnB,IAAAE,EAAA,WAAA,SAAAA,IAAA,IAAA/B,EAAAlG,KAGIA,KAAAkI,gBAA0B,GAC1BlI,KAAAmI,QAAkB,sBAElBnI,KAAAoI,KAAOC,EACPrI,KAAAsI,KAAOC,EACPvI,KAAAwI,WAAaC,EACbzI,KAAA0I,YAAcC,EACd3I,KAAAX,UAAYA,EACZW,KAAA4I,UAAYjJ,EACZK,KAAA6I,gBAAkBC,EAClB9I,KAAA+I,iBAAmBC,EACnBhJ,KAAAiJ,QAAUC,EAEVlJ,KAAAmJ,WAAa,IAAInC,EACjBhH,KAAAoJ,SAAW,IAAI7D,EAAYvF,KAAKmJ,YAEhCnJ,KAAAqJ,QAAUrF,EAEVhE,KAAAsJ,UAAY,CACRC,KAAM,CACF,WACA,UACA,SACA,SACA,UACA,UACA,WAEJC,SAAU,CACN,UACA,WACA,YACA,SACA,YACA,oBAEJC,OAAQ,UACRC,KAAM,MACNC,OAAQ,QAGZ3J,KAAA4J,WAAa,GACb5J,KAAA6J,WAAa,GAEb7J,KAAA8J,OAAS,GAET9J,KAAA+J,QAAiB,GACjB/J,KAAAgK,UAAmB,GAqCnBhK,KAAAiK,iBAAgB,SAAIhH,GAAiB,OAAAA,IAASiG,EAAQ5E,YAEtDtE,KAAAkK,gBAAe,SAAIjH,GAAkB,OAAAA,IAASiG,EAAQ9E,WAEtDpE,KAAAmK,mBAAkB,SAAIlH,GAAkB,OAAAA,IAASiG,EAAQ7E,cAEzDrE,KAAAoK,gBAAe,SAAIC,GAAqB,OAAA1B,EAAYlE,aAAe4F,GAEnErK,KAAAsK,cAAa,SAAID,GAAqB,OAAA1B,EAAYjE,WAAa2F,GAE/DrK,KAAAuK,SAAQ,SAAIF,GAAqB,OAAA1B,EAAYnE,MAAQ6F,GAErDrK,KAAAwK,eAAc,SAAIH,GAAqB,OAAA1B,EAAYpE,YAAc8F,GAEjErK,KAAAyK,cAAa,SAAI3K,GAAS,OAAAoG,EAAKwE,WAAW5K,EAAMoG,EAAKyE,eAAe,iBAEpE3K,KAAA4K,cAAa,SAAI9K,GAAS,OAAAoG,EAAKwE,WAAW5K,EAAMoG,EAAKyE,eAAe,iBAEpE3K,KAAA6K,kBAAiB,SAAI/K,GAAS,OAAAoG,EAAKwE,WAAW5K,EAAMoG,EAAKyE,eAAe,sBAExE3K,KAAA0K,WAAU,SAAI5K,EAAMgL,GAAW,OAAA/C,EAAOjI,GAAMgL,OAAOA,IAo9BnD9K,KAAA+K,eAAc,SAAIC,GAAS,OAAA9E,EAAKoD,UAAUE,SAASwB,IAkInDhL,KAAAiL,SAAQ,SAAID,GAAiB,OAAAA,IAAS3C,EAAQpD,QAE9CjF,KAAAkL,UAAS,SAAIF,GAAiB,OAAAA,IAAS3C,EAAQnD,SAE/ClF,KAAAmL,OAAM,SAAIH,GAAiB,OAAAA,IAAS3C,EAAQlD,MAE5CnF,KAAAoL,SAAQ,SAAIJ,GAAiB,OAAAA,IAAS3C,EAAQjD,QAE9CpF,KAAAqL,QAAO,SAAIL,GAAiB,OAAAA,IAAS3C,EAAQ/C,OAm+BjD,OAxnEI2C,EAAApC,UAAAyF,aAAA,WAAA,IAAApF,EAAAlG,KAcI,GAbAsC,KAAKiJ,MAAMvL,KAAML,GAGbgE,OAA4B,qBAAKA,OAA4B,oBAAE6H,OAAS,GACxE7H,OAA4B,oBAAE8H,SAAO,SAAEC,OAC/BC,EAAMzF,EAAK0F,aAAaF,EAAOzH,MAC/B0H,EACA9I,EAAEG,OAAO2I,EAAKD,GAEdxF,EAAKmD,QAAQwC,KAAKH,MAI1B/H,OAA+B,uBAC/B,IAAK,IAAIF,KAAKE,OAA+B,uBAAG,KACxCgI,EAAM3L,KAAK4L,aAAanI,GACxBkI,IACAA,EAAIzH,MAAQP,OAA+B,uBAAEF,IAMrDE,OAA2B,qBAC3B3D,KAAKsJ,UAAY3F,OAA2B,oBAGhD3D,KAAKqJ,QAAQoC,SAAO,SAAWE,GACT,UAAdA,EAAIzH,QACJyH,EAAIzH,OAAQ,OA2BxB+D,EAAApC,UAAA8E,eAAA,SAAe1G,OACP0H,EAAM3L,KAAK4L,aAAa3H,GAC5B,OAAO0H,GAAOA,EAAIzH,OAGtB+D,EAAApC,UAAA+F,aAAA,SAAa3H,GACT,IAAK,IAAI6H,EAAI,EAAGA,EAAI9L,KAAKqJ,QAAQmC,OAAQM,IACrC,GAAI9L,KAAKqJ,QAAQyC,GAAG7H,OAASA,EACzB,OAAOjE,KAAKqJ,QAAQyC,IAKhC7D,EAAApC,UAAAkG,SAAA,SAAS9H,EAAW+H,EAAejG,GAAnC,IAAAG,EAAAlG,KACIA,KAAK8J,OAAO7F,GAAQjE,KAAK8J,OAAO7F,IAAS,GACzCjE,KAAK8J,OAAO7F,GAAM4H,KAAK9F,GACU,IAA7B/F,KAAK8J,OAAO7F,GAAMuH,QAClB,IAAIS,SAAO,SAAEC,GACTF,EAASE,MACVC,MAAI,SAAEjI,GACLgC,EAAK4D,OAAO7F,GAAMwH,SAAO,SAAEW,GACvBA,GAAMA,EAAGlI,aAENgC,EAAK4D,OAAO7F,OAK/BgE,EAAApC,UAAAwG,MAAA,SAAMtG,EAAUnD,GAAhB,IAAAsD,EAAAlG,KACIA,KAAKsM,aAAW,SAAEC,GACdxG,EAASwG,EAAQrG,EAAKsG,qBACvB5J,IAIPqF,EAAApC,UAAA4G,oBAAA,SAAoBC,EAAaxI,GAC7B,IACI,IAAKA,EAAO,KAGJhB,EAAayJ,eAAeC,QAAQF,GACxC,GAAIxJ,EAAO,CAEP,GADAA,EAAQ2D,KAAKC,MAAM5D,IACf,IAAI/C,MAAOe,UAAYgC,EAAM2J,KAJb,IAKhB,OAAO3J,EAAMG,KAEbsJ,eAAeG,WAAWJ,GAGlC,OAAO,EAEPC,eAAeI,QAAQL,EAAK7F,KAAKmG,UAAU,CACvCH,MAAM,IAAI1M,MAAOe,UACjBmC,KAAMa,KAKd+I,aAAaH,WAAWJ,GAC1B,MAAO3F,MAIbkB,EAAApC,UAAAqH,cAAA,SAAcR,EAAKrJ,GAEf,GADArD,KAAKmN,YAAcnN,KAAKmN,aAAe,QAC1B1M,IAAT4C,EACA,OAAOrD,KAAKmN,YAAYT,GAExB1M,KAAKmN,YAAYT,GAAOrJ,GAIhC4E,EAAApC,UAAAuH,SAAA,SAASC,GACLrN,KAAKqN,MAAQA,EACbrN,KAAKsN,YAAYD,IAGrBpF,EAAApC,UAAA0H,SAAA,WACI,OAAOvN,KAAKqN,OAASrN,KAAKsN,eAAiBhL,KAAKkL,SAGpDvF,EAAApC,UAAAyH,YAAA,SAAYD,OACJI,EAAK,kBACT,IACI,IAAKJ,EACD,OAAOJ,aAAaL,QAAQa,GAE5BR,aAAaF,QAAQU,EAAIJ,GAE/B,MAAOtG,MAGbkB,EAAApC,UAAA6H,cAAA,SAAc5N,GACV,OAAIA,EAAKoB,QAEoB,GAAlBpB,EAAK6N,WAAkB7N,EAAK8N,cAGnC9N,EAAOA,EAAK0C,MAAM,KACO,GAAlBqL,OAAO/N,EAAK,IAAW+N,OAAO/N,EAAK,MAIlDmI,EAAApC,UAAAS,OAAA,SAAO/C,EAAW0D,EAASrE,GAA3B,IAAAsD,EAAAlG,KACI,OAAOA,KAAK+C,SAAS,CACjBZ,IAAK,4BACLkB,KAAME,EACN0D,QAAO,SAAG6G,GACFA,GAASA,EAAMpI,MACfQ,EAAK6H,WAAWD,GACpB7G,EAAQ6G,KAEblL,IAGPqF,EAAApC,UAAAmI,kBAAA,SAAkBC,EAAQhH,EAASrE,GAAnC,IAAAsD,EAAAlG,KACQwN,EAAUS,GAAUA,EAAOZ,OAASrN,KAAKuN,WAC7CvN,KAAKkO,SAASV,GAAO,eACbM,EAAQ5H,EAAKiI,mBAAmBF,GAAUA,EAAOG,SACjDlI,EAAKmI,WAAWb,GAChBtH,EAAKoI,aAAaL,EAAQhH,EAASrE,GAC5BsD,EAAKqI,cAAcf,IAAYM,GAAS5H,EAAKsI,YAAYV,GAChE5H,EAAKuI,kBAAkBR,EAAQhH,EAASrE,GAExCsD,EAAKC,OAAO8H,EAAQhH,EAASrE,KAElCA,IAGPqF,EAAApC,UAAAM,OAAA,SAAO5C,EAAM0D,EAASrE,GAAtB,IAAAsD,EAAAlG,KACI,OAAOA,KAAK+C,SAAS,CACjBZ,IAAK,4BACLkB,KAAME,EACN0D,QAAO,SAAG6G,GACFA,GAASA,EAAMpI,MACfQ,EAAK6H,WAAWD,GACpB7G,GAAWA,EAAQ6G,KAExBlL,IAGPqF,EAAApC,UAAAyI,aAAA,SAAa/K,EAAM0D,EAASrE,GAA5B,IAAAsD,EAAAlG,KACI,OAAOA,KAAK+C,SAAS,CACjBZ,IAAK,0BACLkB,KAAME,EACN0D,QAAO,SAAG6G,GACFA,GAASA,EAAMpI,MACfQ,EAAK6H,WAAWD,GACpB7G,GAAWA,EAAQ6G,KAExBlL,IAGPqF,EAAApC,UAAA4I,kBAAA,SAAkBlL,EAAM0D,EAASrE,GAAjC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK+C,SAAS,CACjBZ,IAAK,gCACLkB,KAAME,EACN0D,QAAO,SAAG6G,GACFA,GAASA,EAAMpI,MACfQ,EAAK6H,WAAWD,GACpB7G,GAAWA,EAAQ6G,KAExBlL,IAGPqF,EAAApC,UAAAuB,OAAA,SAAO6G,EAAQlI,EAAUnD,GACrB,OAAO5C,KAAK2C,YAAY,CACpBR,IAAK,4BACLkB,KAAM4K,EACNhH,QAASlB,GACVnD,IAGPqF,EAAApC,UAAA6I,OAAA,SAAOT,EAAQhH,EAASrE,GAAxB,IAAAsD,EAAAlG,KACQwN,EAAUS,GAAUA,EAAOZ,OAASrN,KAAKuN,WAC7CvN,KAAKkO,SAASV,GAAO,WACbtH,EAAKmI,WAAWb,GAChBtH,EAAKyI,aAAaV,EAAQhH,EAASrE,GAC5BsD,EAAKqI,cAAcf,IAC1BtH,EAAK0I,kBAAkBX,EAAQhH,EAASrE,KAE7CA,IAIPqF,EAAApC,UAAAgJ,aAAA,SAAaZ,EAAQhH,EAASrE,GAC1B,OAAO5C,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,0BACLkB,KAAM4K,EACNhH,QAASA,GACVrE,IAGPqF,EAAApC,UAAA8I,aAAA,SAAaV,EAAQhH,EAASrE,GAA9B,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBR,IAAK,0BACLkB,KAAM4K,EACNhH,QAAO,SAAG6G,GACFA,GAASA,EAAMpI,MACfQ,EAAK6H,WAAWD,GACpB7G,GAAWA,EAAQ6G,KAExBlL,IAGPqF,EAAApC,UAAA+I,kBAAA,SAAkBX,EAAQhH,EAASrE,GAAnC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBR,IAAK,gCACLkB,KAAM4K,EACNhH,QAAO,SAAG6G,GACFA,GAASA,EAAMpI,MACfQ,EAAK6H,WAAWD,GACpB7G,GAAWA,EAAQ6G,KAExBlL,IAGPqF,EAAApC,UAAAiJ,iBAAA,SAAiBb,EAAQhH,EAASrE,GAAlC,IAAAsD,EAAAlG,KAKI,OAAOA,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,yBACLkB,KAAM4K,EACNhH,QAAO,SAAG6G,GACN7G,GAAWA,EAAQf,EAAK6H,WAAWD,MAExClL,IAIPqF,EAAApC,UAAAkJ,iBAAA,SAAiBvB,EAAiBzH,EAAoBnD,GAElD,OADA4K,EAAUA,GAAWxN,KAAKuN,WACnBvN,KAAKgP,eAAe,CAAC3B,MAAOG,GAAUzH,EAAUnD,IAG3DqF,EAAApC,UAAAmJ,eAAA,SAAef,EAAQhH,EAASrE,GAC5B5C,KAAKiP,gBAAgBhB,GAAM,SAAYiB,GACnCA,EAAQC,MAAI,SAAE3P,EAAGwC,GAAM,OAAAxC,EAAE4P,SAASC,cAAcrN,EAAEoN,aAClDnI,EAAQiI,KACTtM,IAGPqF,EAAApC,UAAAoJ,gBAAA,SAAgBhB,EAAQhH,EAASrE,GAAjC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBR,IAAK,6BACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,OACF6L,EAAU7L,GAAQA,EAAKiM,UAAY,IACvCJ,EAAUA,EAAQK,QAAM,SAAEC,GAAS,OAACA,EAAKC,UACjChE,SAAO,SAAEiE,GAAW,OAAAxJ,EAAKyJ,cAAcD,MAC/CzI,EAAQiI,IAEZhI,MAAK,WACDD,EAAQ,MAEbrE,GAAS,IAGhBqF,EAAApC,UAAA8J,cAAA,SAAcC,GAMV,OAHAA,EAAgB,OAAIvQ,EAAUuQ,EAAQR,SAASS,eAAiB,IAC5DD,EAAQE,SAAStN,MAAM,KAAK,GAChCoN,EAAQG,QAAU/P,KAAKgQ,qBAAqBJ,EAAQR,UAAYQ,EAAQE,UACjEF,GAGX3H,EAAApC,UAAAoK,gBAAA,SAAgBhC,EAAQlI,EAAUnD,GAC9B,OAAO5C,KAAK2C,YAAY,CACpBR,IAAK,6BACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,IACNA,EAAOA,GAAQA,EAAKgE,OAAS,IACxB8H,MAAI,SAAE3P,EAAGwC,GACV,OAAOxC,EAAE0Q,MAAQlO,EAAEkO,SAEvBnK,EAAS1C,IAEb6D,MAAK,WACDnB,EAAS,MAEdnD,GAAS,IAGhBqF,EAAApC,UAAAsK,SAAA,SAASpK,EAAUnD,GAAnB,IAAAsD,EAAAlG,KACQoQ,EAAW,gBAQf,GALAnD,aAAaH,WAAWsD,GAExBA,GAAY9N,KAAK+N,SAEjBrQ,KAAKgK,UAAYhK,KAAKgK,UAAUwB,QAAUxL,KAAKgK,WAAahK,KAAKyM,oBAAoB2D,IAAa,GAC9FpQ,KAAKgK,UAAUwB,OAAS,EACxB,OAAOzF,EAAS/F,KAAKgK,WAEzBhK,KAAK2C,YAAY,CACbR,IAAK,2BACL8E,QAAO,SAAG5D,OACFkJ,EAASrG,EAAKoK,YAAYjN,GAAQA,EAAKiM,UAAY,IACnD/C,EAAOf,OAAS,IAChBe,EAASrG,EAAKqK,gBAAgBhE,GAC9BrG,EAAK8D,UAAYuC,EACjBrG,EAAKuG,oBAAoB2D,EAAU7D,IAEvCxG,EAASwG,IAEbrF,MAAK,WAAQ,OAAAnB,EAAS,MACvBnD,GAAS,IAIhBqF,EAAApC,UAAA0K,gBAAA,SAAgBhE,GAAhB,IAAArG,EAAAlG,KACI,OAAOuM,EAAOgD,QAAM,SAAEiB,OACdC,EAASvK,EAAKwK,WAAWF,EAAMG,UACnC,OAAOF,KAAYA,EAAOG,cAIlC3I,EAAApC,UAAAgL,UAAA,SAAU9K,EAAenD,GAAzB,IAAAsD,EAAAlG,KACQoQ,EAAW,iBASf,OANAnD,aAAaH,WAAWsD,GAExBA,GAAY9N,KAAK+N,SAEjBrQ,KAAK+J,QAAU/J,KAAK+J,QAAQyB,QAAUxL,KAAK+J,SAAW/J,KAAKyM,oBAAoB2D,IAAa,GAExFpQ,KAAK+J,QAAQyB,OAAS,EACfzF,EAAS/F,KAAK+J,SAElB/J,KAAK2C,YAAY,CACpBU,KAAM,CAACyN,UAAW,GAClB3O,IAAK,6BACL8E,QAAO,SAAG5D,OACFkJ,EAASrG,EAAKoK,YAAYjN,GAAQA,EAAKgE,OAAS,IAChDkF,EAAOf,OAAS,IAEhBe,EAASrG,EAAK6K,cAAcxE,GAC5BrG,EAAK6D,QAAUwC,EACfrG,EAAKuG,oBAAoB2D,EAAUlK,EAAK6D,UAE5ChE,EAASwG,IAEbrF,MAAK,WAAQ,OAAAnB,EAAS,MACvBnD,GAAS,IAGhBqF,EAAApC,UAAAkL,cAAA,SAAcxE,GACV,OAAOA,EAAOgD,QAAM,SAAEiB,GAAU,QAAEA,EAAMI,cAGpC3I,EAAApC,UAAAyG,YAAR,SAAoBvG,EAAUnD,GAA9B,IAAAsD,EAAAlG,KACQA,KAAK+J,SAAW/J,KAAK+J,QAAQyB,OAAS,EACtCzF,EAAS/F,KAAK+J,QAAQiH,SAEtBhR,KAAK6Q,WAAS,SAAEtE,GAGZrG,EAAKgI,SAAS,IAAE,SAAG+C,GACf/K,EAAKgL,SAAWD,EAAKC,OACjBD,EAAKC,OACLhL,EAAKiK,UAAQ,SAAEgB,GAEX,IAAK,IAAIrF,EAAIqF,EAAS3F,OAAS,EAAGM,GAAK,EAAGA,IAEtC,QADIsF,EAAUD,EAASrF,GACduF,EAAI,EAAGA,EAAI9E,EAAOf,OAAQ6F,IAAK,KAChCb,EAAQjE,EAAO8E,GACnB,GAAIb,EAAMG,WAAaS,EAAQT,SAAU,CACrCpE,EAAO+E,OAAOD,EAAG,GACjBb,EAAMe,OAAQ,EACdhF,EAAOiF,QAAQhB,GACf,OAIZzK,EAASwG,KAEV3J,GAEHmD,EAASwG,KAEd3J,KAEJA,IAIXqF,EAAApC,UAAA4L,WAAA,SAAW1L,EAAU3D,GAArB,IAAA8D,EAAAlG,KACIA,KAAKsM,aAAW,SAAEjJ,OACVqO,EAAY,GAGhBrO,EAAKoI,SAAO,SAAE+D,GACVA,EAAKmC,SAAW,MAIpBtO,EAAKoI,SAAO,SAAE+D,GACV,GAAIA,EAAKoC,SAAU,KACXC,EAAc3L,EAAKwK,WAAWlB,EAAKoC,UACnCC,GACAA,EAAYF,SAAS9F,KAAK2D,QAG9BkC,EAAK7F,KAAK2D,MAIlBkC,EAAKrO,KAAOA,EACZ0C,GAAYA,EAAS2L,KACtBtP,IAGP6F,EAAApC,UAAAiM,eAAA,SAAetC,GACXA,EAAKuC,OAAS1S,EAAU,CAACmQ,EAAKwC,SAAUxC,EAAKmB,SAAUnB,EAAKnN,YAAYI,KAAK,KAAKoN,gBAGtF5H,EAAApC,UAAAoM,QAAA,SAAQ5E,OACA6E,EAAMlS,KAAK0Q,WAAWrD,GAC1B,OAAO6E,GAAOA,EAAIX,OAGtBtJ,EAAApC,UAAAsM,UAAA,SAAUlE,EAAQlI,EAAUnD,GAA5B,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,0BACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GACDA,GAASA,EAAKqC,MAWnBQ,EAAK6H,WAAW1K,GAChB0C,GAAYA,EAAS1C,IAVjB6C,EAAKgI,SAASD,EAAOZ,OAAK,WAClBnH,EAAKmI,WAAWJ,EAAOZ,OACvBnH,EAAKkM,gBAAgBnE,EAAQlI,EAAUnD,GAEvCmD,GAAYA,EAAS1C,QAQtCT,IAGPqF,EAAApC,UAAAwM,YAAA,SAAYpE,EAAQlI,EAAUnD,GAI1B,OAHIqL,EAAOqE,QACPrE,EAAOqE,MAAQtS,KAAKuS,iBAAiBtE,EAAOqE,QAEzCtS,KAAKmS,UAAUlE,EAAQlI,EAAUnD,IAG5CqF,EAAApC,UAAAuM,gBAAA,SAAgBnE,EAAQhH,EAASrE,GAAjC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBR,IAAK,wBACLkB,KAAM4K,EACNhH,QAAO,SAAG6G,GACFA,GAASA,EAAMpI,MACfQ,EAAK6H,WAAWD,GACpB7G,GAAWA,EAAQ6G,KAExBlL,IAGPqF,EAAApC,UAAA2M,eAAA,SAAevE,EAAQhH,EAASrE,GAAhC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBR,IAAK,2BACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GAAS,OAAA4D,EAAQf,EAAKuM,YAAYpP,GAAQA,EAAKgE,OAAS,OACnEzE,IAGPqF,EAAApC,UAAA6M,cAAA,SAAczE,EAAQlI,EAAUnD,GAC5B5C,KAAK2S,kBAAkB3S,KAAK4S,eAAgB3E,EAAQlI,EAAUnD,IAGlEqF,EAAApC,UAAA+M,eAAA,SAAe3E,EAAQlI,EAAUnD,GAAjC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,4BACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GAAS,OAAA0C,EAASG,EAAKuM,YAAYpP,GAAQA,EAAKgE,OAAS,OACpEzE,IAGPqF,EAAApC,UAAAgN,oBAAA,SAAoB5E,EAAQlI,EAAUnD,GAClC5C,KAAK2S,kBAAkB3S,KAAK8S,qBAAsB7E,EAAQlI,EAAUnD,IAGxEqF,EAAApC,UAAAiN,qBAAA,SAAqB7E,EAAQlI,EAAUnD,GAAvC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,iCACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GAAS,OAAA0C,EAASG,EAAKuM,YAAYpP,GAAQA,EAAKgE,OAAS,MACnE0L,UAAU,GACXnQ,IAGPqF,EAAApC,UAAAmN,qBAAA,SAAqB/E,EAAQlI,EAAUnD,GACnC5C,KAAK2S,kBAAkB3S,KAAKiT,sBAAuBhF,EAAQlI,EAAUnD,IAGzEqF,EAAApC,UAAAoN,sBAAA,SAAsBhF,EAAQlI,EAAUnD,GAAxC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,iCACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GAAS,OAAA0C,EAASG,EAAKuM,YAAYpP,GAAQA,EAAKgE,OAAS,MACnE6L,aAAa,GACdtQ,IAGPqF,EAAApC,UAAAsN,kBAAA,SAAkBlF,EAAQlI,EAAoBnD,GAA9C,IAAAsD,EAAAlG,KAEIA,KAAKkO,SAASD,EAAOZ,OAAK,WAElBnH,EAAK+L,QAAQhE,EAAOZ,OACpBnH,EAAKwM,cAAczE,EAAQlI,EAAUnD,GAErCsD,EAAK2M,oBAAoB5E,EAAQlI,EAAUnD,KAEhDA,IAGPqF,EAAApC,UAAAuN,gBAAA,SAAgBnF,EAAQlI,EAAUnD,GAC9B5C,KAAK2S,kBAAkB3S,KAAKqT,iBAAkBpF,EAAQlI,EAAUnD,IAGpEqF,EAAApC,UAAAwN,iBAAA,SAAiBpF,EAAQlI,EAAUnD,GAAnC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,wBACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GAAS,OAAA0C,EAASG,EAAKuM,YAAYpP,GAAQA,EAAKgE,OAAS,OACpEzE,IAGPqF,EAAApC,UAAAyN,cAAA,SAAcrF,EAAQlI,EAAUnD,GAC5B5C,KAAK2S,kBAAkB3S,KAAKuT,eAAgBtF,EAAQlI,EAAUnD,IAGlEqF,EAAApC,UAAA0N,eAAA,SAAetF,EAAQlI,EAAUnD,GAAjC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,sBACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GAAS,OAAA0C,EAASG,EAAKuM,YAAYpP,GAAQA,EAAKgE,OAAS,OACpEzE,IAGPqF,EAAApC,UAAA2N,mBAAA,SAAmBvF,EAAQlI,EAAUnD,GACjC5C,KAAK2S,kBAAkB3S,KAAKyT,oBAAqBxF,EAAQlI,EAAUnD,IAIvEqF,EAAApC,UAAA4N,oBAAA,SAAoBxF,EAAQlI,EAAUnD,GAAtC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,0BACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GAAS,OAAA0C,EAASG,EAAKuM,YAAYpP,GAAQA,EAAKgE,OAAS,OACpEzE,IAGPqF,EAAApC,UAAA6N,aAAA,SAAazF,EAAQlI,EAAUnD,GAC3B5C,KAAK2S,kBAAkB3S,KAAK2T,cAAe1F,EAAQlI,EAAUnD,IAGjEqF,EAAApC,UAAA8N,cAAA,SAAc1F,EAAQlI,EAAUnD,GAAhC,IAAAsD,EAAAlG,KACI,OAAOA,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,0BACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GAAS,OAAA0C,EAASG,EAAKuM,YAAYpP,GAAQA,EAAKgE,OAAS,OACpEzE,IAGPqF,EAAApC,UAAA+N,cAAA,SAAc3F,EAAalI,EAAenD,GAA1C,IAAAsD,EAAAlG,KACQ6T,EAAW,GACf5F,EAAOZ,MAAQY,EAAOZ,OAASrN,KAAKuN,WAGpCvN,KAAKkO,SAASD,EAAOZ,OAAK,WAEtBwG,EAAShI,KAAK,IAAII,SAAO,SAAEC,OACnB4H,EAAWjR,EAAEG,OAAO,GAAIJ,GAC5BkR,EAAS5M,MAAK,WACVgF,EAAQ,KAEZhG,EAAKwN,aAAazF,EAAQ/B,EAAS4H,OAGnC5N,EAAKmI,WAAWJ,EAAOZ,OAEvBwG,EAAShI,KAAK,IAAII,SAAO,SAAEC,OACnB4H,EAAWjR,EAAEG,OAAO,GAAIJ,GAC5BkR,EAAS5M,MAAK,WACVgF,EAAQ,KAEZhG,EAAKkN,gBAAgBnF,EAAQ/B,EAAS4H,OAGnC5N,EAAK6N,SAAS9F,EAAOZ,QAE5BwG,EAAShI,KAAK,IAAII,SAAO,SAAEC,OACnB4H,EAAWjR,EAAEG,OAAO,GAAIJ,GAC5BkR,EAAS5M,MAAK,WACVgF,EAAQ,KAEZhG,EAAKoN,cAAcrF,EAAQ/B,EAAS4H,OAM5C7H,QAAQ+H,IAAIH,GAAU1H,MAAI,SAAGvF,OACrBqN,EAAS,GACbrN,EAAO6E,SAAO,SAAEvH,GAAU,OAAA+P,EAASA,EAAOC,OAAOhQ,GAAS,OAC1D+P,EAAS/N,EAAKiO,qBAAqBF,GACnClO,EAASG,EAAKuM,YAAYwB,SAG/BrR,IAIPqF,EAAApC,UAAA4M,YAAA,SAAYwB,GAAZ,IAAA/N,EAAAlG,KACI,GAAKiU,EAKL,OAHAjU,KAAKmU,qBAAqBF,GAC1BA,EAAOxI,SAAO,SAAE+D,GAAS,OAAAtJ,EAAK6H,WAAWyB,MACzCxP,KAAKoU,WAAWH,GACTA,GAGXhM,EAAApC,UAAAsO,qBAAA,SAAqBF,GACjB,GAAIA,EAAOzI,OAAS,EAChB,IAAK,IAAIM,EAAI,EAAGA,EAAImI,EAAOzI,OAAQM,IAC/B,IAAK,IAAIuF,EAAIvF,EAAI,EAAGuF,GAAK,EAAGA,IACxB,GAAI4C,EAAOnI,GAAGpG,OAASuO,EAAO5C,GAAG3L,MAAQuO,EAAOnI,GAAGuI,MAAQJ,EAAO5C,GAAGgD,IAAK,CACtEJ,EAAO3C,OAAOxF,EAAG,KACfA,EACF,MAKhB,OAAOmI,GAGXhM,EAAApC,UAAAuO,WAAA,SAAWH,GAIP,OAFAjU,KAAKsU,eAAeL,GACpBjU,KAAKuU,kBAAkBN,GAChBA,GAGXhM,EAAApC,UAAAyO,eAAA,SAAeL,GAEX,OADAjU,KAAKwU,MAAMP,EAAQ,QACZA,GAGXhM,EAAApC,UAAA0O,kBAAA,SAAkBN,GAEd,IAAK,IAAInI,EAAI,EAAGA,EAAImI,EAAOzI,OAAQM,IAAK,KAChC0D,EAAOyE,EAAOnI,GAClB0D,EAAKiF,OAAS5G,OAAO2B,EAAKiF,SAAW,EAEjCjF,EAAKiF,OAAS,IACdC,EAAUlF,GACV1D,EAAImI,EAAOvU,QAAQ8P,IAI3B,SAASkF,EAAUlF,GACf,GAAoB,IAAhBA,EAAKiF,OAAc,KACfhV,EAAQwU,EAAOvU,QAAQ8P,GAC3B,GAAI/P,EAAQ,EAAG,KACPkV,EAAMV,EAAOxU,EAAQ,GACrB+P,EAAK6E,MAAQM,EAAIN,MAAuB,IAAfM,EAAIF,QAAgBjF,EAAKiF,OAASE,EAAIF,UAC/DR,EAAOxU,GAASkV,EAChBV,EAAOxU,EAAQ,GAAK+P,EACpBkF,EAAUlF,MAM1B,OAAOyE,GAIXhM,EAAApC,UAAA2O,MAAA,SAAMI,EAAKC,GACP,IAAK,IAAI/I,EAAI,EAAGA,EAAI8I,EAAIpJ,OAAQM,IAC5B,GAAU,IAANA,EAAJ,KAGI0D,EAAOoF,EAAI9I,GACXgJ,EAAOF,EAAI9I,EAAI,GAEf0D,EAAKqF,GAAWC,EAAKD,KACrBD,EAAI9I,GAAKgJ,EACTF,EAAI9I,EAAI,GAAK0D,EACb1D,GAAK,KAMjB7D,EAAApC,UAAAkP,uBAAA,SAAuBd,EAAQe,GAC3B,OAAIA,GAAYA,EAASxJ,OAAS,EACvByI,EAAO1E,QAAM,SAAEzB,GAClB,IAAK,IAAIhC,EAAI,EAAGA,EAAIkJ,EAASxJ,OAAQM,IACjC,GAAIgC,EAAMiE,OAAOrS,QAAQsV,EAASlJ,IAAM,EACpC,OAAO,EAGf,OAAO,KAGRmI,EAAOjD,SAGlB/I,EAAApC,UAAAkI,WAAA,SAAWD,GA8BP,OA5BAA,EAAMmH,SAAWnH,EAAMpI,KAAOoI,EAAM9C,KAAO8C,EAAMuG,IACjDrU,KAAK6J,WAAWiE,EAAMmH,UAAYnH,EAClC9N,KAAK6J,WAAWiE,EAAMpI,MAAQoI,EAEzBA,EAAMoH,WAEPlV,KAAKmV,kBAAkBrH,GAEnBnK,OAAyB,kBACzBA,OAAyB,iBAAEmK,GAG/BA,EAAMsH,eAAiBpV,KAAKqV,kBAAkBvH,EAAMwH,SAAW,IAC/DxH,EAAMyH,gBAAkBvV,KAAKqV,kBAAkBvH,EAAM0H,UAAY,IAEjExV,KAAKyV,YAAY3H,GACjB9N,KAAK0V,oBAAoB5H,GACzB9N,KAAK2V,eAAe7H,GACpB9N,KAAK4V,iBAAiB9H,GACtB9N,KAAK6V,YAAY/H,GAEjBA,EAAMzD,SAAWyD,EAAMzD,UAAY,GACnCyD,EAAMgI,aAAeC,EAAgBjI,EAAMzD,UAE3CyD,EAAMkI,WAAalI,EAAMmI,SAEzBnI,EAAMoH,UAAW,GAEdpH,GAGX7F,EAAApC,UAAAsP,kBAAA,SAAkBrH,GAAlB,IAAA5H,EAAAlG,KACQ2L,EAAW,GAEf,IAAK,IAAIlI,KAAK8E,EACVoD,EAAIlI,GAAK,GAGbqK,EAAMoB,QAAUpB,EAAMoB,SAAW,GACjCpB,EAAMoI,UAAY,GAElBpI,EAAMoB,QAAQzD,SAAO,SAAE+D,GAEnBA,EAAKvL,KAAOiC,EAAKiQ,gBAAgB3G,GACjCA,EAAKtL,MAAQgC,EAAKkQ,cAAc5G,GAG5BA,EAAKC,MACLD,EAAKvM,KAAO6F,EAAgBjF,MACrB2L,EAAKM,SACZN,EAAKvM,KAAO6F,EAAgB/E,KAE5ByL,EAAKvM,KAAO6F,EAAgBhF,MAGhC6H,EAAI6D,EAAKyB,MAAQtF,EAAI6D,EAAKyB,OAAS,GACnCtF,EAAI6D,EAAKyB,MAAMpF,KAAK2D,GAEhBA,EAAKyB,OAAS1I,EAAgBxD,SAC9B+I,EAAMuI,QAAU7G,EAAKM,SACrBhC,EAAMsB,SAAWI,EAAKJ,SACtBtB,EAAMwI,UAAYpQ,EAAKqQ,aAAazI,EAAMuI,SAC1CvI,EAAM0I,WAAa1I,EAAMsB,SAAW,IAAMtB,EAAMuI,QAAU,KAE1DvI,EAAMoI,UAAUrK,KAAK2D,MAI7B1B,EAAM2I,YAAczW,KAAK0W,oBAAoB/K,EAAI9G,UACjDiJ,EAAM6I,UAAY3W,KAAK0W,oBAAoB/K,EAAI7G,QAG/CgJ,EAAM8I,WAAa5W,KAAK0W,oBAAoB/K,EAAIhH,UAChDmJ,EAAM+I,WAAa/I,EAAMgJ,YAAc9W,KAAK0W,oBAAoB/K,EAAI/G,UAEpEkJ,EAAMiJ,cAAgBpL,GAG1B1D,EAAApC,UAAA6Q,oBAAA,SAAoBxH,OACZ5P,EAAM,GACN+D,EAAOrD,KAAKgX,qBAAqB9H,GACrC,IAAK,IAAIzL,KAAKJ,EAAM,KACZgE,EAAQhE,EAAKI,GACb+M,EAAQnJ,EAAMkI,QAAM,SAAEC,GAAS,OAAAA,EAAKvM,OAAS6F,EAAgBhF,SAAO,GACpE0M,IACAlR,GAAO,MAAQkR,EAAMyG,UAAY,UAGrC5P,EAAMoE,SAAO,SAAE+D,GACPA,EAAKvM,OAAS6F,EAAgBhF,QAC9BxE,GAAOkQ,EAAKvL,KAAO,SAG3B3E,EAAMA,EAAI0R,MAAM,GAAI,GACpB1R,GAAO,OAEX,OAAOA,EAAI0R,MAAM,GAAI,IAGzB/I,EAAApC,UAAA6P,oBAAA,SAAoB5H,GAChB,IAAK,IAAIrK,KAAKqK,EAAMoJ,UAChBpJ,EAAM,IAAMrK,GAAKqK,EAAMoJ,UAAUzT,GAErCqK,EAAM2G,OAAS5G,OAAOC,EAAM2G,SAAW,EAEnC3G,EAAMqJ,WACNrJ,EAAM7K,KAAO6K,EAAMqJ,WAI3BlP,EAAApC,UAAAuR,UAAA,SAAUC,GAKN,OAJAA,EAAWxU,EAAEG,OAAO,GAAIqU,GACxBrX,KAAKsX,eAAeD,GACpBA,EAASE,UAAYF,EAASG,KAAK1M,OAAO,OAC1CuM,EAASI,OAASJ,EAASK,GAAG5M,OAAO,OAC9BuM,GAGXpP,EAAApC,UAAAyR,eAAA,SAAexJ,GACX,GAAIA,EAAO,KACHhO,OAAI,EACJgO,GAASA,EAAMpI,OACf5F,EAAO,IAAIK,KAAK2N,EAAM6J,KAAM,EAAG7J,EAAMuG,MAC5BnT,YACL4M,EAAM0J,KAAO,IAAIrX,KAAKL,EAAKoB,UAA8B,GAAlB4M,EAAMyJ,UAAiB,KAC9DzJ,EAAM4J,GAAK,IAAIvX,KAAKL,EAAKoB,UAA2B,GAAf4M,EAAM2J,OAAc,MAG5D3X,GAASA,EAAKoB,aACfpB,EAAO,IAAIK,MACN0B,SAAS/B,EAAK6N,WAAa,EAAG,EAAG,EAAG,GACzCG,EAAM0J,KAAO1X,GACbA,EAAO,IAAIK,KAAKL,IACX+B,SAAS/B,EAAK6N,WAAa,GAChCG,EAAM4J,GAAK5X,KAKvBmI,EAAApC,UAAA8P,eAAA,SAAe7H,GACX9N,KAAKsX,eAAexJ,GAGpBA,EAAMrE,OAA2B,SAAlBqE,EAAM8J,QAErB9J,EAAM+J,QAAU7X,KAAKyK,cAAcqD,EAAM0J,MACrC1J,EAAMrE,QACNqE,EAAMgK,aAAehK,EAAMiK,UAAY/X,KAAKsJ,UAAUG,OACtDqE,EAAMkK,QAAUhY,KAAKsJ,UAAUG,SAE/BqE,EAAMgK,aAAe9X,KAAK4K,cAAckD,EAAM0J,MAC9C1J,EAAMiK,UAAY/X,KAAK4K,cAAckD,EAAM4J,IAC3C5J,EAAMkK,QAAUlK,EAAMgK,aAAe,MAAQhK,EAAMiK,WAGvDjK,EAAM+J,SAAW,KAAO/J,EAAMkK,QAE9BlK,EAAMmK,MAAQnK,EAAM0J,KACpB1J,EAAMoK,IAAMpK,EAAM4J,GAGd5J,EAAMqK,aACNrK,EAAMsK,WAAa,IAAIjY,KAAK2N,EAAMqK,YAClCrK,EAAMuK,cAAgBrY,KAAK6K,kBAAkBiD,EAAMsK,aAGnDtK,EAAMwK,aACNxK,EAAMyK,WAAa,IAAIpY,KAAK2N,EAAMwK,YAClCxK,EAAM0K,cAAgBxY,KAAK6K,kBAAkBiD,EAAMyK,iBAGnDE,GAAc,IAAItY,MAAOe,WAAa4M,EAAMwK,YAAcxK,EAAMqK,aACpEM,GAAW,MACO,IACdA,EAAc,GAEdA,GAAezY,KAAKkI,kBACpB4F,EAAM4K,eAAgB,EACtB5K,EAAM6K,cAAgB3Y,KAAK4Y,kBAAgC,GAAdH,KAIrDxQ,EAAApC,UAAA+P,iBAAA,SAAiB9H,GAGbA,EAAMiE,OAAS,GACfjE,EAAM+K,SAAW,GAEb/K,EAAMwH,UACNxH,EAAMiE,OAAS1S,EAAUyO,EAAMwH,QAAQzF,gBAIvC/B,EAAM0H,WACN1H,EAAMiE,QAAU,IAAM1S,EAAUyO,EAAM0H,SAAS3F,gBAGnD,IAAK,IAAI/D,EAAI,EAAGA,EAAIgC,EAAMoB,QAAQ1D,OAAQM,IAAK,KACvC4D,EAAS5B,EAAMoB,QAAQpD,GACvB4D,EAAON,WACPtB,EAAMiE,QAAU,IAAM1S,EAAUqQ,EAAON,SAASS,gBAChDH,EAAOI,WACPhC,EAAMiE,QAAU,IAAMrC,EAAOI,SAASD,cAGlCH,EAAOuB,OAAS1I,EAAgBxD,SAChC+I,EAAM+K,SAAShN,KAAK6D,EAAOI,WAMnChC,EAAMgL,aACNhL,EAAMgL,YAAYrN,SAAO,SAAEsN,GACvBA,EAAK1L,MAAQS,EAAM6C,aAK/B1I,EAAApC,UAAA4P,YAAA,SAAY3H,GAER,GAAIA,EAAMkL,MAAO,KACTC,EAAW,GACfnL,EAAMkL,MAAMxW,MAAM,KAAKiJ,SAAO,SAAE+D,GAEZ,UADhBA,EAAOA,EAAKhN,MAAM,MACT,GACLyW,EAAIhW,KAAOgW,EAAID,MAAQC,EAAIC,OAAS1J,EAAK,GACtB,UAAZA,EAAK,KACZyJ,EAAIE,OAAS3J,EAAK,GAAGhN,MAAM,SAG/BsL,EAAMsL,SACNH,EAAIG,OAAS,IAAIjZ,KAAK2N,EAAMsL,SAE5BtL,EAAMuL,QACNJ,EAAII,MAAQ,IAAIlZ,KAAK2N,EAAMuL,QAE/BvL,EAAMwL,OAASL,IAKvBhR,EAAApC,UAAAgQ,YAAA,SAAY/H,KAMZ7F,EAAApC,UAAAwI,WAAA,SAAWhB,GAEP,OADAA,EAAQA,GAASrN,KAAKuN,WACfvN,KAAK4J,WAAWyD,MAAYrN,KAAK4J,WAAWyD,GAAOkM,UAG9DtR,EAAApC,UAAA0I,cAAA,SAAclB,GAEV,OADAA,EAAQA,GAASrN,KAAKuN,WACfvN,KAAK4J,WAAWyD,MAAYrN,KAAK4J,WAAWyD,GAAOmM,cAG9DvR,EAAApC,UAAAkO,SAAA,SAAS1G,GAEL,OADAA,EAAQA,GAASrN,KAAKuN,WACfvN,KAAK4J,WAAWyD,MAAYrN,KAAK4J,WAAWyD,GAAOoM,QAG9DxR,EAAApC,UAAA6T,eAAA,SAAeC,OACP1L,EAAS,GASb,OARA0L,EAAQA,GAASnE,SAASoE,QACpBra,QAAQ,IAAK,IAAIiD,MAAM,KAAKiJ,SAAO,SAAE+D,GACvC,GAAIA,EAAM,KACFqK,EAAarK,EAAK9P,QAAQ,KAC1Bma,GAAc,IACd5L,EAAOuB,EAAKwB,MAAM,EAAG6I,IAAerK,EAAKwB,MAAM6I,EAAa,QAGjE5L,GAGXhG,EAAApC,UAAAiU,iBAAA,SAAiB7L,OACT0L,EAAQ,GACZ,IAAK,IAAIlW,KAAKwK,EACV0L,GAASlW,EAAI,IAAMsW,mBAAmB9L,EAAOxK,IAAM,IAEvD,OAAOkW,EAAM3I,MAAM,GAAI,IAG3B/I,EAAApC,UAAAmU,cAAA,SAAc3J,EAAUjO,GACpB,OAAOH,EAAQC,OAAO,2BAA4BE,GAC9C,aAAeiO,EAAW,iBAGlCpI,EAAApC,UAAAoU,qBAAA,SAAqBnM,EAAO/H,EAAoBmU,EAAsBtX,GAAtE,IAAAsD,EAAAlG,KACQgL,EAAO8C,EAAM9C,KACjB,GAAIhL,KAAKqL,QAAQL,GACbjF,QADJ,CAIA,IAAK+H,EAAMpI,KACP,OAAOK,EAAS,CACZoU,MAAM,EACNC,YAAY,IAIpBF,EAAiBA,GAAkBla,KAAKuN,YAAcO,EAAM6C,SAE5D3Q,KAAKkO,SAASgM,GAAc,eAIpBG,EAFJnU,EAAK6H,WAAWD,OAGVwM,EAAYpU,EAAKmI,WAAW6L,IAC7BhU,EAAKqI,cAAc2L,IAAmBhU,EAAKqU,kBAAkBzM,GAC5D0M,GAAmBtU,EAAK+E,SAASD,KAAU9E,EAAKkF,SAASJ,IAASsP,EACxE,GAAIxM,EAAM6C,WAAauJ,EAAgB,KAC7BO,EAAgBvU,EAAKwU,kBAAkB5M,GAUzCuM,EARAvM,EAAM7K,OAASwF,EAAW/D,UAAawB,EAAKyE,eAAe,wBAQ7C,CACVwP,KAAMM,GAAiBD,EACvBG,QAASL,IAAcpU,EAAKiF,OAAOH,IAASyP,GAC5CG,OAAQN,GAAapU,EAAKiF,OAAOH,GACjC6P,KAAMJ,IAAkBH,EACxBQ,OAAS5U,EAAKiF,OAAOH,IAAS8C,EAAMwI,YAC9BpQ,EAAKkF,SAASJ,IAAS9E,EAAKgF,UAAUF,KAAUsP,EACtD5L,OAAQ4L,GAAapU,EAAKgF,UAAUF,GACpC+P,OAAQN,GAdE,CACVN,KAAMM,EACNM,OAAQN,QAkBhBJ,EAAc,GACVnU,EAAKgF,UAAU4C,EAAM9C,OAAS9E,EAAK8U,gBAAgBlN,EAAOoM,IACtDhU,EAAK+U,uBAAuBnN,EAAOoM,KACvCG,EAAc,CAACa,gBAAgB,IAGvCb,EAAYc,OAAQ,EACpBd,EAAYe,iBAAmBlV,EAAKkE,gBAAgB0D,EAAMzD,WAAayD,EAAMuN,YAE7EtV,EAASsU,KACVzX,KAGPqF,EAAApC,UAAA6U,kBAAA,SAAkB5M,GACd,OAAOA,EAAMwI,WAAatW,KAAKiL,SAAS6C,EAAM9C,OAGlD/C,EAAApC,UAAAyV,eAAA,SAAexN,GACX,OAAO9N,KAAKqO,WAAWP,EAAM6C,WAGjC1I,EAAApC,UAAA0U,kBAAA,SAAkBzM,GACd,OAAO9N,KAAKuO,cAAcT,EAAM6C,WAAa7C,EAAMwI,WAGvDrO,EAAApC,UAAA0V,kBAAA,SAAkBzN,EAAiB0N,GAC/B,OAAOxb,KAAKyb,YAAY3N,EAAO0N,KAAgBxb,KAAK0a,kBAAkB5M,IAClE9N,KAAKua,kBAAkBzM,IACvB9N,KAAKsb,eAAexN,KAG5B7F,EAAApC,UAAAoV,uBAAA,SAAuBnN,EAAiBN,GACpC,OAAOxN,KAAKkL,UAAU4C,EAAM9C,QAAUhL,KAAKyb,YAAY3N,EAAON,IAAYxN,KAAKqO,WAAWb,IAG9FvF,EAAApC,UAAA4V,YAAA,SAAY3N,EAAiB0N,GACzB,OAAO1N,EAAM6C,WAAa6K,GAa9BvT,EAAApC,UAAA6V,kBAAA,SAAkBzN,EAAQlI,EAAUnD,GAApC,IAAAsD,EAAAlG,KACIA,KAAK2b,qBAAqB1N,GAAM,SAAG2N,GAC/B1V,EAAK2V,sBAAsB5N,GAAM,SAAG6N,GAChCA,EAAKrQ,SAAO,SAAEyG,GAAQ,OAAA0J,EAAM/P,KAAKqG,MACjCnM,EAAS6V,QAEdhZ,IAGPqF,EAAApC,UAAA8V,qBAAA,SAAqB1N,EAAQlI,EAAUnD,GAAvC,IAAAsD,EAAAlG,KACQwN,EAAUS,EAAOZ,OAASrN,KAAKuN,WAC/B0J,EAAYjX,KAAK+b,eAAevO,GACpCxN,KAAK+O,iBAAiBvB,GAAO,SAAG0B,OACxB8M,EAAU/N,EAAO+N,SAAW,GAC5BC,EAAQhO,EAAOgO,QAAU,EACzB/F,EAAY,GAChB8F,EAAU3c,EAAU2c,GAASnM,cAC7B,IAAK,IAAI/D,EAAI,EAAGA,EAAIoD,EAAQ1D,OAAQM,IAAK,KACjC4D,EAASR,EAAQpD,GAErB,IAAKkQ,GAAWtM,EAAOqC,OAAOrS,QAAQsc,IAAY,EAAG,KAC7CE,EAAWhW,EAAKiW,iBAAiBzM,GAKrC,GAJAwM,EAAS1O,QAAUA,EACnB0O,EAASjF,UAAYA,EACrBf,EAAUrK,KAAKqQ,GAEXD,EAAQ,GAAK/F,EAAU1K,QAAUyQ,EACjC,OAIZlW,EAASmQ,KACVtT,IAGPqF,EAAApC,UAAAgW,sBAAA,SAAsB5N,EAAQlI,EAAUnD,GAAxC,IAAAsD,EAAAlG,KACIA,KAAKoc,iBAAiBnO,GAAM,SAAG1B,GAC3BxG,EAASwG,EAAO8P,KAAG,SAAE7L,GAAU,OAAAtK,EAAKoW,gBAAgB9L,SACrD5N,IAGPqF,EAAApC,UAAAmK,qBAAA,SAAqBZ,GACjB,OAAIpP,KAAK2K,eAAe,wBACb3K,KAAK2K,eAAe,wBAA0ByE,EAElDA,GAGXnH,EAAApC,UAAAsW,iBAAA,SAAiBzM,GACb,MAAO,CACHI,SAAUJ,EAAOI,SACjBV,SAAUM,EAAON,SACjBW,QAAS/P,KAAKgQ,qBAAqBN,EAAON,UAC1CnM,KAAM6F,EAAgB/E,OAI9BkE,EAAApC,UAAAyW,gBAAA,SAAgB9L,GACZ,MAAO,CACHhD,QAASgD,EAAMG,SACfsG,UAAWzG,EAAMwB,SACjB/O,KAAM6F,EAAgBhF,QAI9BmE,EAAApC,UAAA0W,gBAAA,SAAgB9M,EAAejC,GAE3B,MAAO,CACHiC,MAAOA,EACPjC,QAHJA,EAAUA,GAAWxN,KAAKuN,WAItB0J,UAAWjX,KAAK+b,eAAevO,GAC/BvK,KAAM6F,EAAgBjF,QAK9BoE,EAAApC,UAAA2W,mBAAA,SAAmBvO,EAAQlI,EAAUnD,GAArC,IAAAsD,EAAAlG,KACI,IAAKiO,IAAWA,EAAO+N,QACnB,OAAOjW,EAAS,IAGpBkI,EAAOgO,MAAQhO,EAAOgO,OAAS,EAE/Bjc,KAAKyc,kBAAkBxO,GAAM,SAAG2N,GAC5B1V,EAAKkW,iBAAiBnO,GAAM,SAAG6N,GAC3B/V,EAAS6V,EAAM1H,OAAO4H,SAE3BlZ,IAGPqF,EAAApC,UAAA4W,kBAAA,SAAkBxO,EAAQlI,EAAUnD,GAEhC5C,KAAKgP,eAAe,CAChB3B,MAAOY,EAAOZ,QACjB,SAAG6B,GAGA,QAFI0M,EAAQ,GACRI,EAAU3c,EAAU4O,EAAO+N,QAAQnM,eAC9B/D,EAAI,EAAGA,EAAIoD,EAAQ1D,OAAQM,IAAK,KACjC4Q,EAAOxN,EAAQpD,GACnB,GAAI4Q,EAAK3K,OAAOrS,QAAQsc,IAAY,IAChCJ,EAAM/P,KAAK,CACP5H,KAAMyY,EAAKtN,SACXlL,MAAOwY,EAAK5M,SACZ7M,KAAM6F,EAAgB/E,KACtB2L,OAAQgN,IAGRd,EAAMpQ,QAAUyC,EAAOgO,OACvB,MAIZlW,EAAS6V,KACVhZ,IAGPqF,EAAApC,UAAAuW,iBAAA,SAAiBnO,EAAQlI,EAAUnD,OAC3BS,EAAO,GACXrD,KAAKsM,aAAW,SAAEwP,GAGd,QADIpP,EAAMrN,EAAU4O,EAAO+N,SAASnM,cAC3B/D,EAAI,EAAGA,EAAIgQ,EAAKtQ,OAAQM,IAAK,KAC9B0D,EAAOsM,EAAKhQ,GAChB,GAAI0D,EAAKuC,OAAOrS,QAAQgN,IAAQ,IAC5BrJ,EAAKwI,KAAK2D,GACNnM,EAAKmI,QAAUyC,EAAOgO,OACtB,MAGZlW,EAAS1C,KACVT,IAGPqF,EAAApC,UAAA8W,WAAA,SAAWnN,EAAMpN,EAAiB0L,GAC9B,IAAK0B,EACD,MAAO,OAGPrN,EAFAkL,EAAQmC,EAAKnC,OAASrN,KAAKuN,WAC3BqP,EAAQ5c,KAAK4J,WAAWyD,GAU5B,OARIuP,GAASA,EAAM1L,QAAUlR,KAAKiS,QAAQ5E,GACtClL,EAAM,yBACCnC,KAAKgb,gBAAgBlN,EAAO9N,KAAKuN,aACxCF,EAAQrN,KAAKuN,WACbpL,EAAM,0BAENA,EAAM,mCAEHnC,KAAK6c,cAAc1a,EAAKkL,EAAOjL,GAAU,WAAaoN,EAAK9J,KAAO,YAAc8J,EAAKsN,OAAS,UAAYzP,GAGrHpF,EAAApC,UAAAkX,eAAA,SAAevN,EAAMpN,EAAiB0L,OAC9B3L,EAAMnC,KAAK2c,WAAWnN,EAAMpN,EAAQ0L,GAIxC,OAHI0B,EAAKuJ,MAA8C,QAAtCvJ,EAAKuJ,KAAK/H,OAAO,GAAGnB,gBACjC1N,GAAO,gBAAiB,IAAIhC,MAAOe,WAEhCiB,GAGX8F,EAAApC,UAAAmV,gBAAA,SAAgBlN,EAAiBN,GAC7B,GAAIM,GAASN,EACT,IAAK,IAAI1B,EAAI,EAAGA,EAAIgC,EAAMoB,QAAQ1D,OAAQM,IAAK,KACvC4D,EAAS5B,EAAMoB,QAAQpD,GAC3B,GAAI4D,EAAOzM,OAAS6F,EAAgBhF,OAAS4L,EAAOlC,UAAYA,EAC5D,OAAO,IAMvBvF,EAAApC,UAAAmX,YAAA,SAAYtX,GACR,IAAK,IAAIoG,EAAI,EAAGA,EAAI9L,KAAK+J,QAAQyB,OAAQM,IACrC,GAAI9L,KAAK+J,QAAQ+B,GAAGpG,OAASA,EACzB,OAAO1F,KAAK+J,QAAQ+B,IAKhC7D,EAAApC,UAAA6K,WAAA,SAAWuM,GACP,IAAK,IAAInR,EAAI,EAAGA,EAAI9L,KAAK+J,QAAQyB,OAAQM,IACrC,GAAI9L,KAAK+J,QAAQ+B,GAAG6E,WAAasM,EAC7B,OAAOjd,KAAK+J,QAAQ+B,IAKhC7D,EAAApC,UAAAkW,eAAA,SAAekB,OACPzM,EAAQxQ,KAAK0Q,WAAWuM,GAC5B,OAAOzM,GAASA,EAAMwB,UAAY,IAGtC/J,EAAApC,UAAAqX,eAAA,SAAeC,GACX,IAAK,IAAIrR,EAAI,EAAGA,EAAI9L,KAAK+J,QAAQyB,OAAQM,IACrC,GAAI9L,KAAK+J,QAAQ+B,GAAGzJ,aAAe8a,EAC/B,OAAOnd,KAAK+J,QAAQ+B,IAKhC7D,EAAApC,UAAAgX,cAAA,SAAc1a,EAAKkL,EAAOjL,OAClBoN,EAAOxP,KAAK0Q,WAAWrD,GAC3B,OAAOpL,EAAQC,OAAOC,EAAKC,EAAQoN,GAAQA,EAAKnN,aAGpD4F,EAAApC,UAAAqI,SAAA,SAASb,EAAOtH,EAAUnD,GAA1B,IAAAsD,EAAAlG,KAII,GAFAqN,EAAQA,GAASrN,KAAKuN,WAElBvN,KAAK4J,WAAWyD,GAChB,OAAOtH,EAAS/F,KAAK4J,WAAWyD,IAGpCrN,KAAK2C,YAAY,CACbR,IAAKnC,KAAKmI,QACV9E,KAAM,CAACgK,MAAOA,GACdpG,QAAO,SAAG5D,GACN,KACIA,EAAOwD,KAAKC,MAAMzD,IACT6N,SACLhL,EAAK0D,WAAWyD,GAAShK,EACzBf,KAAK+N,SAAWhN,EAAKgN,UAEzBtK,EAAS1C,GACX,MAAO0D,GACLhB,EAAS,MAGjBmB,MAAK,WACDnB,EAAS,MAEdnD,GAAS,IAGhBqF,EAAApC,UAAAuX,UAAA,SAAUC,EAAUtX,EAAUnD,GAA9B,IAAAsD,EAAAlG,KACQ6T,EAAW,GACfwJ,EAAS5R,SAAO,SAAE+B,GACdqG,EAAShI,KAAK,IAAII,SAAO,SAAEC,GACvBhG,EAAKgI,SAASV,EAAStB,EAAStJ,UAGxCqJ,QAAQ+H,IAAIH,GAAU1H,MAAI,SAAEvF,GAAW,OAAAb,EAASa,OAGpDqB,EAAApC,UAAAyX,sBAAA,SAAsBrJ,EAAQnU,EAAYF,GAGtC,QAFI2d,EAAY,GACZjd,EAAYX,EAAUM,iBAAiBH,EAAMF,cACxCkM,OACD/K,EAAYpB,EAAUoB,UAAUT,GACpCid,EAAU1R,KAAK2R,EAAKC,kBAChBxJ,EAAO1E,QAAM,SAAEzB,GACX,OAAOA,EAAMuG,MAAQtT,KAEzBT,IAEJA,EAAUF,QAAQE,EAAUD,UAAY,WARnCyL,EAAI,EAAGA,EAAI,EAAGA,QAUvB,OAAOyR,GAGXtV,EAAApC,UAAA6X,uBAAA,SAAuBH,OACfI,EASJ,OARAJ,EAAU9R,SAAO,SAAEmS,GACfA,EAASvW,MAAMoE,SAAO,SAAEqC,OAChB+P,EAAkB/P,EAAMyK,YAAczK,EAAMsK,aAC3CuF,GAAcA,EAAaE,KAC5BF,EAAaE,SAIlBF,GAGX1V,EAAApC,UAAA4X,kBAAA,SAAkBxJ,EAAQnU,GAEtB,OADAA,EAAO,IAAIK,KAAKL,GACT,CACHuU,IAAK1U,EAAUoB,UAAUjB,GACzBiQ,QAAS/P,KAAK8d,gBAAgBhe,EAAKY,UACnCqd,OAAQ/d,KAAKyK,cAAc3K,GAC3Bke,QAASre,EAAU+B,YAAY5B,GAC/BA,KAAMA,EACNuH,MAAO4M,IAIfhM,EAAApC,UAAAiY,gBAAA,SAAgBzJ,GACZ,OAAOrU,KAAKsJ,UAAUC,KAAK8K,IAG/BpM,EAAApC,UAAAoY,aAAA,SAAa/O,EAAc+B,GAEvB,OADA/B,EAAQzD,SAAO,SAAEiE,GAAW,OAAAA,EAAOuB,KAAOA,GAAQ1I,EAAgBzD,UAC3DoK,GAGXjH,EAAApC,UAAAmR,qBAAA,SAAqBd,OACb7S,EAAO,GAKX,OAJA6S,EAAUzK,SAAO,SAAWyQ,GACxB7Y,EAAK6Y,EAAS1O,SAAWnK,EAAK6Y,EAAS1O,UAAY,GACnDnK,EAAK6Y,EAAS1O,SAAS3B,KAAKqQ,MAEzB7Y,GAGX4E,EAAApC,UAAAqY,yBAAA,SAAyBpQ,EACAoI,EACAsF,EACAzV,EACAnD,GAJzB,IAAAsD,EAAAlG,KAKI,GAAIkW,EAAU1K,OAAS,EACnB,OAAOzF,EAAS,QAGhBoY,EAAgBne,KAAKgX,qBAAqBd,GAC1CmH,EAAWe,OAAOC,KAAKF,GACvBd,EAAS3d,QAAQ8b,GAAc,GAC/B6B,EAASxR,KAAK2P,GAElBxb,KAAKod,UAAUC,GAAQ,eACfiB,GAAkBxQ,EAAMpI,MAAQQ,EAAKqV,kBAAkBzN,EAAO0N,GAC9DnY,EAAO,GAEX+a,OAAOC,KAAKF,GAAe1S,SAAO,SAAE+B,OAC5B+Q,EAAY/Q,IAAYgO,EACxBgD,EAAiBD,GAAarY,EAAK+U,uBAAuBnN,EAAON,GACjE0I,EAAYiI,EAAc3Q,GAC9BnK,EAAKwI,KAAK,CACN2B,QAASA,EACTyJ,UAAW/Q,EAAK6V,eAAevO,GAC/B8Q,eAAgBA,EAChBE,eAAgBA,EAChBtD,eAAgBoD,GAAkBE,EAClCtI,UAAWA,EACXuI,kBAAiB,SAAYvC,GACzB,OAAOoC,GAAmBE,GAAkBtC,EAASjZ,OAAS6F,EAAgBhF,OAElF4a,eAAc,SAAGxC,GACb,YAA6Bzb,IAAtByb,EAASyC,UAA0BJ,GAAarY,EAAK0Y,aAAa1C,SAIrFnW,EAAS1C,KACVT,IAGPqF,EAAApC,UAAAgZ,eAAA,SAAerP,GAEX,OADAA,EAAKN,QAAUM,EAAKN,SAAW,GACxBM,EAAKN,QAAQmN,KAAG,SAAE7M,GAAS,OAAAA,EAAKvL,QAAMxB,KAAK,MAGtDwF,EAAApC,UAAAiZ,gBAAA,SAAgB5P,GACZ,OAAQA,GAAW,IAAImN,KAAG,SAAE7M,GAAS,OAAAA,EAAKvL,QAAMxB,KAAK,MAGzDwF,EAAApC,UAAAkZ,iBAAA,SAAiB1b,EAAMyK,GAAvB,IAAA5H,EAAAlG,KACQgf,EAAe,GAEnB,GAAI3b,EAAK6Y,SAAU,KAEX+C,EAAe5b,EAAK6Y,SAAS3M,QAAM,SAAW2M,GAC9C,YAA6Bzb,IAAtByb,EAASyC,YAGpB,GAAI7Q,GAASA,EAAMpI,KAAM,KACjBwZ,EAAkB7b,EAAK6Y,SAAS3M,QAAM,SAAW2M,GACjD,YAA6Bzb,IAAtByb,EAASyC,YAEpB7Q,EAAMoB,QAAQzD,SAAO,SAAEiE,GACfA,EAAOuB,OAAS1I,EAAgBxD,SAC5Bma,EAAgBxf,QAAQgQ,GAAU,GAClCsP,EAAanT,KAAK3F,EAAKiZ,mBAAmBzP,OAM1DuP,EAAaxT,SAAO,SAAEyQ,GAAa,OAAA8C,EAAanT,KAAK3F,EAAKkZ,gBAAgBlD,OAyB9E,OArBI7Y,EAAKiS,UACLjS,EAAKiS,QAAUtV,KAAKuS,iBAAiBlP,EAAKiS,UAE1CjS,EAAKmS,WACLnS,EAAKmS,SAAWxV,KAAKuS,iBAAiBlP,EAAKmS,WAG/CnS,EAAK6Y,SAAWrV,KAAKmG,UAAUgS,GAG1Bhf,KAAK2K,eAAe,yBAA2BtH,EAAKJ,OAASwF,EAAW/D,WACzErB,EAAK2H,KAAO3C,EAAQpD,QAGpB5B,EAAKJ,OAASwF,EAAWzD,aAAe3B,EAAKJ,OAASwF,EAAW/D,UACjErB,EAAK8T,SAAW9T,EAAKJ,KACrBI,EAAKJ,KAAOI,EAAKJ,KAAKT,MAAM,KAAK,IAEjCa,EAAK8T,SAAW,GAGb9T,GAGX4E,EAAApC,UAAAuZ,gBAAA,SAAgBlD,OACRvQ,EAAW,CACX6B,QAAS0O,EAAS1O,QAClByJ,UAAWiF,EAASjF,UACpBhG,KAAMiL,EAASjL,MAAQ1I,EAAgBzD,QAE3C,OAAQoX,EAASjZ,MACb,KAAK6F,EAAgB/E,KACjB4H,EAAIuD,QAAUgN,EAASpM,SAAW,IAAMoM,EAAS9M,SACjDzD,EAAIoE,QAAUmM,EAASnM,QACvB,MACJ,KAAKjH,EAAgBhF,MACb9D,KAAK2K,eAAe,wBACpBgB,EAAI0T,MAAQnD,EAAS1O,QAAU,IAAM0O,EAASjF,WAElD,MACJ,QACItL,EAAI8D,MAAQyM,EAASzM,OAASyM,EAASjF,UAE/C,OAAOtL,GAGX1D,EAAApC,UAAAsZ,mBAAA,SAAmBjD,OACXvQ,EAAW,CACX6B,QAAS0O,EAAS1O,SAEtB,OAAQ0O,EAASjZ,MACb,KAAK6F,EAAgB/E,KACjB4H,EAAIuD,QAAUgN,EAASpM,SAAW,UAClC,MACJ,KAAKhH,EAAgBhF,MACjB6H,EAAI0T,MAAQnD,EAAS1O,QAAU,UAC/B,MACJ,QACI7B,EAAI8D,MAAQyM,EAASzM,MAAQ,UAErC,OAAO9D,GAGX1D,EAAApC,UAAAyK,YAAA,SAAYjN,GACRA,EAAOA,GAAQ,GACf,IAAK,IAAIyI,EAAI,EAAGA,EAAIzI,EAAKmI,OAAQM,IAAK,KAC9B0D,EAAOnM,EAAKyI,GAChB0D,EAAKwC,SAAWxC,EAAK8P,SAAW9P,EAAKvL,KACrCuL,EAAKnN,WAAamN,EAAK+P,WAAa/P,EAAK2N,OACzC3N,EAAKmB,SAAWnB,EAAKhC,SAAWgC,EAAKgQ,UAAY,GACjDxf,KAAK8R,eAAetC,GAQxB,OAJAnM,EAAK8L,MAAI,SAAE3P,EAAGwC,GACV,OAAOxC,EAAEwS,SAAS3C,cAAcrN,EAAEgQ,aAG/B3O,GAGX4E,EAAApC,UAAA4Z,iBAAA,SAAiBxK,GAAjB,IAAA/O,EAAAlG,KACQA,KAAK6J,WAAWoL,IAChB3S,KAAKod,QAAQrT,OAAK,SAAEqT,GACZA,EAAQC,WACRD,EAAQC,UAAUC,SAAS1Z,EAAK2D,WAAWoL,QAO3DhN,EAAApC,UAAAsI,mBAAA,SAAmB8G,GACf,OAAOjV,KAAK6J,WAAWoL,IAG3BhN,EAAApC,UAAA+S,kBAAA,SAAkBiH,GAEd,OADAA,EAAUC,SAASD,IAAY,IAChB,GACJ1e,KAAK4e,MAAMF,EAAU,IAAM,IAAM7f,KAAKsJ,UAAUI,KAEhDmW,EAAU,IAAM7f,KAAKsJ,UAAUK,QAI9C1B,EAAApC,UAAAma,oBAAA,SAAoB/L,OACZ5Q,EAAO,CACP4c,OAAQ,GACRC,QAAS,GACTC,UAAW,GACXC,QAAS,IAcb,IAAK,IAAI3c,KAZTwQ,EAAOxI,SAAO,SAAE+D,GACRA,EAAK/F,OACLpG,EAAK4c,OAAOpU,KAAK2D,GACVA,EAAKgI,KAAK7J,WAAa,GAC9BtK,EAAK6c,QAAQrU,KAAK2D,GACXA,EAAKgI,KAAK7J,WAAa,GAC9BtK,EAAK8c,UAAUtU,KAAK2D,GAEpBnM,EAAK+c,QAAQvU,KAAK2D,MAIZnM,EACVrD,KAAKoU,WAAW/Q,EAAKI,IAGzB,OAAOJ,GAGX4E,EAAApC,UAAAwa,mBAAA,SAAmBpM,EAAQqM,EAASxgB,GAApC,IAAAoG,EAAAlG,KACQqD,EAAO,CACPid,QAAS,GACT/C,UAAWvd,KAAKsd,sBAAsBrJ,EAAQnU,IAE9CygB,EAAcld,EAAKka,UAAUlB,KAAG,SAAWuB,GAC3C,OAAOA,EAASvW,SAYpB,OATAiZ,EAAQ7U,SAAO,SAAE+U,OACTC,EAAYF,EAAYlE,KAAG,SAAEpI,GAC7B,OAAAA,EAAO1E,QAAM,SAACzB,GAAS,OAAA5H,EAAKwa,iBAAiB5S,EAAO0S,EAAOvc,YAC/DZ,EAAKid,QAAQzU,KAAK,CACd2U,OAAQA,EACRC,UAAWA,OAIZpd,GAGX4E,EAAApC,UAAA8a,oBAAA,SAAoB1M,EAAoBzG,EAAiBzH,EAAoBnD,GAA7E,IAAAsD,EAAAlG,KACIA,KAAK4gB,YAAYpT,GAAO,SAAGqT,OACnBC,EAAc,GACdC,EAAc,GAClBF,EAAQpV,SAAO,SAAEuV,GAAW,OAAAF,EAAYjV,KAAK,CACzCiE,SAAUkR,EAAO/c,KACjBmL,SAAU4R,EAAO9c,MACjB+P,OAAQ,QAEZA,EAAOxI,SAAO,SAAEqC,GAEZ,QADImT,EACKnV,EAAI,EAAGA,EAAIgV,EAAYtV,OAAQM,IAAK,KACrC0D,EAAOsR,EAAYhV,GACnB5F,EAAKwa,iBAAiB5S,EAAO0B,EAAKM,YAClCmR,GAAU,EACVzR,EAAKyE,OAAOpI,KAAKiC,IAGpBmT,GACDF,EAAYlV,KAAKiC,MAGzB/H,EAAS+a,EAAaC,KACvBne,GAAS,IAGhBqF,EAAApC,UAAA2I,YAAA,SAAYV,GACR,IAAK,IAAIhC,EAAIgC,EAAMoB,QAAQ1D,OAAS,EAAGM,GAAK,EAAGA,IAC3C,GAAIgC,EAAMoB,QAAQpD,GAAGmF,OAAS1I,EAAgBxD,SAAW/E,KAAK4e,aAAa9Q,EAAMoB,QAAQpD,IACrF,OAAO,EAGf,OAAO,GAGX7D,EAAApC,UAAA+Y,aAAA,SAAasC,GACT,OAAOlhB,KAAKuW,aAAa2K,EAASpR,WAGtC7H,EAAApC,UAAAsQ,gBAAA,SAAgB+K,GACZ,OAAOA,EAASzR,OAASyR,EAASnR,SAAWmR,EAAS9R,UAAY8R,EAASpR,UAAYoR,EAASjK,WAGpGhP,EAAApC,UAAAuQ,cAAA,SAAc8K,GACV,OAAOA,EAASzR,OAASyR,EAASpR,UAAYoR,EAAS1T,SAG3DvF,EAAApC,UAAAwP,kBAAA,SAAkB8L,OACVpR,EAAU/P,KAAKuS,iBAAiB4O,GAKpC,OAFApR,EAAUA,EAAQxQ,QAAQ,MAAO,SAKrC0I,EAAApC,UAAA0M,iBAAA,SAAiB4O,OACTC,EAAYve,EAAE,SAASwe,KAAKF,GAEhC,OADAC,EAAUE,KAAK,gBAAgBla,SACxBga,EAAUC,QAGrBpZ,EAAApC,UAAA6a,iBAAA,SAAiB5S,EAAiB4B,GAM9B,IAAK,IAAI5D,EAAI,EAAGA,EAAIgC,EAAMoB,QAAQ1D,OAAQM,IACtC,GAAIgC,EAAMoB,QAAQpD,GAAGgE,WAAaJ,EAC9B,OAAO,GAKnBzH,EAAApC,UAAA0b,sBAAA,SAAsBzT,EAAiBgC,GACnC,IAAK,IAAIhE,EAAI,EAAGA,EAAIgC,EAAMoB,QAAQ1D,OAAQM,IACtC,GAAIgC,EAAMoB,QAAQpD,GAAGgE,WAAaA,EAC9B,OAAOhC,EAAMoB,QAAQpD,IAKjC7D,EAAApC,UAAA2b,gBAAA,SAAgB1T,GACZ,IAAK,IAAIhC,EAAI,EAAGA,EAAIgC,EAAMoB,QAAQ1D,OAAQM,IAAK,KACvC4D,EAAS5B,EAAMoB,QAAQpD,GAC3B,GAAI4D,EAAOuB,OAAS1I,EAAgBxD,SAAW/E,KAAKuW,aAAa7G,EAAOI,UACpE,OAAOJ,IAKnBzH,EAAApC,UAAA4b,cAAA,SAAc3T,OACNoO,EAAWlc,KAAKwhB,gBAAgB1T,GACpC,OAAQoO,GAAYA,EAASyC,UAGjC1W,EAAApC,UAAA0Q,aAAA,SAAazG,GACT,OAAOA,IAAaxN,KAAK+N,UAG7BpI,EAAApC,UAAAlD,YAAA,SAAYU,EAAWT,EAAe8e,GAAtC,IAAAxb,EAAAlG,KACQ2hB,EAAS3hB,KAAK4hB,kBAAkBve,EAAMT,GAC1C,IAAI8e,EA2BA,OAAOzf,EAAQU,YAAYgf,OA1BvBE,EAAWF,EAAOxf,IAClBwf,EAAOte,MAAQ+a,OAAOC,KAAKsD,EAAOte,MAAMmI,OAAS,IACjDqW,GAAYhb,KAAKmG,UAAU2U,EAAOte,WAElCye,EAAa9hB,KAAKkN,cAAc2U,GACpC,GAAIC,EACA,OAAOH,EAAO1a,QAAQ6a,GAE1B9hB,KAAK+L,SAAS8V,GAAQ,SAAG3V,OACjB6V,EAAUlf,EAAEG,OAAO,GAAI2e,GAC3BI,EAAQ9a,QAAO,SAAI5D,GACf6C,EAAKgH,cAAc2U,EAAUxe,GAC7B6I,EAAQ7I,IAEZ0e,EAAQ7a,MAAK,SAAIA,GACbgF,EAAQ,KAAMhF,IAElBjF,EAAQU,YAAYof,MACvB,SAAG1e,EAAM6D,GACFA,EACAya,EAAOza,OAASya,EAAOza,MAAMA,GAE7Bya,EAAO1a,SAAW0a,EAAO1a,QAAQ5D,OAQjD4E,EAAApC,UAAA9C,SAAA,SAASM,EAAWT,GAChB,OAAOX,EAAQc,SAAS/C,KAAK4hB,kBAAkBve,EAAMT,KAGzDqF,EAAApC,UAAA+b,kBAAA,SAAkBve,EAAMT,OAEhB+e,EAAS9e,EAAEG,OAAO,GAAIK,EAAMT,GAC5ByK,EAAQsU,EAAOte,MAAQse,EAAOte,KAAKgK,OAASrN,KAAKuN,WACjD2E,EAAMlS,KAAK0Q,WAAWrD,GACtB2U,EAAc9P,GAAOA,EAAI7P,aAAeC,KAAK2f,KAAKjR,MAAM,GAS5D,OARkB2Q,EAAOzO,cAAgB8O,GAAeL,EAAO5O,WAE3D4O,EAAOte,KAAOse,EAAOte,MAAQ,GAC7Bse,EAAOte,KAAKgK,MAAQA,GACbsU,EAAOte,aACPse,EAAOte,KAAKgK,MAEvBsU,EAAOxf,IAAMnC,KAAK6c,cAAc8E,EAAOxf,IAAKkL,EAAOsU,EAAOvf,QACnDuf,GAGX1Z,EAAApC,UAAA2G,gBAAA,eACQgE,EAEAvC,EAASjO,KAAK0Z,iBAclB,GAXIzL,EAAc,QACdjO,KAAKoN,SAASa,EAAc,OAC5BuC,EAAQxQ,KAAK0Q,WAAWzC,EAAc,QAIrCuC,GAA6B,eAApBlO,KAAKD,aACfmO,EAAQxQ,KAAKkd,eAAe5a,KAAKD,cAIhCmO,EAAO,KACJhD,EAAUxN,KAAKuN,YAAcjL,KAAKkL,QACtCgD,EAAQxQ,KAAK0Q,WAAWlD,GAiB5B,OAbKgD,IACDA,EAAQxQ,KAAKkd,eAAe5a,KAAK2f,KAAKjR,MAAM,KAI3CR,IACDA,EAAQxQ,KAAKgK,WAAahK,KAAKgK,UAAU,IAAMhK,KAAK+J,SAAW/J,KAAK+J,QAAQ,IAG5EyG,GACAxQ,KAAKoN,SAASoD,EAAMG,UAGjBH,GAGXvI,EAAApC,UAAAqc,gBAAA,SAAgBC,EAAMlO,OACd5Q,EAAO,GAoBX,OAnBA8e,EAAK1W,SAAO,SAAW2W,GACnB/e,EAAKwI,KAAK,CACNuW,IAAKA,EACLnO,OAAQ,QAIhBA,EAAOxI,SAAO,SAAWqC,OACjBuU,EAAUhf,EAAK,GACnB,GAAIyK,EAAMwU,SACN,IAAK,IAAIxW,EAAI,EAAGA,EAAIzI,EAAKmI,OAAQM,IACzBzI,EAAKyI,GAAGsW,IAAI1c,OAASoI,EAAMwU,WAC3BD,EAAUhf,EAAKyI,IAI3BuW,EAAQpO,OAAOpI,KAAKiC,MAGjBzK,GAGX4E,EAAApC,UAAA0c,uBAAA,SAAuBtO,GACnB,OAAOA,EAAO1E,QAAM,SAAWzB,GAC3B,OAAOA,EAAMqJ,WAAa1O,EAAWzD,gBAI7CiD,EAAApC,UAAA8M,kBAAA,SAAkB3G,EAAUiC,EAAQlI,EAAUnD,GAA9C,IAAAsD,EAAAlG,KACI,IAAKiO,EAAOuJ,OAASvJ,EAAOyJ,IAAMzJ,EAAOuJ,MAAQvJ,EAAOyJ,GACpD1L,EAAST,MAAMvL,KAAM,CAACiO,EAAQlI,EAAUnD,QACrC,KAECiR,EAAW,GACX2O,EAAY,IAAIriB,KAAK8N,EAAO0J,KAAO,EAAG,GAC1C6K,EAAUvhB,QAAQuhB,EAAUthB,UAAY,OAEpCuhB,EAAU5f,EAAEG,OAAO,GAAIiL,GACvByU,EAAW7f,EAAEG,OAAO,GAAIJ,GAC5B6f,EAAQ/K,GAAK/X,EAAUoB,UAAUyhB,GACjC3O,EAAShI,KAAK,IAAII,SAAO,SAAEC,GACvBF,EAAST,MAAMrF,EAAM,CAACuc,EAASvW,EAASwW,YAGxCC,EAAU9f,EAAEG,OAAO,GAAIiL,GACvB2U,EAAW/f,EAAEG,OAAO,GAAIJ,GAC5B+f,EAAQhL,KAAO1J,EAAO0J,KAAO,EAC7BgL,EAAQnL,KAAO,EACf3D,EAAShI,KAAK,IAAII,SAAO,SAAEC,GACvBF,EAAST,MAAMrF,EAAM,CAACyc,EAASzW,EAAS0W,QAG5C3W,QAAQ+H,IAAIH,GAAU1H,MAAI,SAAEvF,OACpBqN,EAAS,GAAGC,OAAO3I,MAAM,GAAI3E,GACjCV,EAAKiO,qBAAqBF,GAC1BlO,EAASkO,QAKrBhM,EAAApC,UAAAgd,gBAAA,SAAgB5U,EAAQnO,EAAMiG,EAAUnD,OAChC4U,EAAME,GACV5X,EAAO,IAAIK,KAAKL,IAEXM,QAAQ,GAGboX,EAAO7X,EAAUM,iBAAiBH,GAGlCA,EAAKgjB,SAAShjB,EAAKe,WAAa,GAChCf,EAAKmB,QAAQnB,EAAKoB,UAAY,GAG9BwW,EAAK/X,EAAUmB,eAAehB,GAE9BmO,EAASpL,EAAEG,OAAO,GAAIiL,EAAQjO,KAAK+iB,eAAevL,EAAME,IAEpD1X,KAAKiS,QAAQhE,EAAOZ,OACpBrN,KAAK4T,cAAc3F,EAAQlI,EAAUnD,GAErC5C,KAAKmT,kBAAkBlF,EAAQlI,EAAUnD,IAIjDqF,EAAApC,UAAAmd,aAAA,SAAa3L,EAAUjV,GACnB,GAAIiV,GAAYA,EAAS3R,MAAQ2R,EAASgE,YACtC,OAAOrb,KAAK6c,cAAc,+BAAgCxF,EAAS1G,SAAUvO,GACzE,eAAiBiV,EAASgE,YAC1B,YAAchE,EAAS3R,MAInCuC,EAAApC,UAAAod,cAAA,SAAcnjB,OACNojB,EAAYvjB,EAAUE,aAAaC,GACvC,OAAOE,KAAK+iB,eAAeG,EAAU5iB,UAAW4iB,EAAU3iB,UAG9D0H,EAAApC,UAAAkd,eAAA,SAAevL,EAAME,GACjB,MAAO,CACHC,KAAMH,EAAK5W,cACX4W,KAAM7X,EAAUoB,UAAUyW,GAC1BE,GAAI/X,EAAUoB,UAAU2W,KAIhCzP,EAAApC,UAAAsd,oBAAA,SAAoBrjB,EAAMsjB,OAClBnV,EAASjO,KAAKijB,cAAcnjB,GAChC,OAAOA,GAAQsjB,GAAcnV,EAAO0J,OAASyL,EAAWzL,MACpD1J,EAAOuJ,OAAS4L,EAAW5L,MAC3BvJ,EAAOyJ,KAAO0L,EAAW1L,IAGjCzP,EAAApC,UAAAwd,eAAA,SAAevV,EAAiBG,GAC5B,OAAQA,EAAOsJ,WAAazJ,EAAMyJ,WAAatJ,EAAOsJ,UAAYzJ,EAAM2J,QACnExJ,EAAOwJ,QAAU3J,EAAM2J,QAAUxJ,EAAOwJ,OAAS3J,EAAMyJ,WACvDtJ,EAAOsJ,WAAazJ,EAAMyJ,WAAatJ,EAAOwJ,QAAU3J,EAAM2J,QAGvExP,EAAApC,UAAAyd,sBAAA,SAAsBrV,EAAQlI,EAAoBnD,GAAlD,IAAAsD,EAAAlG,KACQujB,EAAkB,GACtBvjB,KAAKmT,kBAAkB,CACnBwE,KAAM1J,EAAO0J,KACbtD,IAAKpG,EAAOoG,IACZhH,MAAOY,EAAOZ,OAASrN,KAAKuN,aAC/B,SAAG0G,OACIuP,EAAY,GAGZvP,EADA/N,EAAKqE,SAAS0D,EAAO5D,UACZ4J,EAAO1E,QAAM,SAAEzB,GAAU,OAAA5H,EAAKqE,SAASuD,EAAMzD,aAE7C4J,EAAO1E,QAAM,SAAEzB,GAAU,OAAC5H,EAAKqE,SAASuD,EAAMzD,iBAGrDoZ,EAAQ,SAAI3T,OACVnE,EAAW,CACXmE,SAAUA,EACVmE,OAAQ,IAGZA,EAAOxI,SAAO,SAAEqC,OACR4B,EAASxJ,EAAKqb,sBAAsBzT,EAAOgC,GAC3CJ,IACA/D,EAAIyD,SAAWM,EAAON,SACtBzD,EAAIsI,OAAOpI,KAAKiC,GAChB0V,EAAU3X,KAAKiC,OAInBnC,EAAIsI,OAAOzI,OAAS,GACpB+X,EAAgB1X,KAAKF,IAG7BsI,EAASA,EAAO1E,QAAM,SAAEzB,GACpB,OAAOA,EAAM9C,OAAS3C,EAAQnD,SAAW4I,EAAMpI,OAASuI,EAAOG,SAC3DlI,EAAKmd,eAAevV,EAAOG,MAE/BA,EAAOiO,UACPjO,EAAOiO,SAASzQ,SAAO,SAAEyQ,GAAa,OAAAuH,EAASvH,EAASpM,aAK5D,QADI4T,GAAU,EACL5X,EAAI,EAAGA,EAAIyX,EAAgB/X,OAAQM,IACxC,GAAIyX,EAAgBzX,GAAGgE,WAAaxN,KAAK+N,SAAU,CAC/CqT,GAAU,EACV,MAGHA,GACDD,EAASnhB,KAAK+N,UAElBkT,EAA2B,UAAIrd,EAAKiO,qBAAqBqP,GACzDzd,EAASwd,KACV3gB,IAGPqF,EAAApC,UAAA8d,oBAAA,SAAoB1V,EAAQH,OACpB8V,EAAmB9V,EAAM9C,OAAS3C,EAAQnD,QAC1C2e,GAAiBD,GAAoB/V,OAAOI,EAAOjD,QAAU3C,EAAQnD,QACrE4e,EAAgBhW,EAAMpI,OACrBuI,EAAOsJ,WAAazJ,EAAMyJ,YAActJ,EAAOsJ,WAC/CtJ,EAAOwJ,QAAU3J,EAAM2J,SAAWxJ,EAAOwJ,QACzCxJ,EAAOoG,KAAOvG,EAAMuG,MAAQpG,EAAOoG,MACnCuP,EACL,OAAOC,GAAiBC,GAG5B7b,EAAApC,UAAAke,4BAAA,SAA4BjW,OAEpBkW,EAAYnW,OAAO7N,KAAK2K,eAAe,gCAAkC,EAE7E,GAAIqZ,EAAY,GAAKA,EAAYlW,EAAMwH,QAAQ9J,OAAQ,KAC/C4J,EAAiBtH,EAAMwH,QAAQ2O,OAAO,EAAGD,GAG7C,OAFA5O,EAAiBpV,KAAKqV,kBAAkBD,GACxCA,GAAkB,MACXpV,KAAKqV,kBAAkBD,GAElC,OAAOtH,EAAMsH,gBAIjBnN,EAAApC,UAAAqe,WAAA,SAAW7gB,EAAsB0C,EAAoBnD,GACjD,OAAO5C,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,4BACLkB,KAAMA,EACN4D,QAASlB,GACVnD,IAGPqF,EAAApC,UAAAse,WAAA,SAAW9gB,EAAsB0C,EAAoBnD,GAEjD,OADAS,EAAK8D,OAAS9D,EAAK8D,QAAU9D,EAAKqC,KAC3B1F,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,4BACLkB,KAAMA,EACN4D,QAASlB,GACVnD,IAGPqF,EAAApC,UAAAue,WAAA,SAAW/gB,EAAsB0C,EAAoBnD,GAEjD,OADAS,EAAK8D,OAAS9D,EAAK8D,QAAU9D,EAAKqC,KAC3B1F,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,4BACLkB,KAAMA,EACN4D,QAASlB,GACVnD,IAGPqF,EAAApC,UAAAwe,SAAA,SAASpW,EAAQlI,EAAoBnD,EAAe8e,GAEhD,OAAO1hB,KAAK2C,YAAY,CACpBM,KAAM,OACNd,IAAK,0BACLkB,KAAM4K,EACNhH,QAAO,SAAG5D,GAAS,OAAA0C,EAAS1C,GAAQA,EAAKgE,OAAS,KAClDH,MAAK,WAAQ,OAAAnB,EAAS,MACvBnD,EAAS8e,IAIhBzZ,EAAApC,UAAA+a,YAAA,SAAYpT,EAAiBzH,EAAoBnD,EAAe8e,OACxDzT,EAAS,CACTZ,MAAOG,GAAWxN,KAAKuN,WACvBlH,UC/qEoB,sBDirExBrG,KAAKqkB,SAASpW,GAAM,SAAY4S,GAC5BA,EAAQ1R,MAAI,SAAW3P,EAAGwC,GACtB,OAAOA,EAAEkO,MAAQ1Q,EAAE0Q,SAEvBnK,EAAS8a,KACVje,EAAS8e,IAGhBzZ,EAAApC,UAAAye,qBAAA,SAAqBjhB,EAAsB0C,EAAoBnD,GACtDS,EAAKqC,KAIN1F,KAAKmkB,WAAW9gB,EAAM0C,EAAUnD,IAHhCS,EAAKgD,UC3rEe,qBD4rEpBrG,KAAKkkB,WAAW7gB,EAAM0C,EAAUnD,KAMxCqF,EAAApC,UAAA0e,aAAA,SAAalhB,EAAsB0C,EAAoBnD,GACnD5C,KAAKokB,WAAW/gB,EAAM0C,EAAUnD,IAExCqF,EA5qEA,GExBA,IAAWuc,EAAY,IAAIvc,EAC3Buc,EAAUlZ,eCFV,IAAAmZ,EAAA,WA+BI,SAAAA,EAAoBC,GAAA1kB,KAAA0kB,gBAAAA,EATV1kB,KAAA2kB,SAAW,IAAIC,EAAAA,aAIzB5kB,KAAA6kB,YAAsB,gBACtB7kB,KAAA8kB,cAAwB,GAmD5B,OA7CIL,EAAA5e,UAAAkf,gBAAA,WACI/kB,KAAKglB,qBAGTP,EAAA5e,UAAAof,YAAA,WACIjlB,KAAKklB,wBAGTT,EAAA5e,UAAAsf,KAAA,WACInlB,KAAKolB,cAAcD,QAGvBV,EAAA5e,UAAAkV,OAAA,WAAA,IAAA7U,EAAAlG,KACIA,KAAK0kB,gBAAgBW,YAAY,CAC7BjX,QAASpO,KAAKqX,SAAS3R,KACvB2H,MAAOrN,KAAKqX,SAAS1G,WACxB,WACGzK,EAAKif,OACLjf,EAAKye,SAASW,WAItBb,EAAA5e,UAAA0f,KAAA,WACIvlB,KAAK8kB,cAAgB,iCAAmC9kB,KAAKqX,SAAS/B,QAAU,eAChFtV,KAAKolB,cAAcG,QAGfd,EAAA5e,UAAAmf,kBAAR,WACIhlB,KAAKwlB,eAAiB3iB,EAAE7C,KAAKylB,aAAaC,eAAeP,OAGzDnlB,KAAKmlB,KAAOnlB,KAAKmlB,KAAKQ,KAAK3lB,MAC3B4lB,SAASC,KAAKC,iBAAiB,QAAS9lB,KAAKmlB,MAG7CnlB,KAAKwlB,eAAeO,GAAG,SAAO,SAAGhf,GAAM,OAAAA,EAAEif,qBAGzCnjB,EAAE+iB,SAASC,MAAMniB,OAAO1D,KAAKwlB,iBAGzBf,EAAA5e,UAAAqf,qBAAR,WACIU,SAASC,KAAKI,oBAAoB,QAASjmB,KAAKmlB,MAChDnlB,KAAKwlB,eAAepe,8BA7D3B8e,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,yBACVC,SAAA,+rCAPIC,uCAWHC,EAAAA,wBACAC,EAAAA,8BACAC,EAAAA,UAASN,KAAA,CAACO,EAAAA,sCACVD,EAAAA,UAASN,KAAA,CAAC,mBAsDf1B,EA9EA,OCEM1c,EAASC,EACfD,EAAO4e,OAAO,MAEd,IAAAC,EAAA,WAAA,SAAAA,KAkNA,OAjMWA,EAAAC,cAAP,SAAqBxjB,GAEjB,QADI0M,EAAU,GACLjE,EAAI,EAAGA,EAAI8a,EAAcE,YAAYtb,OAAQM,IAC9C8a,EAAcE,YAAYhb,GAAG5H,QAAUb,EAAK6V,SAC5CnJ,EAAU6W,EAAcE,YAAYhb,GAAGib,OAM/C,MAHoB,WAAhB1jB,EAAK6V,SACLnJ,GAAY,MAAQ6W,EAAcI,mBAAmB3jB,EAAK8V,SAEvDpJ,GAGJ6W,EAAAI,mBAAP,SAA0B7N,GACtB,OAAIA,EACOyN,EAAcK,SAAS1X,QAAM,SAAC8E,GACjC,OAAO8E,EAAOzZ,QAAQ2U,EAAInQ,QAAU,KACrCmY,KAAG,SAAChI,GACH,OAAOA,EAAI6S,SACZzkB,KAAK,MAEL,IAGJmkB,EAAAO,WAAP,SAAkBrnB,OACVR,EAAMyI,EAAOjI,GAAMgL,OAAO,gBAI9B,OAHI,IAAI3K,MAAOS,gBAAkBd,EAAKc,gBAClCtB,GAAO,QAAUQ,EAAKc,eAEnBtB,EAAI0R,MAAM,EAAG,GAAGoW,cAAgB9nB,EAAI0R,MAAM,IAG9C4V,EAAAS,YAAP,SAAmBvnB,GACf,OAAOiI,EAAOjI,GAAMgL,OAAO,cAGxB8b,EAAAU,YAAP,SAAmBxnB,GACf,OAAOiI,EAAOjI,GAAMgL,OAAO,qBAGxB8b,EAAAW,aAAP,SAAoBznB,GAChB,OAAOiI,EAAOjI,GAAMgL,OAAO,uBAGxB8b,EAAAY,YAAP,SAAmB1nB,GACf,OAAOiI,EAAOjI,GAAMgL,OAAO,UAGxB8b,EAAAa,kBAAP,SAAyBrZ,EAAsBrH,EAAe2gB,OAItDC,EAHAC,EAASxZ,EAAQyZ,wBACjBC,EAAaF,EAAOG,OAAS,EAC7BC,EAAYJ,EAAOK,MAAQ,EAE3BC,EAAW,CACXC,KAAMphB,EAAEqhB,EAAIJ,EACZK,IAAKthB,EAAEtF,EAAIqmB,GAGfJ,EAAUA,GAAW,EAGjBY,WAAaJ,EAAIC,KAAOP,EAAOK,MAAQP,EACvCQ,EAAIC,KAAOG,WAAaZ,EAAUE,EAAOK,MAClCC,EAAIC,KAAOT,IAClBQ,EAAIC,KAAOT,GAIXa,YAAcL,EAAIG,IAAMT,EAAOG,OAASL,EACxCQ,EAAIG,IAAME,YAAcb,EAAUE,EAAOG,OAClCG,EAAIG,IAAMX,IACjBQ,EAAIG,IAAMX,OAIVc,EAAWzhB,EAAE0hB,MACbC,EAAcH,YAAcxhB,EAAE4hB,MAC9BC,EAAY7hB,EAAE4hB,MACdE,EAAaP,WAAavhB,EAAE0hB,MAIhC,OAFetnB,KAAK2nB,IAAIN,EAAUK,EAAYH,EAAaE,IAGvD,KAAKJ,EACDb,EAAY,MACZO,EAAIG,KAAOP,EAAaJ,EACxB,MACJ,KAAKgB,EACDf,EAAY,SACZO,EAAIG,KAAOP,EAAaJ,EACxB,MACJ,KAAKkB,EACDjB,EAAY,OACZO,EAAIC,MAAQH,EAAYN,EACxB,MACJ,KAAKmB,EACDlB,EAAY,QACZO,EAAIC,MAAQH,EAAYN,EAIhC,MAAO,CACHC,UAAWA,EACXoB,SAAUb,EACVc,cAAepB,IAIhBhB,EAAAqC,qBAAP,SAA4B7a,EAAsB8a,EAAqBC,EAAqBzB,OACpFsB,EAAgB5a,EAAQyZ,wBACxBuB,EAAeF,EAAOrB,wBACtBK,EAAW,GACXP,EAAiB,GACrBD,EAAUA,GAAW,OAEjB2B,EAAY,CACZhB,IAAKe,EAAaf,IAClBiB,MAAOhB,WAAac,EAAaE,MACjCC,OAAQhB,YAAca,EAAaG,OACnCpB,KAAMiB,EAAajB,MAEnBqB,EAAOroB,KAAK2nB,IAAIO,EAAUlB,KAAMkB,EAAUC,OAC1CG,EAAOtoB,KAAK2nB,IAAIO,EAAUhB,IAAKgB,EAAUE,QAiC7C,GA9BIP,EAAcf,MAAQuB,IACtBH,EAAUlB,KAAOgB,EAAQR,MACzBU,EAAUC,MAAQhB,WAAaa,EAAQR,OAIvCK,EAAcjB,OAAS0B,IACvBJ,EAAUhB,IAAMc,EAAQV,MACxBY,EAAUE,OAAShB,YAAcY,EAAQV,OAIzCY,EAAUlB,KAAOkB,EAAUC,OAC3B3B,EAAUQ,MAAO,EACjBD,EAAIC,KAAOkB,EAAUlB,KAAOa,EAAcf,QAE1CN,EAAU2B,OAAQ,EAClBpB,EAAIC,KAAOG,WAAae,EAAUC,OAIlCD,EAAUhB,IAAMgB,EAAUE,QAC1B5B,EAAUU,KAAM,EAChBH,EAAIG,IAAMgB,EAAUhB,IAAMW,EAAcjB,SAExCJ,EAAU4B,QAAS,EACnBrB,EAAIG,IAAME,YAAcc,EAAUE,QAIlCC,EAAOR,EAAcf,MAAQwB,EAAOT,EAAcjB,OAAQ,KAEtD2B,EAAenB,YAAcc,EAAUE,OAASF,EAAUhB,IAC1DV,EAAUU,IACVH,EAAIG,KAAOqB,EAEXxB,EAAIG,KAAOqB,MAEZ,KAECC,EAAcrB,WAAae,EAAUlB,KAAOkB,EAAUC,MACtD3B,EAAUQ,KACVD,EAAIC,MAAQwB,EAEZzB,EAAIC,MAAQwB,EAsBpB,OAjBIzB,EAAIC,KAAOT,EACXQ,EAAIC,KAAOT,EACJQ,EAAIC,KAAOa,EAAcf,MAAQK,aACxCJ,EAAIC,KAAOG,WAAaU,EAAcf,MAAQP,GAI9CQ,EAAIG,IAAMX,EACVQ,EAAIG,IAAMX,EACHQ,EAAIG,IAAMW,EAAcjB,OAASQ,cACxCL,EAAIG,IAAME,YAAcS,EAAcjB,OAASL,GAInDQ,EAAIG,KAAOzC,SAASgE,iBAAiBC,UACrC3B,EAAIC,MAAQvC,SAASgE,iBAAiBE,WAE/B5B,GA/MJtB,EAAAE,YAAc,CACjB,CAACC,MAAO,YAAa7iB,MAAO,SAC5B,CAAC6iB,MAAO,YAAa7iB,MAAO,UAC5B,CAAC6iB,MAAO,aAAc7iB,MAAO,YAG1B0iB,EAAAK,SAAW,CACd,CAACF,MAAO,KAAMG,MAAO,UAAWhjB,MAAO,MACvC,CAAC6iB,MAAO,KAAMG,MAAO,SAAUhjB,MAAO,MACtC,CAAC6iB,MAAO,KAAMG,MAAO,SAAUhjB,MAAO,MACtC,CAAC6iB,MAAO,KAAMG,MAAO,UAAWhjB,MAAO,MACvC,CAAC6iB,MAAO,KAAMG,MAAO,UAAWhjB,MAAO,MACvC,CAAC6iB,MAAO,KAAMG,MAAO,UAAWhjB,MAAO,MACvC,CAAC6iB,MAAO,KAAMG,MAAO,WAAYhjB,MAAO,OAoMhD0iB,EAlNA,GCHA,IAAAmD,EAYI,SAAYjc,GALZ9N,KAAAgqB,WAAqB,GACrBhqB,KAAAiqB,YAAsB,GAKlBjqB,KAAK8N,MAAQA,EACb9N,KAAKsV,QAAU4U,EAAAA,UAAUC,kBAAkBrc,EAAMwH,SACjDtV,KAAKoqB,QAAUF,EAAAA,UAAUC,kBAAkBrc,EAAMsc,SAC9Ctc,EAAMoB,UACLlP,KAAKqqB,WAAavc,EAAMoB,QAAQoS,MAAI,SAAC9R,GACjC,MAAqB,YAAdA,EAAKyB,MAAsBzB,EAAKM,WAAaxN,KAAKwN,aAG7DhC,EAAMwL,OACNtZ,KAAKgqB,WAAapD,EAAcC,cAAc/Y,EAAMwL,QAEpDtZ,KAAKgqB,WAAa,GAEtBhqB,KAAKiqB,YAAcrD,EAAcO,WAAWrZ,EAAMmK,OAClB,SAA5BnK,EAAMoJ,UAAUU,UAChB5X,KAAKiqB,aAAe,MAAMrD,EAAcY,YAAY1Z,EAAMmK,OAAM,MAAM2O,EAAcY,YAAY1Z,EAAMoK,OC9BlH,IAAAoS,EAAA,WA4BI,SAAAA,EAAoBC,GAAAvqB,KAAAuqB,OAAAA,EAfVvqB,KAAAwqB,SAAW,IAAI5F,EAAAA,aAiI7B,OAhHI0F,EAAAzkB,UAAAkf,gBAAA,WACI/kB,KAAKyqB,iBACLzqB,KAAK0qB,uBAGTJ,EAAAzkB,UAAAof,YAAA,WACIjlB,KAAK2qB,oBACL3qB,KAAK4qB,0BAGTN,EAAAzkB,UAAAglB,UAAA,WACI7qB,KAAKmlB,OACLnlB,KAAKuqB,OAAOO,SAAS,CAAC,kBAAmB9qB,KAAK+qB,cAAcjd,MAAMpI,MAAQ,MAG9E4kB,EAAAzkB,UAAAmlB,YAAA,WACIhrB,KAAKmlB,OACLnlB,KAAKwqB,SAASlF,OACdtlB,KAAKirB,aAGTX,EAAAzkB,UAAAqlB,UAAA,SAAUpd,EAAiBqb,EAAqBD,EAAqBsB,GAArE,IAAAtkB,EAAAlG,KACIA,KAAKirB,UAAYT,EACjBxqB,KAAK+qB,cAAgB,IAAIhB,EAAcjc,GACvC9N,KAAKqX,SAAWvJ,EAChB9N,KAAKmrB,UAAYjC,EACjBlpB,KAAKorB,SAAWjC,EAChBnpB,KAAKqrB,kBACLrrB,KAAKsrB,oBACLnC,EAAQnD,kBACRuF,YAAU,WAAO,OAAArlB,EAAKslB,WAAWrC,EAASD,KAAS,MAGvDoB,EAAAzkB,UAAAsf,KAAA,WACInlB,KAAKyrB,YAAa,EAClBzrB,KAAK0rB,YAAYvG,OACjBnlB,KAAK0rB,YAAYC,IAAI,UAAW,IAGpCrB,EAAAzkB,UAAA0f,KAAA,WACIvlB,KAAKyrB,YAAa,EAClBzrB,KAAK0rB,YAAYnG,QAGrB+E,EAAAzkB,UAAAwf,YAAA,WACIrlB,KAAK4rB,gBAAgBrG,QAGjB+E,EAAAzkB,UAAAylB,kBAAR,WACIzoB,EAAE+iB,SAASgE,kBAAkB+B,IAAI,WAAY,UAC7CE,aAAa7rB,KAAK8rB,cAClB9rB,KAAK8rB,aAAeP,YAAU,WAC1B1oB,EAAE+iB,SAASgE,kBAAkB+B,IAAI,WAAY,MAC9C,MAGCrB,EAAAzkB,UAAAwlB,gBAAR,WACIrrB,KAAK+rB,UAAYxD,YAAc,KAG3B+B,EAAAzkB,UAAA4kB,eAAR,WACIzqB,KAAK0rB,YAAc7oB,EAAE7C,KAAKgsB,UAAUtG,eAAeP,OAGnDnlB,KAAKmlB,KAAOnlB,KAAKmlB,KAAKQ,KAAK3lB,MAC3B4lB,SAASC,KAAKC,iBAAiB,QAAS9lB,KAAKmlB,MAG7CnlB,KAAK0rB,YAAY3F,GAAG,SAAO,SAAGhf,GAAM,OAAAA,EAAEif,qBAGtCnjB,EAAE+iB,SAASC,MAAMniB,OAAO1D,KAAK0rB,cAGzBpB,EAAAzkB,UAAA8kB,kBAAR,WACI/E,SAASC,KAAKI,oBAAoB,QAASjmB,KAAKmlB,MAChDnlB,KAAK0rB,YAAYtkB,UAGbkjB,EAAAzkB,UAAA6kB,oBAAR,WACI1qB,KAAKisB,iBAAmBjsB,KAAKisB,iBAAiBtG,KAAK3lB,MACnD4lB,SAASE,iBAAiB,SAAU9lB,KAAKisB,kBAAkB,IAGvD3B,EAAAzkB,UAAA+kB,uBAAR,WACIhF,SAASK,oBAAoB,SAAUjmB,KAAKisB,mBAGxC3B,EAAAzkB,UAAAomB,iBAAR,WAAA,IAAA/lB,EAAAlG,KAEQA,KAAKyrB,YAAczrB,KAAKorB,UAAYprB,KAAKmrB,YACzCU,aAAa7rB,KAAKksB,QAClBlsB,KAAKksB,OAASX,YAAU,WAAO,OAAArlB,EAAKslB,WAAWtlB,EAAKklB,SAAUllB,EAAKilB,aAAY,OAI/Eb,EAAAzkB,UAAA2lB,WAAR,SAAmBrC,EAASD,GAExBlpB,KAAKulB,WAED2C,EAAMtB,EAAcqC,qBAAqBjpB,KAAKgsB,UAAUtG,cAAewD,EAAQC,GAE/EgD,EAAe,eAAiBjE,EAAIC,KAAO,MAAQD,EAAIG,IAAM,QAEjEroB,KAAK0rB,YAAYC,IAAI,CACjBS,8BAA+B,QAC/BC,sBAAuB,QACvBC,QAAW,IACXC,oBAAqBJ,EACrBK,UAAaL,yBAnIxBjG,EAAAA,UAASC,KAAA,CAAC,CACPE,SAAA,k7HARIoG,EAAAA,4CAYHjG,EAAAA,0BACAC,EAAAA,UAASN,KAAA,CAAC,sCACVM,EAAAA,UAASN,KAAA,CAAC,mBA+HfmE,EA9IA,GCMetiB,EAER2e,OAAO,MAEd,IAAAL,EAAA,WAaI,SAAAA,EACYoG,EACAC,EACAC,EACAC,GAJZ,IAAA3mB,EAAAlG,KACYA,KAAA0sB,eAAAA,EACA1sB,KAAA2sB,yBAAAA,EACA3sB,KAAA4sB,SAAAA,EACA5sB,KAAA6sB,OAAAA,EAfZ7sB,KAAAuR,MAAQ,CACJ/D,QAASlL,KAAKkL,QACd8R,QAAShd,KAAKgd,QACdjd,WAAYC,KAAKD,YAErBrC,KAAA8sB,sBAAwB,qBAGhB9sB,KAAA+sB,KAAmB,GASvBvI,EAAUrc,QAAU,6BACpBqc,EAAUpX,SAASpN,KAAKuR,MAAM/D,SAC9BgX,EAAUnY,OAAK,WACXmY,EAAUtW,SAAShI,EAAKqL,MAAM/D,SAAO,SAAGyD,GACpCuT,EAAUpX,SAASlH,EAAKqL,MAAM/D,SAC9BtH,EAAK8mB,QAAS,EACd9mB,EAAK+mB,sBA+FrB,OA1FI3G,EAAAzgB,UAAAwG,MAAA,SAAMtG,GACE/F,KAAKgtB,OACLjnB,IAEA/F,KAAK+sB,KAAKlhB,KAAK9F,IAIfugB,EAAAzgB,UAAAonB,cAAR,WACIjtB,KAAK+sB,KAAKthB,SAAO,SAACW,GAAM,OAAAA,OACxBpM,KAAK+sB,KAAO,IAGhBzG,EAAAzgB,UAAAqnB,eAAA,SAAeC,EAAiBpnB,GAC5B,GAAKonB,EAAL,KAGIlf,EAAS,CACT+N,QAAShc,KAAK8sB,sBACdK,QAASA,GAEbntB,KAAK0sB,eAAeU,eAAenf,EAAQlI,KAG/CugB,EAAAzgB,UAAAwnB,aAAA,SAAaF,EAAiBpnB,GAC1B,GAAKonB,EAAL,KAGIlf,EAAS,CACT+N,QAAShc,KAAK8sB,sBACdK,QAASA,GAEbntB,KAAK0sB,eAAeY,eAAerf,EAAQlI,KAG/CugB,EAAAzgB,UAAA0nB,YAAA,SAAYtf,EAAQlI,GAChB/F,KAAKqM,OAAK,WAAO,OAAAmY,EAAUle,OAAO2H,EAAQlI,OAG9CugB,EAAAzgB,UAAA2nB,YAAA,SAAYvf,EAAQlI,GAChB/F,KAAKqM,OAAK,WAAO,OAAAmY,EAAUre,OAAO8H,EAAQlI,OAG9CugB,EAAAzgB,UAAAwf,YAAA,SAAYpX,EAAQlI,GAChB/F,KAAKqM,OAAK,WAAO,OAAAmY,EAAUpd,OAAO6G,EAAQlI,OAG9CugB,EAAAzgB,UAAA4nB,eAAA,SAAexf,EAAQlI,GACnB/F,KAAKqM,OAAK,WAAO,OAAAmY,EAAU/H,kBAAkBxO,EAAQlI,OAGzDugB,EAAAzgB,UAAA6nB,cAAA,SAAc3nB,GACV/F,KAAKqM,OAAK,WAAO,OAAAmY,EAAUxV,eAAe,GAAIjJ,OAGlDugB,EAAAzgB,UAAA8nB,WAAA,SAAW1f,EAAQlI,GACf/F,KAAKqM,OAAK,WAAO,OAAAmY,EAAU5Q,cAAc3F,EAAQlI,OAGrDugB,EAAAzgB,UAAAgd,gBAAA,SAAgB/iB,EAAMiG,GAClB/F,KAAKqM,OAAK,WAAO,OAAAmY,EAAU3B,gBAAgB,GAAI/iB,EAAMiG,OAGzDugB,EAAAzgB,UAAAsM,UAAA,SAAUlE,EAAQlI,GACd/F,KAAKqM,OAAK,WAAO,OAAAmY,EAAUrS,UAAUlE,EAAQlI,OAGjDugB,EAAAzgB,UAAAiJ,iBAAA,SAAiBb,EAAQlI,GACrB/F,KAAKqM,OAAK,WAAO,OAAAmY,EAAU1V,iBAAiBb,EAAOlI,OAGvDugB,EAAAzgB,UAAAqlB,UAAA,SAAUpd,EAAiBqb,EAAqBD,EAAqBsB,GACjExqB,KAAK4tB,iBACL5tB,KAAK6tB,cAAcC,SAAS5C,UAAUpd,EAAOqb,EAASD,EAAQsB,IAGlElE,EAAAzgB,UAAAkoB,cAAA,WACQ/tB,KAAK6tB,eACL7tB,KAAK6tB,cAAcC,SAAS3I,QAI5BmB,EAAAzgB,UAAA+nB,eAAR,WACI,IAAI5tB,KAAK6tB,cAAT,KAGMG,EAAmBhuB,KAAK2sB,yBAAyBsB,wBAAwB3D,GAC/EtqB,KAAK6tB,cAAgBG,EAAiB1nB,OAAOtG,KAAK4sB,UAClD5sB,KAAK6sB,OAAOqB,WAAWluB,KAAK6tB,cAAcM,gCAtHjDC,EAAAA,sDATOC,EAAAA,yBADYC,EAAAA,gCAA0BC,EAAAA,gBAAUC,EAAAA,kBAkIxDlI,EAxHA,GCVA,IAAAmI,EAAA,WA0BI,SAAAA,EAAoB/J,GAApB,IAAAxe,EAAAlG,KAAoBA,KAAA0kB,gBAAAA,EAfV1kB,KAAAwqB,SAAW,IAAI5F,EAAAA,aACzB5kB,KAAAiU,OAAqB,GACrBjU,KAAA0uB,OAAS,CAEL,UACA,UACA,UACA,UACA,UACA,UACA,WAGI1uB,KAAA2uB,MAAc,IAAIxuB,KAGtBH,KAAK0kB,gBAAgBrY,OAAK,WAAO,OAAAnG,EAAK0oB,qBA6C9C,OA1CIH,EAAA5oB,UAAA+oB,gBAAA,WAAA,IAAA1oB,EAAAlG,KACSA,KAAK2uB,OAGV3uB,KAAK0kB,gBAAgBiJ,WAAW,CAC5BtZ,IAAK1U,EAAUoB,UAAUf,KAAK2uB,OAC9BhX,KAAM3X,KAAK2uB,MAAM/tB,gBACpB,SAAGqT,GACAA,EAAOxI,SAAO,SAAE1E,GAAM,OAAAb,EAAK2oB,iBAAiB9nB,MAC5Cb,EAAK+N,OAASA,EAAOjD,MAAM,EAAG,OAItCyd,EAAA5oB,UAAAipB,YAAA,SAAYhhB,EAAiBqb,EAAqB4F,GAAlD,IAAA7oB,EAAAlG,KACIA,KAAK0kB,gBAAgBwG,UAAUpd,EAAOqb,EAAS4F,GAAQ,WACnD7oB,EAAK0oB,kBACL1oB,EAAKskB,SAASlF,MAAK,OAInBmJ,EAAA5oB,UAAAgpB,iBAAR,SAAyB/gB,OACjBnM,EAAM,IAAIxB,KAEd2N,EAAMkhB,YAAclhB,EAAMmK,MAAQtW,GAAOmM,EAAMoK,IAAMvW,EACrDmM,EAAMmhB,MAAQnhB,EAAMoK,IAAMvW,EAC1BmM,EAAMohB,QAAUphB,EAAMmK,MAAQtW,EAE1BmM,EAAMkhB,aACNlhB,EAAMqhB,WAAa,eACnBrhB,EAAMshB,YAAcpvB,KAAK0uB,OAAO,IACzB5gB,EAAMohB,SACbphB,EAAMqhB,WAAa,eACnBrhB,EAAMshB,YAAcpvB,KAAK0uB,OAAO,KAEhC5gB,EAAMqhB,WAAa,WACnBrhB,EAAMshB,YAAcpvB,KAAK0uB,OAAO,IAGpC5gB,EAAMuhB,MAAQ,CACVC,mBAAoBtvB,KAAK0uB,OAAO5gB,EAAM9C,4BAhEjDkb,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,wBACVC,SAAA,+/CANIC,uCAUHE,EAAAA,UA6DLiI,EAxEA,OCgBM1mB,EAASC,EAEfunB,EAAA,WAgEI,SAAAA,EACY7K,EACA8K,EACAjF,EACAkF,EACAC,GALZ,IAAAxpB,EAAAlG,KACYA,KAAA0kB,gBAAAA,EACA1kB,KAAAwvB,MAAAA,EACAxvB,KAAAuqB,OAAAA,EACAvqB,KAAAyvB,eAAAA,EACAzvB,KAAA0vB,OAAAA,EA7DZ1vB,KAAA2vB,UAAgC,CAC5B,IAAIC,EAAiB,OAAQC,EAAaC,YAAa,CACnDC,iBAAgB,SAAGjwB,OACXR,EAAMyI,EAAOjI,GAAMgL,OAAO,eAC9B,OAAOxL,EAAI0R,MAAM,EAAG,GAAGoW,cAAgB9nB,EAAI0R,MAAM,IAErDgf,YAAW,WAAQ,OAAApJ,EAAcS,YAAYnhB,EAAK+pB,SAAS5vB,cAE/D,IAAIuvB,EAAiB,OAAQC,EAAaK,aAAc,CACpDF,YAAW,WAAQ,OAAApJ,EAAcU,YAAYphB,EAAK+pB,SAAS5vB,cAE/D,IAAIuvB,EAAiB,QAASC,EAAaM,aAAc,CACrDH,YAAW,WAAQ,OAAApJ,EAAcW,aAAarhB,EAAK+pB,SAAS5vB,eAGpEL,KAAAowB,YAA4BP,EAAaM,aAEzCnwB,KAAAqwB,eAA+B,CAC3B3Q,QAAS,CAAC4Q,EAAeC,EAAgBC,GACzCC,YAAa,YACb7wB,SAAU,EACV+mB,OAAQ,KACR+J,YAAY,EACZC,WAAY,UACZC,QAAQ,EACRC,cAAc,EACdC,UAAU,EACVC,UAAU,EACVC,WAAW,EACXC,YAAY,EACZC,YAAY,EACZC,cAAc,EACdC,UAAU,EACVC,MAAO,GACPC,cAAe,CACXC,WAAY,CAAE,EAAG,EAAG,EAAG,EAAG,GAC1Bha,UAAW,QACXia,QAAS,SAEbC,UAAS,SAAGC,GAAQ,OAAAxrB,EAAKyrB,iBAAiBD,IAC1CE,YAAW,SAAGF,GAAQ,OAAAxrB,EAAKyrB,iBAAiBD,IAC5CG,OAAM,SAAGH,GAAQ,OAAAxrB,EAAK4rB,aAAaJ,IACnCK,WAAU,SAAGL,GAAQ,OAAAxrB,EAAK8rB,WAAWN,IACrCO,eAAc,WAAQ,OAAA/rB,EAAKgsB,mBAC3BC,YAAW,WAAQ,OAAAjsB,EAAKksB,mBACxBrK,OAAM,WACF,OAAOQ,YAAc,KAMrBvoB,KAAAqyB,WAAqB,oBAErBryB,KAAAsyB,QAAiB,GAUrBlU,OAAOmU,OAAOvyB,KAAKqwB,eAAgBrwB,KAAKwyB,gBAGxCxyB,KAAK2vB,UAAUlkB,SAAO,SAAEgnB,GAChBA,EAAK7vB,UACLsD,EAAKmqB,eAAegB,MAAMoB,EAAKvuB,OAASuuB,EAAK7vB,YAKrDmF,EAAO4e,OAAO3mB,KAAKqwB,eAAe1J,OAAOrjB,YAiRjD,OA9QIisB,EAAA1pB,UAAAkf,gBAAA,WACI/kB,KAAK0yB,QACL1yB,KAAKkyB,mBAGT3C,EAAA1pB,UAAAof,YAAA,WACIjlB,KAAKiwB,SAAS0C,UACV3yB,KAAK4yB,iBACL5yB,KAAK4yB,gBAAgBC,eAIrBtD,EAAA1pB,UAAA6sB,MAAR,WAAA,IAAAxsB,EAAAlG,KACIA,KAAKiwB,SAAW,IAAI6C,EAAAA,SAAS9yB,KAAK+yB,YAAYrN,cAAe1lB,KAAKqwB,gBAClErwB,KAAKiwB,SAAS+C,SAGdhzB,KAAK4yB,gBAAkB5yB,KAAKuqB,OAAOtW,OAAOgf,KAAK1jB,EAAAA,QAAM,SAACzB,GAAS,OAAAA,aAAiBolB,EAAAA,kBAC3EC,WAAS,SAAErlB,GAAyB,OAAA5H,EAAKktB,aAAatlB,OAGvDyhB,EAAA1pB,UAAA8rB,iBAAR,SAAyBxL,GAAzB,IACQrY,EADR5H,EAAAlG,KAOI,GAAkB,KAJd8N,EADAqY,EAAKkN,SACGrzB,KAAKsyB,QAAQzkB,OAAOsY,EAAKkN,SAAS5lB,KAElCzN,KAAKsyB,QAAQzkB,OAAOsY,EAAKrY,MAAML,MAElCzC,KAAW,KACZyM,OAAM,EAENA,EADA0O,EAAKrY,MAAMrE,OACF,KAE4B,GAA5B0c,EAAKrY,MAAMoK,IAAIvK,WAAkBwY,EAAKrY,MAAMoK,IAAItK,iBAEzDK,EAAS,CACTG,QAASN,EAAMpI,KACfiS,KAAMwO,EAAKrY,MAAMmK,MAAMrX,cACvByT,IAAK1U,EAAUoB,UAAUolB,EAAKrY,MAAMmK,OACpCV,UAAyC,GAA9B4O,EAAKrY,MAAMmK,MAAMtK,WAAkBwY,EAAKrY,MAAMmK,MAAMrK,aAC/D6J,OAAQA,EACRG,QAASuO,EAAKrY,MAAMrE,QAEpBqE,EAAMwL,QACN8E,OAAOmU,OAAOtkB,EAAQH,EAAMwL,QAEhCtZ,KAAK0kB,gBAAgB8I,YAAYvf,GAAM,SAAG5K,EAAMiwB,GAC5C,IAAKjwB,EAGD,OAFA6C,EAAKwpB,OAAO6D,YAAY,mCAAqCD,EAAIE,OAAQ,cACzErN,EAAKrL,SAGT5U,EAAKutB,uBAITtN,EAAKrL,UAIbyU,EAAA1pB,UAAA0nB,YAAA,eACQztB,EAAO,IAAIK,KACfL,EAAK+B,SAAS/B,EAAK6N,WAAa,EAAG,GACnC3N,KAAK0zB,aAAa5zB,EAAM,IAAIK,KAAKL,EAAKoB,UAAY,QAG9CquB,EAAA1pB,UAAA8tB,YAAR,SAAoBC,GAApB,IAAA1tB,EAAAlG,UAAoB,IAAA4zB,IAAAA,GAAA,GAChB5zB,KAAKkyB,kBACLrG,aAAa7rB,KAAK6zB,aAClB7zB,KAAK6zB,YAActI,YAAU,WACzBrlB,EAAK4tB,iBAAiBF,KACvB,MAGCrE,EAAA1pB,UAAA6tB,aAAR,SAAqBzb,EAAaC,EAAWzO,QAAA,IAAAA,IAAAA,GAAA,OACnCsqB,EAAapwB,OAAOqwB,KAAKntB,KAAKmG,UAAU,CAC1CiL,MAAOA,EAAMgc,UACb/b,IAAKA,EAAI+b,UACT/c,UAAW,CACP+I,OAAQxW,EAAS,OAGzBzJ,KAAKuqB,OAAOO,SAAS,CAAC,mBAAoBiJ,IAC1C/zB,KAAKkyB,mBAGD3C,EAAA1pB,UAAAisB,aAAR,SAAqBoC,GACjBl0B,KAAK0zB,aAAaQ,EAAKjc,MAAOic,EAAKhc,IAAKgc,EAAKjc,MAAM/W,YAAegzB,EAAKhc,IAAIhX,UAAY,QAGnFquB,EAAA1pB,UAAAusB,gBAAR,WAAA,IAAAlsB,EAAAlG,KACI,GAAIA,KAAKiwB,SAASwC,KAAKxvB,OAAS4sB,EAAasE,WAIzC,OAHAn0B,KAAKiwB,SAASmE,WAAWvE,EAAaC,kBAEtCvE,YAAU,WAAO,OAAArlB,EAAKksB,qBAG1B7G,YAAU,WACNrlB,EAAKmuB,cACLnuB,EAAKytB,kBAILpE,EAAA1pB,UAAAwuB,YAAR,WAAA,IAAAnuB,EAAAlG,KACIA,KAAKs0B,UAAYt0B,KAAKiwB,SAASwC,KAAKvL,MACpClnB,KAAK2vB,UAAUlkB,SAAO,SAAEgnB,GAAS,OAAAA,EAAK8B,OAAS9B,EAAKvuB,QAAUgC,EAAK+pB,SAASwC,KAAKxvB,QACjFjD,KAAKw0B,gBACLx0B,KAAKy0B,qBAGDlF,EAAA1pB,UAAA2uB,cAAR,eACUE,EAAQ,CACVzc,MAAOjY,KAAKiwB,SAASwC,KAAKkC,YAC1Bzc,IAAKlY,KAAKiwB,SAASwC,KAAKmC,WAE5B50B,KAAKge,QAAUhe,KAAK60B,aAAa,IAAI10B,KAAQu0B,IAGzCnF,EAAA1pB,UAAAiuB,iBAAR,SAAyBF,GAAzB,IAAA1tB,EAAAlG,MACQ4zB,GAAc5zB,KAAK80B,iBACnB90B,KAAK+0B,cAAgB/0B,KAAKg1B,YAC1Bh1B,KAAK0kB,gBAAgBiJ,WAAWnJ,EAAUzB,eAAe/iB,KAAK+0B,cAAc9c,MAAOjY,KAAK+0B,cAAc7c,MAAI,SACrGjE,GAAW,OAAA/N,EAAK+uB,cAAchhB,GAAU,OAC7CjU,KAAKiwB,SAASiF,0BAKd3F,EAAA1pB,UAAAmvB,UAAR,eAEQ9c,EADAD,EAAQ,IAAI9X,KAAKH,KAAKiwB,SAAS5vB,WAInC,IAFA4X,EAAM7X,QAAQ,GACd6X,EAAMpW,SAAS,EAAG,EAAG,EAAG,GACjBoW,EAAMvX,WAAaV,KAAKqwB,eAAezwB,UAC1CqY,EAAM7X,QAAQ6X,EAAM5X,UAAY,GAGpC,OADA6X,EAAM,IAAI/X,KAAK8X,EAAM/W,UAAY,SAC1B,CACH+W,MAAOA,EACPC,IAAKA,IAILqX,EAAA1pB,UAAAivB,YAAR,WACI,OAAK90B,KAAK+0B,iBAGD/0B,KAAK60B,aAAa70B,KAAKiwB,SAASwC,KAAK0C,eAAiBn1B,KAAK60B,aAAa70B,KAAKiwB,SAASwC,KAAK2C,cAGhG7F,EAAA1pB,UAAAgvB,aAAR,SAAqB/0B,EAAY40B,GAE7B,OAAO50B,IADP40B,EAAQA,GAAS10B,KAAK+0B,eACD9c,OAASnY,GAAQ40B,EAAMxc,KAGxCqX,EAAA1pB,UAAAovB,cAAR,SAAsBhhB,GAClBjU,KAAKsyB,QAAUre,MACXohB,EAAcphB,EAAOoI,KAAG,SAAEvO,EAAOrO,OAC7B61B,EAAyB,CACzB7nB,GAAIhO,EACJiG,KAAMoI,EAAMpI,KACZ+D,OAAQqE,EAAMrE,OACdyd,MAAOpZ,EAAMwH,QACb2C,MAAOnK,EAAMmK,MACbC,IAAKpK,EAAMoK,KAef,OAbIpK,EAAMoK,IAAM,IAAI/X,MAEhBm1B,EAAWC,UAAY,OACvBD,EAAWE,MAAQ,QACZ1nB,EAAMwI,WAEbgf,EAAWC,UAAY,OACvBD,EAAWE,MAAQ,YAGnBF,EAAWC,UAAY,OACvBD,EAAWE,MAAQ,WAEhBF,KAEXt1B,KAAKy1B,gBAAgBJ,IAGjB9F,EAAA1pB,UAAAmsB,WAAR,SAAmB7L,GAAnB,IAAAjgB,EAAAlG,KACQ8N,EAAQ9N,KAAKsyB,QAAQzkB,OAAOsY,EAAKrY,MAAML,KAC3CzN,KAAK0kB,gBAAgBwG,UAAUpd,EAAOqY,EAAKgD,QAAShD,EAAKgD,QAAQuM,eAAa,WAAQ,OAAAxvB,EAAKutB,mBAGvFlE,EAAA1pB,UAAA4vB,gBAAR,SAAwBxhB,GACpBjU,KAAKiwB,SAAS0F,eAAe,CACzB1hB,OAAQA,KAIRsb,EAAA1pB,UAAAutB,aAAR,SAAqBtlB,OACX8nB,EAAW51B,KAAKwyB,eACtBxyB,KAAKiwB,SAASmE,WAAWwB,EAASC,YAAaD,EAASE,cAG5DvG,EAAA1pB,UAAAuuB,WAAA,SAAWnxB,GACPjD,KAAKiwB,SAASmE,WAAWnxB,EAAKiB,QAGlCqrB,EAAA1pB,UAAAkwB,OAAA,WACI/1B,KAAKiwB,SAASnb,QAGlBya,EAAA1pB,UAAAmwB,OAAA,WACIh2B,KAAKiwB,SAASgG,QAGlB1G,EAAA1pB,UAAAqwB,QAAA,WACIl2B,KAAKiwB,SAASmE,WAAWvE,EAAaC,YAAa,IAAI3vB,OAGnDovB,EAAA1pB,UAAAswB,iBAAR,SAAyBnrB,GACrB,IAAK,IAAIc,EAAI,EAAGA,EAAI9L,KAAK2vB,UAAUnkB,OAAQM,IACvC,GAAI9L,KAAK2vB,UAAU7jB,GAAG5H,QAAU8G,EAC5B,OAAOhL,KAAK2vB,UAAU7jB,IAK1ByjB,EAAA1pB,UAAA4uB,kBAAR,eACQxmB,EAAS,CACTjO,KAAKiwB,SAASwC,KAAKxvB,KACnB8E,EAAO/H,KAAKiwB,SAAS5vB,WAAWyK,OAAO,aAE3C9K,KAAKuqB,OAAOO,SAAS,CAAC,eAAiB7c,EAAOxL,KAAK,QAG/C8sB,EAAA1pB,UAAA2sB,aAAR,eAGQ1yB,EAFAs2B,EAAWp2B,KAAKwvB,MAAM6G,SAASl0B,IAC/Bm0B,EAAWt2B,KAAKu2B,iBAapB,OAXIH,EAAS5qB,OAAS,IAClB8qB,EAAWF,EAAS,GAAGnU,KACvBniB,EAAO,IAAIK,KAAKi2B,EAAS,GAAGnU,OAE3BniB,GAASA,EAAKoB,YACfpB,EAAO,IAAIK,MAEVH,KAAKm2B,iBAAiBG,KACvBA,EAAWt2B,KAAKm2B,iBAAiBn2B,KAAKowB,aAAalsB,OAEvDlE,KAAKu2B,eAAeD,GACb,CACHT,YAAaS,EACbR,YAAah2B,IAIbyvB,EAAA1pB,UAAA0wB,eAAR,SAAuBD,GACnB,QAAiB71B,IAAb61B,EACA,OAAOrpB,aAAaL,QAAQ5M,KAAKqyB,YAEjCplB,aAAaF,QAAQ/M,KAAKqyB,WAAYiE,IAI9C/G,EAAA1pB,UAAA4tB,aAAA,WACIzzB,KAAKkyB,kBACLlyB,KAAK2zB,aAAY,GACjB3zB,KAAKw2B,eAAe5H,mBAGhBW,EAAA1pB,UAAAqsB,gBAAR,WACIlyB,KAAK0kB,gBAAgBqJ,qCAjW5B7H,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,gBACVC,SAAA,4iEAlBIC,SADAmQ,EAAAA,sBAA+BhK,EAAAA,cAEViK,EAAAA,6BAArBC,EAAAA,4DAqBHlQ,EAAAA,UAASN,KAAA,CAAC,uCACVM,EAAAA,UAASN,KAAA,CAACsI,MA4Vfc,EAnWA,GAqWA,IAAAK,EAKI,SAAY3rB,EAAcC,EAAqBtB,GAD/C5C,KAAAu0B,QAAkB,EAEdv0B,KAAKiE,KAAOA,EACZjE,KAAKkE,MAAQA,EACblE,KAAK4C,QAAUA,UAKnBuxB,WAAa,aACbrE,YAAc,cACdI,aAAe,eACfC,aAAe,gBCvYnByG,EAAA,WAyBE,SAAAA,EACUlS,GAAA1kB,KAAA0kB,gBAAAA,EAdA1kB,KAAA62B,SAAW,IAAIjS,EAAAA,aASzB5kB,KAAAqD,KAAY,GAEZrD,KAAA82B,WAAqB,aAKnB92B,KAAK8mB,YAAcF,EAAcE,YACjC9mB,KAAKinB,SAAWL,EAAcK,SAyFlC,OAtFE2P,EAAA/wB,UAAAkf,gBAAA,WACE/kB,KAAK+2B,OAASl0B,EAAE7C,KAAKg3B,YAAYtR,eACjCE,SAASC,KAAKoR,YAAYj3B,KAAKg3B,YAAYtR,gBAG7CkR,EAAA/wB,UAAAof,YAAA,WACMjlB,KAAK+2B,OAAOG,GAAG,YACjBl3B,KAAK+2B,OAAOI,MAAM,QAAQpR,GAAG,mBAAiB,WAC5CljB,EAAE7C,MAAMoH,YAGVpH,KAAK+2B,OAAO3vB,UAIhBwvB,EAAA/wB,UAAAuxB,WAAA,SAAW/zB,GACTrD,KAAKqD,KAAOA,GAAQ,GACpBrD,KAAKq3B,WACLr3B,KAAK+2B,OAAOI,MAAM,SAGpBP,EAAA/wB,UAAAyxB,WAAA,WACEt3B,KAAK62B,SAASvR,KAAKtlB,KAAKu3B,kBAG1BX,EAAA/wB,UAAA2xB,cAAA,SAAchoB,GACZA,EAAKioB,SAAWjoB,EAAKioB,QACjBz3B,KAAK03B,oBAAoBlsB,OAAS,IACpCgE,EAAKioB,SAAU,IAInBb,EAAA/wB,UAAA8xB,WAAA,WACO33B,KAAKiY,OAAUjY,KAAKiY,MAAM/W,YAC7BlB,KAAKiY,MAAQ,IAAI9X,QAEdH,KAAKqZ,QAAUrZ,KAAKqZ,MAAMnY,WAAalB,KAAKiY,OAASjY,KAAKqZ,SAC7DrZ,KAAKqZ,MAAQ,IAAIlZ,KAAKH,KAAKiY,MAAMrX,cAAeZ,KAAKiY,MAAMpX,WAAYb,KAAKiY,MAAM5X,WAClFL,KAAKqZ,MAAMyJ,SAAS9iB,KAAKqZ,MAAMxY,WAAa,KAIhD+1B,EAAA/wB,UAAA0xB,cAAA,eACQtpB,EAAS,CACbiL,OAAQlZ,KAAKkZ,OACbE,OAAQpZ,KAAKiY,MAAM/W,UACnBmY,MAAOrZ,KAAKqZ,MAAMnY,UAClBiY,OAAQ,IAcV,MAXqB,UAAjBlL,EAAOiL,SAQPjL,EAAOkL,OAASnZ,KAAK03B,oBAAoBrb,KAAG,SAAC7M,GAAQ,OAAAA,EAAKtL,UAGvD+J,GAGT2oB,EAAA/wB,UAAA6xB,kBAAA,WACE,OAAO13B,KAAKinB,SAAS1X,QAAM,SAACC,GAC1B,OAAOA,EAAKioB,YAIRb,EAAA/wB,UAAAwxB,SAAR,WAAA,IAAAnxB,EAAAlG,KACEA,KAAKkZ,OAASlZ,KAAKqD,KAAK6V,QAAU,QAClClZ,KAAKiY,MAAQ,IAAI9X,KAAKH,KAAKqD,KAAK+V,QAChCpZ,KAAKqZ,MAAQ,IAAIlZ,KAAKH,KAAKqD,KAAKgW,OAChCrZ,KAAK23B,aAED33B,KAAKqD,KAAK8V,OACZnZ,KAAKinB,SAASxb,SAAO,SAAC+D,GAChBtJ,EAAK7C,KAAK8V,OAAOzZ,QAAQ8P,EAAKtL,QAAU,IAC1CsL,EAAKioB,SAAU,MAInBz3B,KAAKinB,UAAUjnB,KAAKiY,MAAMvX,SAAW,GAAK,GAAG+2B,SAAU,uBA7G5DvR,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,wBACVC,SAAA,q2GAPOC,uCAWNE,EAAAA,4BACAC,EAAAA,UAASN,KAAA,CAAC,oCACVM,EAAAA,UAASN,KAAA,CAAC,oCACVM,EAAAA,UAASN,KAAA,CAAC,kBAuGbyQ,EAtHA,GCAA,IAAAgB,EAAA,WAEA,SAAAA,IAOa53B,KAAA63B,MAAwB,GACxB73B,KAAA83B,WAAqB,EAGpB93B,KAAA+3B,QAAU,IAAInT,EAAAA,aACd5kB,KAAAg4B,SAAW,IAAIpT,EAAAA,aAwD7B,OAtDIgT,EAAA/xB,UAAAoyB,SAAA,WACIj4B,KAAKk4B,eAGTN,EAAA/xB,UAAAsyB,UAAA,SAAUpf,EAAoBjL,GAC1B9N,KAAK+3B,QAAQzS,KAAK,CAACvM,KAAIA,EAAEjL,MAAKA,KAGlC8pB,EAAA/xB,UAAAuyB,WAAA,SAAWrf,OACDtZ,EAAQO,KAAK63B,MAAMn4B,QAAQqZ,GAC7BtZ,GAAS,IACTO,KAAK63B,MAAMvmB,OAAO7R,EAAO,GACzBO,KAAKg4B,SAAS1S,KAAKvM,KAI3B6e,EAAA/xB,UAAAwyB,SAAA,SAASR,GAEL,IAAK,IAAI/rB,EAAK,EAAGA,EAAI+rB,EAAMrsB,OAAQM,IAAK,KAChCiN,EAAO8e,EAAM/rB,GACb9L,KAAKs4B,aAAavf,KAClBA,EAAY,OAAI,EAChB/Y,KAAKu4B,iBAAiBxf,IAE1B/Y,KAAK63B,MAAMhsB,KAAKkN,KAIhB6e,EAAA/xB,UAAAqyB,YAAR,WAAA,IAAAhyB,EAAAlG,KACQA,KAAKw4B,QACLx4B,KAAKw4B,OAAO1S,iBAAiB,UAAQ,SAAG/e,OAC9B8wB,EAAQ3xB,EAAKsyB,OAAOX,MACtBA,EAAMrsB,OAAS,IAEftF,EAAKmyB,SAASR,GAGd3xB,EAAKsyB,OAAOt0B,MAAQ,QAM5B0zB,EAAA/xB,UAAA0yB,iBAAR,SAAyBxf,OACf0f,EAAS,IAAIC,WACnBD,EAAOE,cAAc5f,GACrB0f,EAAOG,OAAM,WACT7f,EAAK5W,IAAMs2B,EAAOI,SAIlBjB,EAAA/xB,UAAAyyB,aAAR,SAAqBvf,GACjB,OAAOA,EAAK9V,MAAQ8V,EAAK9V,KAAKvD,QAAQ,UAAY,uBAlEzDwmB,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,YACVC,SAAA,k/CAICE,EAAAA,qBACAA,EAAAA,yBACAA,EAAAA,wBACAA,EAAAA,uBAEAC,EAAAA,yBACAA,EAAAA,UAwDLoR,EAtEA,GCAA,IAAAkB,EAAA,WAsBI,SAAAA,EAAoBpU,EACAqU,GADA/4B,KAAA0kB,gBAAAA,EACA1kB,KAAA+4B,aAAAA,EALpB/4B,KAAA63B,MAAe,GA4DnB,OAnDIiB,EAAAjzB,UAAAmzB,YAAA,SAAYC,GACJA,EAAQ5hB,UACRrX,KAAKk5B,sBAIbJ,EAAAjzB,UAAAof,YAAA,WACQjlB,KAAKm5B,UACLn5B,KAAKm5B,SAAShU,QAItB2T,EAAAjzB,UAAAuzB,eAAA,SAAergB,EAAMjL,GACjBnK,OAAO01B,KAAK7U,EAAUzH,eAAehE,EAAK1V,KAAM,KAAMyK,KAG1DgrB,EAAAjzB,UAAAyzB,iBAAA,SAAiBvgB,EAAMsN,GACftN,EAAKtL,IACLzN,KAAKu5B,MAAQxgB,EACb/Y,KAAKw5B,eAAiB,eAAiBzgB,EAAK9U,KAAO,mBACnDjE,KAAKm5B,SAAWn5B,KAAK+4B,aAAaxT,KAAKc,IAEvCrmB,KAAKy5B,SAASrB,WAAWrf,IAIjC+f,EAAAjzB,UAAAuyB,WAAA,WACSp4B,KAAKu5B,QAGVv5B,KAAKm5B,SAAShU,OACdnlB,KAAK0kB,gBAAgB5V,iBAAiB,CAAC4qB,OAAQ15B,KAAKu5B,MAAM9rB,GAAIW,QAASpO,KAAKqX,SAAS3R,OAAK,eAC1F1F,KAAKy5B,SAASrB,WAAWp4B,KAAKu5B,OAC9Bv5B,KAAKu5B,MAAQ,OAGTT,EAAAjzB,UAAAqzB,mBAAR,WACQl5B,KAAKqX,UAAYrX,KAAKqX,SAASyB,YAC/B9Y,KAAK63B,MAAQ73B,KAAKqX,SAASyB,YAAYuD,KAAG,SAAE7M,GACxC,MAAO,CACHvL,KAAMuL,EAAKuJ,KACX9V,KAAMuM,EAAKmqB,SACXC,KAAMpqB,EAAKoqB,KACXnsB,GAAI+B,EAAKqqB,WACTx2B,KAAMmM,MAIdxP,KAAK63B,MAAQ,wBAnExB3R,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,2BACVC,SAAA,qgDANIC,SACYwT,EAAAA,oDASfvT,EAAAA,sBACAA,EAAAA,yBACAA,EAAAA,wBACAE,EAAAA,UAASN,KAAA,CAACyR,MA6DfkB,EA9EA,OCkBM/wB,EAASC,EAGf+xB,EAAA,WAiCI,SAAAA,EAAoBvK,EACA9K,EACAgL,EACAnF,EACAyP,GAJpB,IAAA9zB,EAAAlG,KAAoBA,KAAAwvB,MAAAA,EACAxvB,KAAA0kB,gBAAAA,EACA1kB,KAAA0vB,OAAAA,EACA1vB,KAAAuqB,OAAAA,EACAvqB,KAAAg6B,KAAAA,EAxBpBh6B,KAAA8N,MAAkB,GAKlB9N,KAAAi6B,SAAW,CACP/S,MAAO,GACPpnB,KAAM,GACNyX,UAAW,GACXE,OAAQ,GACRjC,SAAU,GACV4U,QAAS,GACT8P,MAAO,GACP5nB,MAAO,GACPgH,QAAQ,EACR1B,QAAS,IAEb5X,KAAAkW,UAA2B,GACnBlW,KAAAm6B,WAA4B,GAqJpCn6B,KAAAytB,eAAiB,IAAI2M,EAAAA,YAAU,SAACC,OACxBn2B,EAAQgC,EAAKo0B,cAAcC,OAC1Br2B,GAILA,EAAQ7E,EAAU6E,GAClBm2B,EAAWpE,KAAK/vB,EAAKi0B,WAAW5qB,QAAM,SAAEC,GAAS,OAAAA,EAAa,OAAE9P,QAAQwE,IAAU,KAAG8M,MAAM,EAAG,MAJ1FqpB,EAAWpE,KAAK,OAKrBhD,KAAKuH,EAAAA,aAAa,KAAMC,EAAAA,wBAW3Bz6B,KAAA06B,eAAiB,IAAIN,EAAAA,YAAU,SAACC,OACxBn2B,EAAQgC,EAAK+zB,SAASzkB,SACrBtR,EAILgC,EAAKwe,gBAAgBwI,eAAehpB,GAAK,SAAGmD,GAAU,OAAAgzB,EAAWpE,KAAK5uB,EAAMgV,KAAG,SAAC7M,GAAQ,OAAAA,EAAK2d,eAHzFkN,EAAWpE,KAAK,OAIrBhD,KAAKuH,EAAAA,aAAa,KAAMC,EAAAA,wBAxKvBz6B,KAAK0kB,gBAAgBrY,OAAK,eAClB4B,EAAS/H,EAAKspB,MAAM6G,SAASsE,SACjC,GAAI1sB,EAAO2sB,IAAI,MACX10B,EAAKwe,gBAAgBvS,UAAU,CAC3B/D,QAASH,EAAO2sB,IAAI,QACvB,SAAG9sB,GACKA,GAIL5H,EAAK4H,MAAQA,EACb5H,EAAKgQ,UAAYpI,EAAMoI,UACpBpI,EAAMoB,UACLhJ,EAAK4H,MAAMuc,WAAavc,EAAMoB,QAAQoS,MAAI,SAAC9R,GACvC,MAAqB,YAAdA,EAAKyB,MAAsBzB,EAAKM,WAAaxN,KAAKwN,aAGjE5J,EAAK20B,aAVD30B,EAAK40B,eAAgB,SAY1B,KACCC,EACJ,KACIA,EAAQl0B,KAAKC,MAAMk0B,KAAK/sB,EAAO2sB,IAAI,WAC7B3iB,MAAQ,IAAI9X,KAAK46B,EAAM9iB,OAC7B8iB,EAAM7iB,IAAM,IAAI/X,KAAK46B,EAAM7iB,KAC7B,MAAOnR,IACLg0B,EAAQ,IACF9iB,MAAQ,IAAI9X,KAClB46B,EAAM9iB,MAAMpW,SAASk5B,EAAM9iB,MAAMtK,WAAa,EAAG,EAAG,EAAG,GACvDotB,EAAM7iB,IAAM,IAAI/X,KAAK46B,EAAM9iB,MAAM/W,UAAY,MAEjDgF,EAAK4H,MAAQitB,EACb70B,EAAK20B,gBAGb76B,KAAK0kB,gBAAgBgJ,eAAa,SAAExX,GAAc,OAAAhQ,EAAKi0B,WAAajkB,KA8M5E,OA3MI6jB,EAAAl0B,UAAAkf,gBAAA,WACI/kB,KAAKi7B,WAAWvV,cAAcwV,SAG1BnB,EAAAl0B,UAAAg1B,UAAR,eACQj0B,EAAS,CACTsgB,MAAOlnB,KAAK8N,MAAMwH,SAAW,GAC7BxV,KAAME,KAAK8N,MAAMmK,MACjBV,UAAWxP,EAAO/H,KAAK8N,MAAMmK,OAAOnN,OAAO,SAC3C2M,OAAQ1P,EAAO/H,KAAK8N,MAAMoK,KAAKpN,OAAO,SACtC0K,SAAUxV,KAAK8N,MAAM0H,UAAY,GACjC4U,QAASpqB,KAAK8N,MAAMsc,SAAW,GAC/BxS,QAAS5X,KAAK8N,MAAMoJ,WAAgD,SAAnClX,KAAK8N,MAAMoJ,UAAkB,SAAgB,EAC9EgjB,MAAO,eACP5nB,MAAO,GACPgH,QAAQ,GAERtZ,KAAK8N,MAAMuc,aACXzjB,EAAOszB,MAAQl6B,KAAK8N,MAAMuc,WAAW6P,MACrCtzB,EAAO0L,MAAQtS,KAAK8N,MAAMuc,WAAW/X,OAAS,IAElD8L,OAAOmU,OAAOvyB,KAAKi6B,SAAUrzB,GACzB5G,KAAK8N,MAAMwL,QACXtZ,KAAKm7B,cAAcn7B,KAAK8N,MAAMwL,SAItCygB,EAAAl0B,UAAA0nB,YAAA,WAAA,IAAArnB,EAAAlG,KACQqD,EAAOrD,KAAKo7B,eACX/3B,IAGLrD,KAAKg6B,KAAKqB,YAAY,iBAClBh4B,EAAK+K,SACLpO,KAAK0kB,gBAAgB8I,YAAYnqB,GAAI,SAAGA,GAChCA,EACA6C,EAAKo1B,aAELp1B,EAAKwpB,OAAO6D,YAAY,iCAAkC,YAGlEvzB,KAAKu7B,kBAELv7B,KAAK0kB,gBAAgB6I,YAAYlqB,GAAI,SAAGA,GAChCA,EACA6C,EAAKo1B,aAELp1B,EAAKwpB,OAAO6D,YAAY,4BAA6B,cAM7DwG,EAAAl0B,UAAAy1B,WAAR,WACIt7B,KAAKuqB,OAAOO,SAAS,CAAC,eAGlBiP,EAAAl0B,UAAAu1B,aAAR,WACI,GAAKp7B,KAAKw7B,YAAV,KAGIn4B,EAAOrD,KAAKi6B,SACZhsB,EAAc,CACdqH,QAASjS,EAAK6jB,MACdkD,QAAS/mB,EAAK+mB,QACd5U,SAAUnS,EAAKmS,SACf+B,UAAWvX,KAAK4N,WAAWvK,EAAKuU,QAAU,QAAUvU,EAAKkU,WACzDE,OAAQzX,KAAK4N,WAAWvK,EAAKuU,QAAU,QAAUvU,EAAKoU,QACtDG,QAASvU,EAAKuU,SAEd9X,EAAOiI,EAAO1E,EAAKvD,MAsBvB,OArBAmO,EAAOoG,IAAMvU,EAAKiB,YAClBkN,EAAO0J,KAAO7X,EAAK6X,OACf3X,KAAK8N,MAAMpI,OACXuI,EAAOG,QAAUpO,KAAK8N,MAAMpI,MAE5BrC,EAAKiW,QAAUtZ,KAAK8N,MAAMwL,SAC1B8E,OAAOmU,OAAOtkB,EAAQjO,KAAK8N,MAAMwL,QAC9BrL,EAAOkL,SACNlL,EAAOkL,OAASlL,EAAOkL,OAAO1W,KAAK,OAG3CzC,KAAKy5B,SAAS5B,MAAMpsB,SAAO,SAAEsN,EAAMtZ,GAC1BsZ,EAAKtL,KACNQ,EAAO,OAASxO,GAASsZ,MAG7B9K,EAAOuH,UACPxV,KAAK0kB,gBAAgB2I,aAAapf,EAAOuH,UAAQ,eAErDvH,EAAOiO,SAAWlc,KAAKkW,UACvBsO,EAAUzF,iBAAiB9Q,EAAQjO,KAAK8N,OACjCG,IAGH8rB,EAAAl0B,UAAA41B,aAAR,SAAqBvf,GACjB,IAAK,IAAIpQ,EAAI,EAAGA,EAAI9L,KAAKkW,UAAU1K,OAAQM,IACvC,GAAI9L,KAAKkW,UAAUpK,GAAGgE,WAAaoM,EAASpM,SACxC,OAAO,EAGf,OAAO,GAaXiqB,EAAAl0B,UAAA61B,YAAA,SAAY30B,OACJmV,EAAWnV,EAAEyI,KACjBxP,KAAKs6B,cAAgB,GAChBt6B,KAAKy7B,aAAavf,KACnBA,EAASjZ,KAAO6F,EAAgB/E,KAChC/D,KAAKkW,UAAUrK,KAAKqQ,KAapB6d,EAAAl0B,UAAA21B,UAAR,WACI,SAAKx7B,KAAKi6B,SAAS/S,MAAMqT,SAAWv6B,KAAKi6B,SAASn6B,SAG7CE,KAAKi6B,SAASriB,SACX5X,KAAK4N,WAAW5N,KAAKi6B,SAAS1iB,YAAcvX,KAAK4N,WAAW5N,KAAKi6B,SAASxiB,SAC1EzX,KAAK27B,WAAY,GACV,IAGf37B,KAAK27B,WAAY,GACV,KAGX5B,EAAAl0B,UAAAs1B,cAAA,SAAc93B,GACLA,GAILrD,KAAK8N,MAAMwL,OAASjW,EACpBrD,KAAKgqB,WAAapD,EAAcC,cAAcxjB,GAC9CrD,KAAKi6B,SAAS3gB,QAAS,GALnBtZ,KAAK47B,gBAQb7B,EAAAl0B,UAAAuxB,WAAA,SAAWK,GACHA,GACAz3B,KAAKg3B,YAAYI,WAAW,CACxBhe,OAAQpZ,KAAK8N,MAAMsL,SAG3BpZ,KAAK47B,gBAGT7B,EAAAl0B,UAAAg2B,aAAA,SAAa90B,GACTA,EAAE+0B,iBACF/0B,EAAEif,kBACFhmB,KAAKg3B,YAAYI,WAAWp3B,KAAK8N,MAAMwL,SAGnCygB,EAAAl0B,UAAA+1B,aAAR,WACI57B,KAAKgqB,WAAa,GAClBhqB,KAAKi6B,SAAS3gB,QAAS,GAGnBygB,EAAAl0B,UAAA01B,eAAR,WACSv7B,KAAK8N,MAAMuc,YAGhBrqB,KAAK0kB,gBAAgBvS,UAAU,CAC3B+nB,MAAOl6B,KAAKi6B,SAASC,MACrB5nB,MAAOtS,KAAKi6B,SAAS3nB,MACrBlE,QAASpO,KAAK8N,MAAMpI,OACvB,gBAGLq0B,EAAAl0B,UAAAk2B,OAAA,WACIC,QAAQC,QAGZlC,EAAAl0B,UAAAq2B,cAAA,SAAcpuB,GACNA,IACAA,EAAMguB,iBACNhuB,EAAMkY,mBAEVhmB,KAAK4rB,gBAAgBrG,QAGjBwU,EAAAl0B,UAAA+H,WAAR,SAAmBoK,OACXmkB,EAAQnkB,EAAQxV,MAAM,KAC1B,OAA0B,GAAnBqL,OAAOsuB,EAAM,IAAWtuB,OAAOsuB,EAAM,yBArRnDjW,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,oBACVC,SAAA,szRAnBIoQ,EAAAA,sBAFAnQ,SAGAqQ,EAAAA,2BADgBlK,EAAAA,cACK2P,EAAAA,0DAwBxB3V,EAAAA,UAASN,KAAA,CAAC,wCACVM,EAAAA,UAASN,KAAA,CAAC,oCACVM,EAAAA,UAASN,KAAA,CAAC,qCACVM,EAAAA,UAASN,KAAA,CAAC,mCACVM,EAAAA,UAASN,KAAA,CAAC2S,MA2QfiB,EAvRA,OCnBMhyB,EAASC,EAEfq0B,EAAA,WA0DI,SAAAA,IAnDSr8B,KAAA82B,WAAqB,YAErB92B,KAAA2mB,OAAiB,KAEjB3mB,KAAAJ,SAAmB,EAEnBI,KAAAs8B,WAAqB,EAErBt8B,KAAAyyB,KAA2B8J,EAAmBC,MA2B7Cx8B,KAAAwqB,SAAW,IAAI5F,EAAAA,aACf5kB,KAAAy8B,SAAW,IAAI7X,EAAAA,aAQzB5kB,KAAA08B,MAA8B,GAC9B18B,KAAA28B,UAAoC,GAgLxC,OAnNIve,OAAAwe,eAAaP,EAAAx2B,UAAA,OAAI,KA4BjB,WACI,OAAO,IAAI1F,KAAKH,KAAK2uB,YA7BzB,SAAkB7uB,OACV6uB,GAIAA,EAHC7uB,GAASA,EAAKoB,UAGP,IAAIf,KAAKL,GAFT,IAAIK,MAKV0B,SAAS,EAAG,EAAG,EAAG,GAEpB7B,KAAKyyB,OAAS8J,EAAmBC,OAEjC7N,EAAMvuB,QAAQ,GAIdJ,KAAK2uB,OAASA,EAAMztB,YAAclB,KAAK2uB,MAAMztB,YAIjDlB,KAAK2uB,MAAQA,EAEb3uB,KAAK68B,4CAuBTR,EAAAx2B,UAAAoyB,SAAA,WACSj4B,KAAK2uB,QACN3uB,KAAKF,KAAO,IAAIK,OAIxBk8B,EAAAx2B,UAAAi3B,UAAA,SAAU7oB,EAAQnU,OACVi9B,EAAa/8B,KAAKg9B,eAAel9B,GACjCi9B,IACAA,EAAW9oB,OAASA,IAI5BooB,EAAAx2B,UAAAo3B,YAAA,WACIj9B,KAAK08B,MAAMjxB,SAAO,SAACsxB,GAAc,OAAAA,EAAW9oB,OAAS,SAGzDooB,EAAAx2B,UAAAq3B,MAAA,WACIl9B,KAAKF,KAAO,IAAIK,MAGpBk8B,EAAAx2B,UAAAiP,KAAA,WACQ9U,KAAKyyB,OAAS8J,EAAmBC,MACjCx8B,KAAKm9B,aAELn9B,KAAKo9B,YAETp9B,KAAK68B,WAGTR,EAAAx2B,UAAAowB,KAAA,WACQj2B,KAAKyyB,OAAS8J,EAAmBC,MACjCx8B,KAAKq9B,aAELr9B,KAAKs9B,YAETt9B,KAAK68B,WAGTR,EAAAx2B,UAAA03B,WAAA,SAAWR,GACP/8B,KAAKw9B,WAAaT,EAGdA,EAAWU,aACXz9B,KAAKF,KAAOi9B,EAAWj9B,MAG3BE,KAAKy8B,SAASnX,KAAKyX,IAGvBV,EAAAx2B,UAAA63B,UAAA,SAAU59B,OACFi9B,EAAa/8B,KAAKg9B,eAAel9B,GACjCi9B,GACA/8B,KAAKu9B,WAAWR,IAIhBV,EAAAx2B,UAAAw3B,WAAR,WACIr9B,KAAK2uB,MAAM7L,SAAS9iB,KAAK2uB,MAAM9tB,WAAa,IAGxCw7B,EAAAx2B,UAAAs3B,WAAR,WACIn9B,KAAK2uB,MAAM7L,SAAS9iB,KAAK2uB,MAAM9tB,WAAa,IAGxCw7B,EAAAx2B,UAAAy3B,UAAR,WACIt9B,KAAK2uB,MAAMvuB,QAAQJ,KAAK2uB,MAAMtuB,UAAY,IAGtCg8B,EAAAx2B,UAAAu3B,UAAR,WACIp9B,KAAK2uB,MAAMvuB,QAAQJ,KAAK2uB,MAAMtuB,UAAY,IAGtCg8B,EAAAx2B,UAAAg3B,QAAR,WACQ78B,KAAKyyB,OAAS8J,EAAmBC,MACjCx8B,KAAK29B,eAEL39B,KAAK49B,cAGT59B,KAAKwqB,SAASlF,KAAKtlB,KAAKF,OAGpBu8B,EAAAx2B,UAAA83B,aAAR,eACQ79B,EAAOE,KAAK69B,oBAIhB,IAFA79B,KAAK08B,MAAQ,GACb18B,KAAK28B,UAAY,GACV38B,KAAK28B,UAAUnxB,QAAU,IAC5BxL,KAAK28B,UAAU9wB,KAAK7L,KAAK89B,gBAAgBh+B,IAErCA,EAAKe,aAAeb,KAAK2uB,MAAM9tB,cAKvCb,KAAK+9B,eACL/9B,KAAKg+B,iBAAiBh+B,KAAK28B,UAAU,KAGjCN,EAAAx2B,UAAA+3B,YAAR,eACQ99B,EAAOE,KAAK69B,oBAChB79B,KAAK08B,MAAQ,GACb18B,KAAK28B,UAAY,CAAC38B,KAAK89B,gBAAgBh+B,IACvCE,KAAK28B,UAAU,GAAGlxB,SAAO,SAAC3L,GAAQ,OAAAA,EAAK29B,YAAa,KACpDz9B,KAAK+9B,eACL/9B,KAAKg+B,iBAAiBh+B,KAAK28B,UAAU,KAGjCN,EAAAx2B,UAAAi4B,gBAAR,SAAwBh+B,GAGpB,QAFI68B,EAAkC,GAE7B7wB,EAAI,EAAGA,EAAI,EAAGA,IAAK,KACpBixB,EAAa,CACbj9B,KAAM,IAAIK,KAAKL,GACf+M,KAAM/M,EAAKoB,UACXu8B,WAAYz9B,KAAK2uB,MAAM9tB,aAAef,EAAKe,WAC3Co9B,MAAOj+B,KAAKk+B,SAASp+B,IAEzB68B,EAAU9wB,KAAKkxB,GACf/8B,KAAK08B,MAAM7wB,KAAKkxB,GAChBj9B,EAAKM,QAAQN,EAAKO,UAAY,GAGlC,OAAOs8B,GAGHN,EAAAx2B,UAAAm4B,iBAAR,SAAyBrB,GAAzB,IAAAz2B,EAAAlG,KACIA,KAAKm+B,WAAa,GAClBxB,EAAUlxB,SAAO,SAAE2yB,GACfl4B,EAAKi4B,WAAWtyB,KAAK9D,EAAOq2B,EAAWt+B,MAAM6mB,OAAOzgB,EAAKygB,QAAQ7b,OAAO,WAIxEuxB,EAAAx2B,UAAAk4B,aAAR,WACI/9B,KAAKq+B,UAAYt2B,EAAO/H,KAAK2uB,OAAOhI,OAAO3mB,KAAK2mB,QAAQ7b,OAAO9K,KAAK82B,aAGhEuF,EAAAx2B,UAAAg4B,kBAAR,eACQ/9B,EAAO,IAAIK,KAAKH,KAAK2uB,OACrB2P,EAAmBx+B,EAAKY,SAAWV,KAAKJ,SAS5C,OAPIE,EAAKY,SAAWV,KAAKJ,WACrB0+B,GAAoB,GAIxBx+B,EAAKM,QAAQN,EAAKO,UAAYi+B,GAEvBx+B,GAGHu8B,EAAAx2B,UAAAq4B,SAAR,SAAiBp+B,OACT6B,EAAM,IAAIxB,KACd,OAAOwB,EAAItB,YAAcP,EAAKO,WAAasB,EAAId,aAAef,EAAKe,YAAcc,EAAIf,gBAAkBd,EAAKc,eAGxGy7B,EAAAx2B,UAAAm3B,eAAR,SAAuBl9B,OACf6uB,EAAQ,IAAIxuB,KAAKL,GACrB6uB,EAAM9sB,SAAS,EAAG,EAAG,EAAG,GACxB,IAAK,IAAIiK,EAAI,EAAGA,EAAI9L,KAAK08B,MAAMlxB,OAAQM,IACnC,GAAI9L,KAAK08B,MAAM5wB,GAAGe,OAAS8hB,EAAMztB,UAC7B,OAAOlB,KAAK08B,MAAM5wB,wBAhOjCoa,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,kBACVC,SAAA,06FAKCE,EAAAA,sBAEAA,EAAAA,wBAEAA,EAAAA,0BAEAA,EAAAA,oBAEAA,EAAAA,oBAEAA,EAAAA,wBAyBAC,EAAAA,yBACAA,EAAAA,UAyLL6V,EApOA,UA+OIG,MAAQ,QACR+B,KAAO,QCpPXC,GAAA,WA6BI,SAAAA,EAAoB9Z,GAAA1kB,KAAA0kB,gBAAAA,EAfX1kB,KAAA2mB,OAAiB,KACjB3mB,KAAA82B,WAAqB,iBAG9B92B,KAAA0uB,OAAS,CACL,UACA,UACA,UACA,UACA,UACA,UACA,WAyGR,OAnGI8P,EAAA34B,UAAAoyB,SAAA,WACIj4B,KAAK2tB,cAGT6Q,EAAA34B,UAAA44B,YAAA,SAAY3+B,GACRE,KAAK2uB,MAAQ7uB,EACbE,KAAK0+B,eAAezB,cACpBj9B,KAAK2tB,cAGT6Q,EAAA34B,UAAA03B,WAAA,SAAWx2B,GACP/G,KAAK2+B,iBAAmB53B,EACxB/G,KAAK4+B,gBAAkBpa,EAAU9Z,WAAW3D,EAAEjH,KAAME,KAAK82B,aAG7D0H,EAAA34B,UAAA8nB,WAAA,WAAA,IAAAznB,EAAAlG,KACSA,KAAK2uB,OAIV3uB,KAAK0kB,gBAAgB7B,gBAAgB7iB,KAAK2uB,OAAK,SAAG1a,GAC9CA,EAAO9E,MAAI,SAAW3P,EAAGwC,GACrB,OAAOxC,EAAE6U,IAAMrS,EAAEqS,OAGrBnO,EAAK24B,kBAAkB5qB,GAAQxI,SAAO,SAAEqzB,GACpC54B,EAAKw4B,eAAe5B,UAAUgC,EAAM7qB,OAAQ6qB,EAAMh/B,SAIjDoG,EAAKy4B,kBACNz4B,EAAKw4B,eAAehB,UAAU,IAAIv9B,UAK9Cq+B,EAAA34B,UAAAipB,YAAA,SAAYhhB,EAAiBqb,EAAqB4F,GAAlD,IAAA7oB,EAAAlG,KACIA,KAAK0kB,gBAAgBwG,UAAUpd,EAAOqb,EAAS4F,GAAQ,WAAQ,OAAA7oB,EAAKynB,iBAGhE6Q,EAAA34B,UAAAg5B,kBAAR,SAA0B5qB,GAA1B,IAAA/N,EAAAlG,KACQ++B,EAAS,GAiCb,OA/BA9qB,EAAOxI,SAAO,SAACqC,OACPgxB,EACAh/B,EAAO,IAAIK,KAAK2N,EAAM0J,MAC1B1X,EAAK+B,SAAS,EAAG,EAAG,EAAG,GAEvB,IAAK,IAAIiK,EAAI,EAAGA,EAAIizB,EAAOvzB,OAAQM,IAC/B,GAAIizB,EAAOjzB,GAAGhM,KAAKoB,YAAcpB,EAAKoB,UAAW,CAC7C49B,EAAQC,EAAOjzB,GACf,MAIHgzB,IACDA,EAAQ,CACJ7qB,OAAQ,GACRnU,KAAMA,GAEVi/B,EAAOlzB,KAAKizB,IAGhB54B,EAAK2oB,iBAAiB/gB,GAEtBgxB,EAAM7qB,OAAOpI,KAAKiC,MAKtBixB,EAAOtzB,SAAO,SAAEqzB,GACbA,EAAM7qB,OAAO9E,MAAI,SAAE3P,EAAGwC,GAAM,OAAAxC,EAAE+X,UAAYvV,EAAEuV,gBAGxCwnB,GAGHP,EAAA34B,UAAAgpB,iBAAR,SAAyB/gB,OACjBnM,EAAM,IAAIxB,KAEd2N,EAAMkhB,YAAclhB,EAAMmK,MAAQtW,GAAOmM,EAAMoK,IAAMvW,EACrDmM,EAAMmhB,MAAQnhB,EAAMoK,IAAMvW,EAC1BmM,EAAMohB,QAAUphB,EAAMmK,MAAQtW,EAE1BmM,EAAMkhB,aACNlhB,EAAMqhB,WAAa,eACnBrhB,EAAMshB,YAAcpvB,KAAK0uB,OAAO,IACzB5gB,EAAMohB,SACbphB,EAAMqhB,WAAa,eACnBrhB,EAAMshB,YAAcpvB,KAAK0uB,OAAO,KAEhC5gB,EAAMqhB,WAAa,WACnBrhB,EAAMshB,YAAcpvB,KAAK0uB,OAAO,IAGpC5gB,EAAMuhB,MAAQ,CACVC,mBAAoBtvB,KAAK0uB,OAAO5gB,EAAM9C,4BAzHjDkb,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,kBACVC,SAAA,kjEALIC,6CASHG,EAAAA,UAASN,KAAA,CAAC,sCACVM,EAAAA,UAASN,KAAA,CAAC,8BACVI,EAAAA,0BACAA,EAAAA,SAmHLiY,EAlIA,GCAA,IAAAQ,GAAA,WAqBE,SAAAA,EAAYC,GAVHj/B,KAAAkW,UAA2B,GAC3BlW,KAAA+wB,UAAoB,EACpB/wB,KAAAk/B,YAAsB,EACrBl/B,KAAA2kB,SAAW,IAAIC,EAAAA,aAIzB5kB,KAAAm/B,cAAwB,EACxBn/B,KAAAo/B,UAAoB,EAGlBp/B,KAAKq/B,OAASJ,EAAQ3d,KAAK,IAAIhb,OAAO,MAuE1C,OApEE04B,EAAAn5B,UAAAy5B,UAAA,WACiBt/B,KAAKq/B,OAAOE,KAAKv/B,KAAKkW,YAInClW,KAAKw/B,kBAITR,EAAAn5B,UAAA45B,eAAA,SAAevjB,OACTzc,EAAQO,KAAKkW,UAAUxW,QAAQwc,GAC/Bzc,GAAS,IACXO,KAAKkW,UAAU5E,OAAO7R,EAAO,GAC7BO,KAAK2kB,SAASW,SAIlB0Z,EAAAn5B,UAAA25B,eAAA,eACME,EAAiB,EACjB9kB,EAAiB,EACjB+kB,EAAkB,EAClB/qB,EAAgB,GAEpB5U,KAAKkW,UAAUzK,SAAO,SAAW+D,GACzBA,EAAK0qB,QAAUlxB,EAAiBzB,UAChCiI,EAAKowB,WAAa,UAClBF,KACOlwB,EAAK0qB,QAAUlxB,EAAiBxB,UACvCgI,EAAKowB,WAAa,gBAClBhlB,KACOpL,EAAK0qB,QAAUlxB,EAAiB1B,eACvCkI,EAAKowB,WAAa,kBAClBD,QAIJD,GACF9qB,EAAI/I,KAAK6zB,EAAS,OAEhB9kB,GACFhG,EAAI/I,KAAK+O,EAAS,UAEhB+kB,GACF/qB,EAAI/I,KAAK8zB,EAAU,oBAErB3/B,KAAK6/B,UAAYjrB,EAAInS,KAAK,OAG5Bu8B,EAAAn5B,UAAAi6B,gBAAA,WACM9/B,KAAKm/B,eACPn/B,KAAKo/B,UAAYp/B,KAAKo/B,WAI1BJ,EAAAn5B,UAAAk6B,aAAA,SAAa7jB,OACP8jB,EACJ,OAAO9jB,EAASge,OACd,IAAK,WAGL,IAAK,WACH8F,EAAM,kBACN,MACF,QACEA,EAAM,mBAEV,MAAO,oBAAsBA,uBAvFhC9Z,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,yBACVC,SAAA,u/EAN+C4Z,EAAAA,sDAW9C1Z,EAAAA,wBACAA,EAAAA,0BACAA,EAAAA,wBACAC,EAAAA,UA+EHwY,EA7FA,OCKMkB,GAAiB,CACnB,CACIje,KAAM,aACNtQ,SAAU,CAAC,CACPsQ,KAAM,KACNke,UAAW5Q,KAGnB,CACItN,KAAM,iBACNtQ,SAAU,CACN,CACIsQ,KAAM,MACNke,UAAWpG,GAEf,CACI9X,KAAM,KACNme,WAAY,SACZC,UAAW,UAIvB,CACIpe,KAAM,kBACNtQ,SAAU,CACN,CACIsQ,KAAM,QACNke,UAAWpG,GAEf,CACI9X,KAAM,KACNke,UAAWpG,KAIvB,CACI9X,KAAM,WACNme,WAAY,aACZC,UAAW,SAInBC,GAAA,WAAA,SAAAA,KAKA,2BALCC,EAAAA,SAAQpa,KAAA,CAAC,CACNqa,QAAS,CAACC,EAAAA,aAAaC,SAASR,KAChCS,QAAS,CAACF,EAAAA,kBAGdH,EALA,GC3CMM,GAAe,CACjB,UAAW,OAAQ,UAAW,QAAS,QACvC,MAAO,MAAO,MAAO,OAAQ,MAAO,KAAM,MAAO,MACjD,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAAQ,MAAO,MAAO,MAChE,MAAO,MAAO,MACd,MAAO,KAAM,MAAO,MACpB,MAAO,MAAO,MAAO,MAAO,MAAO,MACnC,MAAO,MAAO,OAAQ,OAAQ,KAAM,MACpC,MAAO,OAGLC,GAAoB,CACtB,MAAO,OAAQ,MAAO,MAAO,MAAO,OACpC,MAAO,MAAO,OAAQ,OAAO,MAAO,OACpC,MAAO,OAAQ,OAAO,OAAQ,MAAQ,OAGpCC,GAAoB,CAAC,MAAO,MAAO,MAAO,OAAS,OAIzDC,GAAA,WAGI,SAAAA,KAuCJ,OArCIA,EAAAl7B,UAAAm7B,aAAA,eACQ/e,EAAQ3f,KAAK2+B,kBACXC,EAAYjf,EAAKkf,YAAY,KACnC,OAAID,IAAcjf,EAAKzW,OAAS,EACrByW,EAAKmf,UAAU,EAAGF,GAEtBjf,GAGX8e,EAAAl7B,UAAAw7B,kBAAA,WACI,OAAUrhC,KAAKghC,eAAc,WAGjCD,EAAAl7B,UAAAy7B,YAAA,SAAYC,OACFtf,EAAOjiB,KAAKqhC,oBAClB,OAAIT,GAAalhC,QAAQ6hC,IAAQ,EACnBtf,EAAI,IAAIsf,EAAI1xB,cAAa,OAE7BoS,EAAAA,gBAGd8e,EAAAl7B,UAAA27B,aAAA,SAAav9B,GACT,OAAOjE,KAAKshC,YAAYthC,KAAKyhC,aAAax9B,KAG9C88B,EAAAl7B,UAAA47B,aAAA,SAAax9B,GACT,OAAOA,EAAKzB,MAAM,KAAKk/B,MAAM7xB,eAjCrB,WAoCZkxB,EAAAl7B,UAAA87B,eAAA,WACI,OAAOd,IAGXE,EAAAl7B,UAAA+7B,eAAA,WACI,OAAOd,wBAvCd1S,EAAAA,mDA0CD2S,EA1CA,GCzBAc,GAAA,WAOI,SAAAA,EAAoBC,GAAA9hC,KAAA8hC,cAAAA,EAMxB,OAHID,EAAAh8B,UAAA2mB,UAAA,SAAUvoB,GACN,OAAOjE,KAAK8hC,cAAcL,aAAax9B,wBAR9C89B,EAAAA,KAAI5b,KAAA,CAAC,CACFliB,KAAM,uDAHF88B,MAYRc,EAbA,GCAA,IAAAG,GAAA,WAQI,SAAAA,EAAoBF,GAAA9hC,KAAA8hC,cAAAA,EAQxB,OAJIE,EAAAn8B,UAAA2mB,UAAA,SAAUvoB,GACN,OAAOjE,KAAK8hC,cAAcN,aAAav9B,wBAV9C89B,EAAAA,KAAI5b,KAAA,CAAC,CACFliB,KAAM,wDAHF88B,MAeRiB,EAhBA,GCAA,IAAAC,GAAA,WAOA,SAAAA,KAiBA,2BAjBC1B,EAAAA,SAAQpa,KAAA,CAAC,CACNqa,QAAS,CACL0B,EAAAA,cAEJC,aAAc,CACVH,GACAH,GACAjK,GAEJ+I,QAAS,CACLqB,GACAH,GACAjK,GAEJwK,UAAW,CAACrB,QAGhBkB,EAxBA,GCAAI,GAAA,WAwCI,SAAAA,EACWC,GAAAtiC,KAAAsiC,GAAAA,EA/BFtiC,KAAAuiC,WAAqB,EACrBviC,KAAAwiC,SAAmB,EAGnBxiC,KAAAyiC,WAAqB,GACrBziC,KAAA0iC,YAAsB,EACtB1iC,KAAA2iC,eAAyB,EACzB3iC,KAAA4iC,YAAsB,GAEtB5iC,KAAA6iC,aAAuB,EAEvB7iC,KAAA8iC,cAAwB,EAYvB9iC,KAAAwqB,SAAW,IAAI5F,EAAAA,aA4C7B,OAtDIxG,OAAAwe,eAAayF,EAAAx8B,UAAA,OAAI,KAMjB,WACI,OAAO7F,KAAK+iC,eAPhB,SAAkBjjC,GACdE,KAAK+iC,UAAYjjC,EACjBE,KAAK6X,QAAUwqB,EAAyBW,YAAYljC,GACpDE,KAAKwqB,SAASlF,KAAKtlB,KAAK6X,0CAmB5BwqB,EAAAx8B,UAAAoyB,SAAA,WAAA,IAAA/xB,EAAAlG,KACIA,KAAK+2B,OAASl0B,EAAE7C,KAAKsiC,GAAG5c,eAAeud,SAASC,SAAS,SACzDljC,KAAKmjC,cAAgBnjC,KAAK+2B,OAAOzV,KAAK,sBAGtCthB,KAAK+2B,OAAOhR,GAAG,mBAAiB,SAAGhf,GAC3BA,EAAEmiB,OAAOka,WAAWl9B,EAAK6wB,OAAO,KAChC7wB,EAAKm9B,YAKjBhB,EAAAx8B,UAAAof,YAAA,WACIjlB,KAAK+2B,OAAO3vB,UAGhBi7B,EAAAx8B,UAAAw9B,MAAA,WACIrjC,KAAK+2B,OAAOkM,UAGhBZ,EAAAx8B,UAAAwzB,KAAA,SAAK1N,GACD3rB,KAAKmjC,cAAcxX,IAAIA,GACvB/F,SAASC,KAAKoR,YAAYj3B,KAAK+2B,OAAO,KAG3BsL,EAAAW,YAAf,SAA2BljC,GACvB,OAAKA,GAASA,EAAKoB,WAGP,IAAMpB,EAAK6N,YAAYqD,OAAO,GAAK,KAAO,IAAMlR,EAAK8N,cAAcoD,OAAO,GAF3E,wBApElBkV,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,oBACVC,SAAA,qxBANeid,EAAAA,iDAUd/c,EAAAA,wBACAA,EAAAA,mBACAA,EAAAA,mBACAA,EAAAA,0BACAA,EAAAA,0BACAA,EAAAA,6BACAA,EAAAA,2BACAA,EAAAA,4BACAA,EAAAA,2BACAA,EAAAA,2BACAA,EAAAA,4BACAA,EAAAA,oBAEAA,EAAAA,wBAUAC,EAAAA,2BACAC,EAAAA,UAASN,KAAA,CAAC,iBA2Cfkc,EA7EA,GCIA,IAAakB,GAA8B,CACzCC,QAASC,EAAAA,kBACTC,YAAaC,EAAAA,YAAU,WAAO,OAAAC,MAC9BC,OAAO,GAGTD,GAAA,WAeE,SAAAA,EAAoBtB,GAAAtiC,KAAAsiC,GAAAA,EAVVtiC,KAAA8jC,YAAc,IAAIlf,EAAAA,aAuF9B,OArFyBgf,EAAA/9B,UAAAk+B,QAAvB,WACE/jC,KAAKq5B,OACLr5B,KAAKwqB,YAEiBoZ,EAAA/9B,UAAA2kB,SAAxB,WACExqB,KAAKgkC,gBAAgBn3B,KAAO7M,KAAKikC,gBAKnCL,EAAA/9B,UAAAoyB,SAAA,WAAA,IAAA/xB,EAAAlG,KACOA,KAAKgkC,iBACRE,QAAQh9B,MAAM,sDAEhBlH,KAAKgkC,gBAAgBxZ,SAAS2I,WAAS,SAAEtb,GACvC3R,EAAKi+B,WAAWtsB,GACZ3R,EAAKk+B,iBACPl+B,EAAKk+B,gBAAgBvsB,OAK3B+rB,EAAA/9B,UAAAs+B,WAAA,SAAWjgC,GACTlE,KAAKsiC,GAAG5c,cAAcxhB,MAAQA,EAC9BlE,KAAK8jC,YAAYxe,KAAKphB,IAGxB0/B,EAAA/9B,UAAAw+B,iBAAA,SAAiBj4B,GACfpM,KAAKokC,gBAAkBh4B,GAGzBw3B,EAAA/9B,UAAAy+B,kBAAA,SAAkBl4B,KAIlBw3B,EAAA/9B,UAAAwzB,KAAA,eACMkL,EAAWvkC,KAAKsiC,GAAG5c,cAAcmC,wBACjC8D,EAAM,CACRxD,KAAMoc,EAASpc,MAEboc,EAASlc,IAAM,IAAME,YAEvBoD,EAAS,IAAI4Y,EAASlc,IAAMkc,EAASxc,OAAS,EAG9C4D,EAAY,OAAI4Y,EAASlc,IAAM,EAEjCroB,KAAKgkC,gBAAgB3K,KAAK1N,IAG5BiY,EAAA/9B,UAAAw9B,MAAA,WACErjC,KAAKgkC,gBAAgBX,SAGfO,EAAA/9B,UAAAo+B,aAAR,eACM//B,EAAQlE,KAAKwkC,WACjB,IAAKtgC,EACH,OAAO,SAKLugC,EAHA3kC,EAAO,IAAIK,KAIf,GAHAL,EAAK4kC,WAAW,GAGZxgC,EAAMxE,QAAQ,MAAQ,EACxB+kC,EAAQvgC,EAAM1B,MAAM,SACf,CACLiiC,EAAQ,GACR,IAAK,IAAI34B,EAAI,EAAGA,EAAI5H,EAAMsH,OAAS,EAAGM,GAAK,EACzC24B,EAAM54B,KAAK3H,EAAM+f,OAAOnY,EAAG,IAM/B,OAHA24B,EAAM,GAAK52B,OAAO42B,EAAM,IACxBA,EAAM,GAAK52B,OAAO42B,EAAM,KAAO,EAE1BA,EAAM,IAAmB,IAAbA,EAAM,IAGvB3kC,EAAK+B,SAAS4iC,EAAM,IACpB3kC,EAAK4kC,WAAWD,EAAM,IACf3kC,GAJE,MAOH8jC,EAAA/9B,UAAA2+B,SAAR,WACE,OAAOxkC,KAAKsiC,GAAG5c,cAAcxhB,MAAMq2B,4BA1FtCoK,EAAAA,UAASxe,KAAA,CAAC,CACTC,SAAU,eACVgc,UAAW,CAACmB,iDAZKD,EAAAA,mDAehB9c,EAAAA,gCACAD,EAAAA,uBACAqe,EAAAA,aAAYze,KAAA,CAAC,2BAIbye,EAAAA,aAAYze,KAAA,CAAC,aAiFhByd,EA5FA,GCKA,IAAAiB,GAAA,WAAA,SAAAA,KAeqC,2BAfpCtE,EAAAA,SAAQpa,KAAA,CAAC,CACRqa,QAAS,CACPsE,EAAAA,iBAAiBC,UACjB7C,EAAAA,aACA8C,EAAAA,aAEF7C,aAAc,CACZyB,GACAvB,IAEF1B,QAAS,CACPiD,GACAvB,QAGiCwC,EAfrC,GCfAI,GAAA,WAyBA,SAAAA,KAmDA,2BAnDC1E,EAAAA,SAAQpa,KAAA,CAAC,CACNqa,QAAS,CACL0E,EAAAA,mBAAmBH,UACnBD,EAAAA,iBAAiBC,UACjBI,EAAAA,YAAYJ,UACZK,EAAAA,gBAAgBL,UAChBM,EAAAA,oBACAnD,EAAAA,aACA8C,EAAAA,YACAM,EAAAA,WACArD,GACAC,EAAAA,aACA2C,GACAU,EAAAA,iBACAjF,IAEJK,QAAS,CACLpR,EACAqH,EACAmD,EACAtL,EACA+P,GACAlU,EACA0U,GACAva,EACAqU,EACAuD,GAEJ8F,aAAc,CACV5S,EACAqH,EACAmD,EACAtL,EACA+P,GACAlU,EACA0U,GACAva,EACAqU,EACAuD,GAEJ+F,UAAW,CACP9b,EACAoQ,EAAAA,sBACArI,EAAAA,mBAEJmX,gBAAiB,CACblb,OAKR2a,EA5EA","sourcesContent":["// Convert vietnamese to latin\nvar accents_arr = [\n  \"Ã \",\"Ã¡\",\"áº¡\",\"áº£\",\"Ã£\",\"Ã¢\",\"áº§\",\"áº¥\",\"áº­\",\"áº©\",\"áº«\",\"Ä\",\n  \"áº±\",\"áº¯\",\"áº·\",\"áº³\",\"áºµ\",\"Ã¨\",\"Ã©\",\"áº¹\",\"áº»\",\"áº½\",\"Ãª\",\"á»\",\n  \"áº¿\",\"á»\",\"á»\",\"á»\",\n  \"Ã¬\",\"Ã­\",\"á»\",\"á»\",\"Ä©\",\n  \"Ã²\",\"Ã³\",\"á»\",\"á»\",\"Ãµ\",\"Ã´\",\"á»\",\"á»\",\"á»\",\"á»\",\"á»\",\"Æ¡\",\n  \"á»\",\"á»\",\"á»£\",\"á»\",\"á»¡\",\n  \"Ã¹\",\"Ãº\",\"á»¥\",\"á»§\",\"Å©\",\"Æ°\",\"á»«\",\"á»©\",\"á»±\",\"á»­\",\"á»¯\",\n  \"á»³\",\"Ã½\",\"á»µ\",\"á»·\",\"á»¹\",\n  \"Ä\",\n  \"Ã\",\"Ã\",\"áº \",\"áº¢\",\"Ã\",\"Ã\",\"áº¦\",\"áº¤\",\"áº¬\",\"áº¨\",\"áºª\",\"Ä\",\n  \"áº°\",\"áº®\",\"áº¶\",\"áº²\",\"áº´\",\n  \"Ã\",\"Ã\",\"áº¸\",\"áºº\",\"áº¼\",\"Ã\",\"á»\",\"áº¾\",\"á»\",\"á»\",\"á»\",\n  \"Ã\",\"Ã\",\"á»\",\"á»\",\"Ä¨\",\n  \"Ã\",\"Ã\",\"á»\",\"á»\",\"Ã\",\"Ã\",\"á»\",\"á»\",\"á»\",\"á»\",\"á»\",\"Æ \",\n  \"á»\",\"á»\",\"á»¢\",\"á»\",\"á» \",\n  \"Ã\",\"Ã\",\"á»¤\",\"á»¦\",\"Å¨\",\"Æ¯\",\"á»ª\",\"á»¨\",\"á»°\",\"á»¬\",\"á»®\",\n  \"á»²\",\"Ã\",\"á»´\",\"á»¶\",\"á»¸\",\n  \"Ä\"\n];\nvar no_accents_arr = [\n  \"a\",\"a\",\"a\",\"a\",\"a\",\"a\",\"a\",\"a\",\"a\",\"a\",\"a\",\n  \"a\",\"a\",\"a\",\"a\",\"a\",\"a\",\n  \"e\",\"e\",\"e\",\"e\",\"e\",\"e\",\"e\",\"e\",\"e\",\"e\",\"e\",\n  \"i\",\"i\",\"i\",\"i\",\"i\",\n  \"o\",\"o\",\"o\",\"o\",\"o\",\"o\",\"o\",\"o\",\"o\",\"o\",\"o\",\"o\",\n  \"o\",\"o\",\"o\",\"o\",\"o\",\n  \"u\",\"u\",\"u\",\"u\",\"u\",\"u\",\"u\",\"u\",\"u\",\"u\",\"u\",\n  \"y\",\"y\",\"y\",\"y\",\"y\",\n  \"d\",\n  \"A\",\"A\",\"A\",\"A\",\"A\",\"A\",\"A\",\"A\",\"A\",\"A\",\"A\",\"A\",\n  \"A\",\"A\",\"A\",\"A\",\"A\",\n  \"E\",\"E\",\"E\",\"E\",\"E\",\"E\",\"E\",\"E\",\"E\",\"E\",\"E\",\n  \"I\",\"I\",\"I\",\"I\",\"I\",\n  \"O\",\"O\",\"O\",\"O\",\"O\",\"O\",\"O\",\"O\",\"O\",\"O\",\"O\",\"O\",\n  \"O\",\"O\",\"O\",\"O\",\"O\",\n  \"U\",\"U\",\"U\",\"U\",\"U\",\"U\",\"U\",\"U\",\"U\",\"U\",\"U\",\n  \"Y\",\"Y\",\"Y\",\"Y\",\"Y\",\n  \"D\"\n];\n\nexport let vnToLatin = (str: string) => {\n  return str.replace(/[^\\u0000-\\u007E]/g, function (a) {\n    let index = accents_arr.indexOf(a);\n    return index < 0 ? a : no_accents_arr[index];\n  });\n};","export let DateUtils = {\n\n    firstDay: 1,\n\n    getWeekRange(date: Date, firstDay?: number | any) {\n        let startDate = this.getDateStartWeek(date, firstDay);\n        let endDate = new Date(startDate);\n        endDate.setDate(endDate.getDate() + 6);\n        return {\n            startWeek: startDate,\n            endWeek: endDate\n        }\n    },\n\n    getDayIndexOnWeek(date: Date, firstDay?: number | any): number {\n        // Default start date on monday\n        if (firstDay === undefined || firstDay < 0) {\n            firstDay = this.firstDay;\n        }\n\n        if (date.getDay() < firstDay) {\n            return 7 - date.getDay() - firstDay;\n        } else {\n            return date.getDay() - firstDay;\n        }\n    },\n\n    getDateStartWeek(date: Date, firstDay?: number | any): Date {\n        let distance = this.getDayIndexOnWeek(date, firstDay);\n        date = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n        date.setDate(date.getDate() - distance);\n        return date;\n    },\n\n    getDateEndWeek(date: Date, firstDay?: number | any): Date {\n        let endDate = this.getDateStartWeek(date, firstDay);\n        endDate.setDate(endDate.getDate() + 6);\n        return endDate;\n    },\n\n    dayOfYear(date: Date): number {\n        let jan = new Date(date.getFullYear(), 0, 1);\n        jan.setTime(jan.getTime() - 1);\n        return Math.ceil((date.getTime() - jan.getTime()) / 86400000);\n    },\n\n    getWeek(date: Date, firstDay?: number | any): number {\n        let startYear = new Date(date.getFullYear(), 0, 1);\n        let startWeek = this.getDateStartWeek(date, firstDay);\n        let dayInYear = this.dayOfYear(startWeek);\n        return Math.ceil(dayInYear / 7);\n    },\n\n    getDateFromWeek(w: number, y: number): Date {\n        let d = (1 + (w - 1) * 7);\n        return new Date(y, 0, d);\n    },\n\n    dateIsToday(date): boolean {\n        let now = new Date();\n        let compareDate = new Date(date);\n        now.setHours(0, 0, 0, 0);\n        compareDate.setHours(0, 0, 0, 0);\n        return now.getTime() === compareDate.getTime();\n    },\n\n    weekIsToday(date): boolean {\n        return this.getWeek(date) === this.getWeek(new Date());\n    },\n\n    isSameWeek(a: Date, b: Date): boolean {\n        return this.getWeek(a) === this.getWeek(b);\n    }\n\n};\n","declare let iNet: any;\ndeclare let $: any;\n\nexport let AjaxAPI = {\n\n  getUrl (url: string, domain?: string, firmPrefix?: string) {\n    if(url.indexOf('://') > -1)\n      return url;\n    domain = domain || iNet.getUrl('{0}');\n    url = domain.replace('{0}', url);\n\n    // Change firm prefix\n    if (firmPrefix) {\n      let urls = url.split('/');\n      urls[4] = firmPrefix;\n      url = urls.join('/');\n    }\n\n    return url;\n  },\n\n  // Get url by subfirm\n  getPUrl (url: string, domain?: string, firmPrefix?: string) {\n    return this.getUrl(url, domain, firmPrefix || iNet.firmPrefix);\n  },\n\n  // Send request\n  sendRequest (options: any) {\n    return $.ajax(options);\n  },\n\n  // Post ajax by FormData\n  postForm (options: any) {\n\n    options = $.extend({}, options, {\n      type: 'post',\n      cache: false,\n      contentType: false,\n      processData: false\n    });\n\n    // build form data\n    if(options.data && options.data.toString().indexOf('FormData') < 0){\n        let form = new FormData();\n        for(let k in options.data){\n          form.append(k, options.data[k]);\n        }\n        options.data = form;\n    }\n\n    return this.sendRequest(options);\n  }\n\n};\n\n// Detect on mobile\nif (window['eNet']) {\n  AjaxAPI.sendRequest = window['eNet'].ajaxSecure;\n}\n","export enum CalAttendeeType {\n    ALIAS = 'alias',\n    ORGAN = 'org',\n    USER = 'user'\n}\n","export let CalConfigs: CalConfigItem[] = [\n    {\n        name: 'DATE_TIME_FORMAT',\n        value: 'DD/MM/YYYY HH:mm',\n        description: 'Äá»nh dáº¡ng hiá»n thá» ngÃ y vÃ  thá»i gian'\n    },\n    {\n        name: 'DATE_FORMAT',\n        value: 'DD/MM/YYYY',\n        description: 'Äá»nh dáº¡ng hiá»n thá» ngÃ y'\n    },\n    {\n        name: 'TIME_FORMAT',\n        value: 'HH:mm',\n        description: 'Äá»nh dáº¡ng hiá»n thá» thá»i gian'\n    },\n    {\n        name: 'TIME_NEW_UPDATE',\n        value: '12',\n        description: 'Thá»i gian hiá»n thá» lá»ch má»i cáº­p nháº­t: giá»'\n    },\n    {\n        name: 'NOTE_LAST_UPDATE',\n        value: true,\n        description: 'Hiá»n thá» thá»i gian sá»­a Äá»i cuá»i cÃ¹ng: true | false'\n    },\n    {\n        name: 'EVENT_BETWEEN_UNIT',\n        value: true,\n        description: 'Lá»ch giá»¯a cÃ¡c ÄÆ¡n vá»: true | false'\n    },\n\n    {\n        name: 'PUBLISH_VIEW',\n        value: 'date',\n        description: '[Trang ban hÃ nh] Cháº¿ Äá» hiá»n thá» máº·c Äá»nh: week | date'\n    },\n\n    {\n        name: 'TV_VIEW',\n        value: 'date',\n        description: '[Trang tivi] Cháº¿ Äá» hiá»n thá»: week | date'\n    },\n    {\n        name: 'TV_TRANS_VELOCITY',\n        value: '30',\n        description: '[Trang tivi] Tá»c Äá» cháº¡y cá»§a lá»ch trÃªn má»i pixcel - millisecond'\n    },\n\n\n    {\n        name: 'EMBED_VIEW',\n        value: 'date',\n        description: '[Trang nhÃºng] Cháº¿ Äá» hiá»n thá» máº·c Äá»nh: week | date'\n    },\n    {\n        name: 'EMBED_VIEW_PAST',\n        value: true,\n        description: '[Trang nhÃºng] Hiá»n thá» nhá»¯ng lá»ch ÄÃ£ diá»n ra: true | false'\n    },\n\n    {\n        name: 'PERSON_VIEW',\n        value: 'listWeek',\n        description: '[Trang lá»ch] Cháº¿ Äá» hiá»n thá» máº·c Äá»nh: agendaWeek | agendaDay | listWeek'\n    },\n    {\n        name: 'PERSON_CREATE_TYPE',\n        value: 'COMMUNITY',\n        description: '[Trang lá»ch] Loáº¡i lá»ch máº·c Äá»nh khi táº¡o: COMMUNITY (cá»ng Äá»ng) | ORGANIZATION (ná»i bá»)'\n    },\n\n    {\n        name: 'INVITATION_SUPPORT',\n        value: true,\n        description: 'Há» trá»£ thÆ° má»i há»£p'\n    },\n\n    // Department\n    {\n        name: 'DEPARTMENT_VIEW_OTHER',\n        value: true,\n        description: 'Xem lá»ch cá»§a phÃ²ng ban khÃ¡c: true'\n    },\n    {\n        name: 'DEPARTMENT_APPROVE_OTHER',\n        value: false,\n        description: 'Duyá»t lá»ch cá»§a phÃ²ng ban khÃ¡c: false'\n    },\n\n    {\n        name: 'CAR_TYPE_CREATE',\n        value: 'COMMUNITY',\n        description: 'Loáº¡i lá»ch máº·c Äá»nh khi táº¡o lá»ch xe: COMMUNITY | ORGANIZATION'\n    },\n\n    {\n        name: 'CALENDAR_INCLUDE_CAR',\n        value: 'false',\n        description: 'Hiá»n thá» lá»ch bao gá»m lich xe'\n    },\n\n    {\n        name: 'EDIT_EVENT_PAST',\n        value: false,\n        description: 'Cho phÃ©p cáº­p nháº­t ná»i dung lá»ch ÄÃ£ diá»n ra: false'\n    },\n\n    {\n        name: 'PERSONAL_CAN_PUBLISH',\n        value: false,\n        description: '[Lá»ch cÃ¡ nhÃ¢n] Cho phÃ©p ban hÃ nh: false'\n    },\n\n    {\n        name: 'PEOPLE_EVENT_ENABLE',\n        value: false,\n        description: 'Cho phÃ©p táº¡o lá»ch tiáº¿p dÃ¢n'\n    },\n\n    {\n        name: 'PERSONAL_EVENT_ENABLE',\n        value: false,\n        description: 'Cho phÃ©p táº¡o lá»ch cÃ¡ nhÃ¢n'\n    },\n    {\n        name: 'CAR_EVENT_ENABLE',\n        value: false,\n        description: 'Cho phÃ©p táº¡o lá»ch xe'\n    },\n    {\n        name: 'ATTENDEE_DISPLAY_MAX_LENGTH',\n        value: '0',\n        description: 'Äá» dÃ i hiá»n thá» tá»i Äa cá»§a thÃ nh pháº§n'\n    },\n    {\n        name: 'VIEW_BY_LEADER',\n        value: true,\n        description: 'Xem lá»ch theo danh sÃ¡ch lÃ£nh Äáº¡o'\n    },\n    {\n        name: 'MOBILE_VIEW_BY_LEADER',\n        value: false,\n        description: '[Mobile] Máº·c Äá»nh xem lá»ch theo danh sÃ¡ch lÃ£nh Äáº¡o'\n    },\n    {\n        name: 'MOBILE_VIEW_BY_LEADER_ENABLE',\n        value: false,\n        description: '[Mobile] Xem lá»ch theo danh sÃ¡ch lÃ£nh Äáº¡o'\n    },\n    {\n        name: 'PUBLISH_EVENT_AFTER_CREATE',\n        value: false,\n        description: 'Ban hÃ nh lá»ch sau khi táº¡o'\n    },\n    {\n        name: 'CHECK_DUPLICATE_BEFORE_PUBLISH',\n        value: false,\n        description: 'Kiá»m tra lá»ch trÃ¹ng trÆ°á»c khi ban hÃ nh'\n    },\n    {\n        name: 'SUBJECT_DISPLAY_MAX_LENGTH',\n        value: '0',\n        description: 'Äá» dÃ i hiá»n thá» tá»i Äa cá»§a ná»i dung lá»ch'\n    },\n    {\n        name: 'PREFIX_ATTENDEE_NAME',\n        value: '',\n        description: 'Tiá»n tá» hiá»n thá» trÆ°á»c tÃªn ngÆ°á»i dÃ¹ng khi táº¡o lá»ch'\n    },\n    {\n        name: 'WORK_TIME_START',\n        value: '7:00',\n        description: 'Thá»i gian báº¯t Äáº§u lÃ m viá»c'\n    },\n    {\n        name: 'WORK_TIME_END',\n        value: '17:00',\n        description: 'Thá»i gian káº¿t thÃºc lÃ m viá»c'\n    },\n    {\n        name: 'NOTIFY_TO_ATTENDEE_ENABLE',\n        value: 'false',\n        description: 'Cho phÃ©p ngÆ°á»i duyá»t lá»ch gá»­i thÃ´ng bÃ¡o nháº¯c nhá» cho ngÆ°á»i nháº­n'\n    },\n];\n\nexport interface CalConfigItem {\n    name: string\n    value: any\n    description?: string\n}\n","export enum CalType {\n    COMMUNITY = 'COMMUNITY',\n    ORGANIZATION = 'ORGANIZATION',\n    DEPARTMENT = 'DEPARTMENT'\n}\n","export enum CalCategory {\n    IMPORTANT = \"IMPORTANT\",\n    CAR = \"CAR\",\n    INVITATION = \"INVITATION\",\n    PERSONAL = \"PERSONAL\"\n}\n","export enum CalCategoryIcon {\n    PERSONAL = \"fa fa-user\",\n    IMPORTANT = \"fa fa-star\",\n    CAR = \"fa fa-car\",\n    INVITATION = \"fa fa-envelope\",\n}\n","export enum CalAttendeeRole {\n    PREPARER = 'PREPARER', // not support\n    OBSERVER = 'OBSERVER',\n    CHAIRMAN = 'CHAIRMAN',\n    MEMBER = 'MEMBER',\n    CREATOR = 'CREATOR'\n}\n","export enum CalSubType {\n    MEET_PEOPLE = \"COMMUNITY;MEET_PEOPLE\",\n    PERSONAL = \"ORGANIZATION;PERSONAL\"\n}\n","export enum CalMode {\n    CREATE = 0,\n    PUBLISH = 1,\n    SENT = 2,\n    CANCEL = 3,\n    VERIFY = 4,\n    OTHER = 5\n}\n","import {DictionaryData, SubFirmDictionary} from \"./subfirm/Dictionary\";\n\nexport class CalendarCar {\n\n  carDefault = {\n    name: 'Máº·c Äá»nh',\n    uuid: ''\n  };\n\n  carRef: string = 'CAL_BUILDER_CAR';\n  driverRef: string = 'CAL_BUILDER_DRIVER';\n\n  subFirmDict: SubFirmDictionary;\n\n  constructor(subFirmDict: SubFirmDictionary) {\n    this.subFirmDict = subFirmDict;\n  }\n\n  loadCars(callback: Function) {\n    this._loadList(this.carRef, callback);\n  }\n\n  createOrUpdateCars(data: DictionaryData, callback: Function) {\n    if (!data.uuid) {\n      data.name = this.carRef;\n      data.reference = this.carRef;\n      this.subFirmDict.create(data, (data) => this.parseJsonValue(data, callback));\n    } else {\n      this.subFirmDict.update(data, (data) => this.parseJsonValue(data, callback));\n    }\n  }\n\n  loadDrivers(callback: Function) {\n    this._loadList(this.driverRef, callback);\n  }\n\n  createOrUpdateDrivers(data: DictionaryData, callback: Function) {\n    if (!data.uuid) {\n      data.name = this.driverRef;\n      data.reference = this.driverRef;\n      this.subFirmDict.create(data, (data) => this.parseJsonValue(data, callback));\n    } else {\n      this.subFirmDict.update(data, (data) => this.parseJsonValue(data, callback));\n    }\n  }\n\n  _loadList(ref: string, callback: Function) {\n    this.subFirmDict.list(ref, (results) => this.parseJsonValue(results[0], callback));\n  }\n\n  parseJsonValue(data: DictionaryData, callback: Function) {\n    let values = [];\n    try {\n      values = JSON.parse(data.value);\n    } catch (e) {}\n    callback(values, data);\n  }\n}\n","declare let iNet: any;\ndeclare let $: any;\n\nexport class SubFirmDictionary {\n\n    create(data: DictionaryData, callback: Function) {\n        $.ajax({\n            type: 'post',\n            url: this.getUrl('subfirm/dictionary/create'),\n            data: data,\n            success: (data) => callback(data),\n            error: () => callback(null)\n        });\n    }\n\n    update(data: DictionaryData, callback: Function) {\n        data.dictID = data.dictID || data.uuid;\n        $.ajax({\n            type: 'post',\n            url: this.getUrl('subfirm/dictionary/update'),\n            data: data,\n            success: (data) => callback(data),\n            error: () => callback(null)\n        });\n    }\n\n    remove(data: DictionaryData, callback: Function) {\n        data.dictID = data.dictID || data.uuid;\n        $.ajax({\n            url: this.getUrl('subfirm/dictionary/remove'),\n            data: data,\n            success: (data) => callback(data),\n            error: () => callback(null)\n        });\n    }\n\n    list(reference: string, callback: Function) {\n        $.ajax({\n            url: this.getUrl('subfirm/dictionary/list'),\n            data: {\n                reference: reference\n            },\n            success: (data) => callback(data && data.items || []),\n            error: () => callback([])\n        });\n    }\n\n\n    getUrl(url: string): string {\n        return iNet.getPUrl(url);\n    }\n\n}\n\nexport interface DictionaryData {\n    dictID?: string // uuid when update\n    name?: string\n    value?: string\n    reference?: string\n    uuid?: string\n    cache?: boolean\n    order?: number\n}\n","export enum CalAttendeeState {\n    NEEDS_ACTION = 'NEEDS_ACTION',\n    ACCEPTED = 'ACCEPTED',\n    DECLINED = 'DECLINED',\n    TENTATIVE = 'TENTATIVE',\n    DELEGATED = 'DELEGATED',\n    COMPLETED = 'COMPLETED',\n    IN_PROCESS = 'IN_PROCESS',\n    NONE = 'NONE',\n    OTHERS = 'OTHERS'\n}\n","import {vnToLatin} from \"./common/Accent\";\nimport {DateUtils} from \"./common/DateUtils\";\nimport {AjaxAPI} from \"./common/AjaxAPI\";\nimport {CalEvent} from \"./model/CalEvent\";\nimport {CalAttendeeType} from \"./model/CalAttendeeType\";\nimport {CalConfigs} from \"./CalConfigs\";\nimport {CalType} from \"./model/CalType\";\nimport {CalCategory} from \"./model/CalCategory\";\nimport {CalCategoryIcon} from \"./model/CalCategoryIcon\";\nimport {CalAttendeeRole} from \"./model/CalAttendeeRole\";\nimport {CalSubType} from \"./model/CalSubType\";\nimport {CalMode} from \"./model/CalMode\";\nimport {CalendarCar} from \"./CalendarCar\";\nimport {DictionaryData, SubFirmDictionary} from \"./subfirm/Dictionary\";\nimport {CalAttendeeState} from \"./model/CalAttendeeState\";\nimport {CalAttendee} from \"./model/CalAttendee\";\nimport {LEADER_REFERENCE} from \"./CalConstants\";\n\nimport * as moment_ from 'moment';\nconst moment = moment_;\nwindow['moment'] = moment;\n\ndeclare let iNet: any;\ndeclare let $: any;\n\nexport class CalBuilder {\n    isAuth: boolean;\n    orgid: string;\n    TIME_NEW_UPDATE: number = 12;\n    roleUrl: string = 'xschedule/page/role';\n\n    MODE = CalMode;\n    ROLE = CalAttendeeRole;\n    calSubType = CalSubType;\n    calCategory = CalCategory;\n    vnToLatin = vnToLatin;\n    dateUtils = DateUtils;\n    calAttendeeType = CalAttendeeType;\n    calAttendeeState = CalAttendeeState;\n    calType = CalType;\n\n    subFirmDic = new SubFirmDictionary();\n    carUtils = new CalendarCar(this.subFirmDic);\n\n    configs = CalConfigs;\n\n    resources = {\n        days: [\n            'Chá»§ nháº­t',\n            'Thá»© hai',\n            'Thá»© ba',\n            'Thá»© tÆ°',\n            'Thá»© nÄm',\n            'Thá»© sÃ¡u',\n            'Thá»© báº£y'\n        ],\n        statuses: [\n            'Má»i táº¡o',\n            'Ban hÃ nh',\n            'Chá» duyá»t',\n            'ÄÃ£ há»§y',\n            'ThÃ´ng qua',\n            'Lá»ch ÄÆ¡n vá» khÃ¡c'\n        ],\n        allDay: 'Cáº£ ngÃ y',\n        hour: 'giá»',\n        minute: 'phÃºt'\n    };\n\n    _userRoles = {};\n    _mapEvents = {};\n    _cacheStore: any;\n    _queue = {};\n\n    _organs: any[] = [];\n    _myOrgans: any[] = [];\n\n    _applyConfig() {\n        iNet.apply(this, DateUtils);\n\n        // Apply config\n        if (window['xCalendarConfigList'] && window['xCalendarConfigList'].length > 0) {\n            window['xCalendarConfigList'].forEach((config) => {\n                let obj = this.getConfigObj(config.name);\n                if (obj) {\n                    $.extend(obj, config);\n                } else {\n                    this.configs.push(config);\n                }\n            });\n        }\n        if (window['xCalendarConfigCustoms']) {\n            for (let k in window['xCalendarConfigCustoms']) {\n                let obj = this.getConfigObj(k);\n                if (obj) {\n                    obj.value = window['xCalendarConfigCustoms'][k];\n                }\n            }\n        }\n\n        // Apply resources\n        if (window['xcalendarResources']) {\n            this.resources = window['xcalendarResources'];\n        }\n\n        this.configs.forEach(function (obj) {\n            if (obj.value === 'false') {\n                obj.value = false;\n            }\n        });\n    }\n\n    typeIsDepartment = (type: string) => type === CalType.DEPARTMENT;\n\n    typeIsCommunity = (type: string) =>  type === CalType.COMMUNITY;\n\n    typeIsOrganization = (type: string) =>  type === CalType.ORGANIZATION;\n\n    catIsInvitation = (category: string) => CalCategory.INVITATION === category;\n\n    catIsPersonal = (category: string) => CalCategory.PERSONAL === category;\n\n    catIsCar = (category: string) => CalCategory.CAR === category;\n\n    catIsImportant = (category: string) => CalCategory.IMPORTANT === category;\n\n    formatDateStr = (date) => this.formatDate(date, this.getConfigValue('DATE_FORMAT'));\n\n    formatTimeStr = (date) => this.formatDate(date, this.getConfigValue('TIME_FORMAT'));\n\n    formatDateTimeStr = (date) => this.formatDate(date, this.getConfigValue('DATE_TIME_FORMAT'));\n\n    formatDate = (date, format) => moment(date).format(format);\n\n    getConfigValue(name: string) {\n        let obj = this.getConfigObj(name);\n        return obj && obj.value;\n    }\n\n    getConfigObj(name: string) {\n        for (let i = 0; i < this.configs.length; i++) {\n            if (this.configs[i].name === name) {\n                return this.configs[i];\n            }\n        }\n    }\n\n    addQueue(name: any, executor: any, callback: any) {\n        this._queue[name] = this._queue[name] || [];\n        this._queue[name].push(callback);\n        if (this._queue[name].length === 1) {\n            new Promise((resolve) => {\n                executor(resolve);\n            }).then((value) => {\n                this._queue[name].forEach((fn) => {\n                    fn && fn(value);\n                });\n                delete this._queue[name];\n            });\n        }\n    }\n\n    ready(callback, options?: any) {\n        this._loadOrgans((organs) => {\n            callback(organs, this._getOrganOnInit());\n        }, options);\n    }\n\n    // Cache all org in a minute for performance\n    cacheSessionStorage(key: string, value?: any) {\n        try {\n            if (!value) {\n                // Cache data in a minute\n                let timeCache: number = 5 * 60000;\n                let cache: any = sessionStorage.getItem(key);\n                if (cache) {\n                    cache = JSON.parse(cache);\n                    if (new Date().getTime() - cache.time < timeCache) {\n                        return cache.data;\n                    } else {\n                        sessionStorage.removeItem(key);\n                    }\n                }\n                return false;\n            } else {\n                sessionStorage.setItem(key, JSON.stringify({\n                    time: new Date().getTime(),\n                    data: value\n                }));\n            }\n\n            // Fixed prev version\n            localStorage.removeItem(key);\n        } catch (e) {}\n    }\n\n    // Cache data on global window, refresh tab will reset\n    cacheDataTemp(key, data?: any) {\n        this._cacheStore = this._cacheStore || {};\n        if (data === undefined) {\n            return this._cacheStore[key];\n        } else {\n            this._cacheStore[key] = data;\n        }\n    }\n\n    setOrgId(orgid: string) {\n        this.orgid = orgid;\n        this._cacheOrgId(orgid);\n    }\n\n    getOrgId() {\n        return this.orgid || this._cacheOrgId() || iNet.organId;\n    }\n\n    _cacheOrgId(orgid?: any) {\n        let id = 'xcalendar_orgid';\n        try {\n            if (!orgid) {\n                return localStorage.getItem(id);\n            } else {\n                localStorage.setItem(id, orgid);\n            }\n        } catch (e) {}\n    }\n\n    getHourMinute(date?: any) {\n        if (date.getTime) {\n            // date object\n            return date.getHours() * 60 + date.getMinutes();\n        } else {\n            // string hour\n            date = date.split(':');\n            return Number(date[0]) * 60 + Number(date[1]);\n        }\n    }\n\n    create(form: any, success, options?: any) {\n        return this.postForm({\n            url: 'calbuilder/element/create',\n            data: form,\n            success: (event) => {\n                if (event && event.uuid)\n                    this.indexEvent(event);\n                success(event);\n            }\n        }, options);\n    }\n\n    updateEventByRole(params, success, options?: any) {\n        let organId = params && params.orgid || this.getOrgId();\n        this.loadRole(organId,() => {\n            let event = this.getEventByObjectId(params && params.element);\n            if (this.isReviewer(organId)) {\n                this.reviewUpdate(params, success, options);\n            } else if (this.isOwnReviewer(organId) && event && this.meIsCreator(event)) {\n                this.ownerReviewUpdate(params, success, options);\n            } else {\n                this.update(params, success, options);\n            }\n        }, options);\n    }\n\n    update(form, success, options?: any) {\n        return this.postForm({\n            url: 'calbuilder/element/update',\n            data: form,\n            success: (event) => {\n                if (event && event.uuid)\n                    this.indexEvent(event);\n                success && success(event);\n            }\n        }, options);\n    }\n\n    reviewUpdate(form, success, options?: any) {\n        return this.postForm({\n            url: 'calbuilder/reviewupdate',\n            data: form,\n            success: (event) => {\n                if (event && event.uuid)\n                    this.indexEvent(event);\n                success && success(event);\n            }\n        }, options);\n    }\n\n    ownerReviewUpdate(form, success, options?: any) {\n        return this.postForm({\n            url: 'calbuilder/owner/reviewupdate',\n            data: form,\n            success: (event) => {\n                if (event && event.uuid)\n                    this.indexEvent(event);\n                success && success(event);\n            }\n        }, options);\n    }\n\n    remove(params, callback, options?: any) {\n        return this.sendRequest({\n            url: 'calbuilder/element/delete',\n            data: params,\n            success: callback\n        }, options);\n    }\n\n    cancel(params, success, options?: any) {\n        let organId = params && params.orgid || this.getOrgId();\n        this.loadRole(organId,() => {\n            if (this.isReviewer(organId)) {\n                this.reviewCancel(params, success, options);\n            } else if (this.isOwnReviewer(organId)) {\n                this.ownerReviewCancel(params, success, options);\n            }\n        }, options);\n    }\n\n    // element, members\n    reviewNotify(params, success, options?: any) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/reviewnotify',\n            data: params,\n            success: success\n        }, options);\n    }\n\n    reviewCancel(params, success, options?: any) {\n        return this.sendRequest({\n            url: 'calbuilder/reviewcancel',\n            data: params,\n            success: (event) => {\n                if (event && event.uuid)\n                    this.indexEvent(event);\n                success && success(event);\n            }\n        }, options);\n    }\n\n    ownerReviewCancel(params, success, options?: any) {\n        return this.sendRequest({\n            url: 'calbuilder/owner/reviewcancel',\n            data: params,\n            success: (event) => {\n                if (event && event.uuid)\n                    this.indexEvent(event);\n                success && success(event);\n            }\n        }, options);\n    }\n\n    deleteAttachment(params, success, options?: any) {\n        /**\n         * fileID: 'id1,id2'\n         * element: 'uuid'\n         */\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/file/delete',\n            data: params,\n            success: (event) => {\n                success && success(this.indexEvent(event));\n            }\n        }, options);\n    }\n\n\n    loadOrganMembers(organId: string, callback: Function, options?: any) {\n        organId = organId || this.getOrgId();\n        return this.searchAttendee({orgid: organId}, callback, options);\n    }\n\n    searchAttendee(params, success, options?: any) {\n        this._searchAttendee(params, function (members) {\n            members.sort((a, b) => a.fullname.localeCompare(b.fullname));\n            success(members);\n        }, options);\n    }\n\n    _searchAttendee(params, success, options?: any) {\n        return this.sendRequest({\n            url: 'calbuilder/attendee/search',\n            data: params,\n            success: (data) => {\n                let members = data && data.elements || [];\n                members = members.filter((item) => !item.alias);\n                members.forEach((member) => this._indexAccount(member));\n                success(members);\n            },\n            error: function () {\n                success([]);\n            }\n        }, options, true);\n    }\n\n    _indexAccount(account) {\n        // Remove suffix email before search user \"binh@binhdinh.gov.vn\"\n        // don't search on suffix \"@binhdinh.gov.vn\"\n        account['_index'] = vnToLatin(account.fullname.toLowerCase()) + ' ' +\n            account.username.split('@')[0];\n        account.display = this.insertPrefixAttendee(account.fullname || account.username);\n        return account;\n    }\n\n    loadDepartments(params, callback, options?: any) {\n        return this.sendRequest({\n            url: 'calbuilder/department/list',\n            data: params,\n            success: (data) => {\n                data = data && data.items || [];\n                data.sort((a, b) => {\n                    return a.order - b.order;\n                });\n                callback(data);\n            },\n            error: () => {\n                callback([]);\n            }\n        }, options, true);\n    }\n\n    getMyOrg(callback, options?: any) {\n        let keyCache = 'cal_my_organs';\n\n        // Remove data unused prev version\n        localStorage.removeItem(keyCache);\n\n        keyCache += iNet.usercode;\n\n        this._myOrgans = this._myOrgans.length && this._myOrgans || this.cacheSessionStorage(keyCache) || [];\n        if (this._myOrgans.length > 0) {\n            return callback(this._myOrgans);\n        }\n        this.sendRequest({\n            url: 'plugin/organization/list',\n            success: (data) => {\n                let organs = this._convertOrg(data && data.elements || []);\n                if (organs.length > 0) {\n                    organs = this.visibleMyOrgans(organs);\n                    this._myOrgans = organs;\n                    this.cacheSessionStorage(keyCache, organs);\n                }\n                callback(organs);\n            },\n            error: () => callback([])\n        }, options, true);\n\n    }\n\n    visibleMyOrgans(organs) {\n        return organs.filter((organ) => {\n            let _organ = this.getOrgById(organ.firmUUID);\n            return _organ && !!_organ.groupType;\n        });\n    }\n\n    getAllOrg(callback: any, options?: any): any {\n        let keyCache = 'cal_organ_list';\n\n        // Remove data unused prev version\n        localStorage.removeItem(keyCache);\n\n        keyCache += iNet.usercode;\n\n        this._organs = this._organs.length && this._organs || this.cacheSessionStorage(keyCache) || [];\n        // Check all org is cached\n        if (this._organs.length > 0) {\n            return callback(this._organs);\n        }\n        return this.sendRequest({\n            data: {pageSize: -1},\n            url: 'plugin/organization/search',\n            success: (data) => {\n                let organs = this._convertOrg(data && data.items || []);\n                if (organs.length > 0) {\n                    // Only get organ has groupType\n                    organs = this.visibleOrgans(organs);\n                    this._organs = organs;\n                    this.cacheSessionStorage(keyCache, this._organs);\n                }\n                callback(organs);\n            },\n            error: () => callback([])\n        }, options, true);\n    }\n\n    visibleOrgans(organs) {\n        return organs.filter((organ) => !!organ.groupType);\n    }\n\n    private _loadOrgans(callback, options?: any) {\n        if (this._organs && this._organs.length > 0) {\n            callback(this._organs.slice());\n        } else {\n            this.getAllOrg((organs) => {\n\n                // Detect user login\n                this.loadRole('', (role) => {\n                    this.isAuth = !!role.isAuth;\n                    if (role.isAuth) {\n                        this.getMyOrg((myOrgans) => {\n                            // Move my organs to first\n                            for (let i = myOrgans.length - 1; i >= 0; i--) {\n                                let myOrgan = myOrgans[i];\n                                for (let j = 0; j < organs.length; j++) {\n                                    let organ = organs[j];\n                                    if (organ.firmUUID === myOrgan.firmUUID) {\n                                        organs.splice(j, 1);\n                                        organ.myOrg = true;\n                                        organs.unshift(organ);\n                                        break;\n                                    }\n                                }\n                            }\n                            callback(organs);\n\n                        }, options);\n                    } else {\n                        callback(organs);\n                    }\n                }, options);\n\n            }, options);\n        }\n    }\n\n    getTreeOrg(callback, domain?: any) {\n        this._loadOrgans((data) => {\n            let tree: any = [];\n\n            // Set children is empty\n            data.forEach((item) => {\n                item.children = [];\n            });\n\n            // Build tree org list\n            data.forEach((item) => {\n                if (item.parentID) {\n                    let parentOrgan = this.getOrgById(item.parentID);\n                    if (parentOrgan) {\n                        parentOrgan.children.push(item);\n                    }\n                } else {\n                    tree.push(item);\n                }\n            });\n\n            tree.data = data;\n            callback && callback(tree);\n        }, domain);\n    }\n\n    indexOrgSearch(item?: any) {\n        item._index = vnToLatin([item.firmName, item.firmUUID, item.firmPrefix].join(' ').toLowerCase());\n    }\n\n    isMyOrg(orgid?: string) {\n        let org = this.getOrgById(orgid);\n        return org && org.myOrg;\n    }\n\n    loadEvent(params, callback, options?: any) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/element/load',\n            data: params,\n            success: (data) => {\n                if (!data || !data.uuid) {\n                    // Event not found, try to load review event\n                    this.loadRole(params.orgid, () => {\n                        if (this.isReviewer(params.orgid)) {\n                            this.loadEventReview(params, callback, options);\n                        } else {\n                            callback && callback(data);\n                        }\n                    });\n                    return;\n                }\n                this.indexEvent(data);\n                callback && callback(data);\n            }\n        }, options);\n    }\n\n    updateState(params, callback, options?: any) {\n        if (params.notes) {\n            params.notes = this.formatTextUpdate(params.notes);\n        }\n        return this.loadEvent(params, callback, options);\n    }\n\n    loadEventReview(params, success, options?: any) {\n        return this.sendRequest({\n            url: 'calbuilder/reviewload',\n            data: params,\n            success: (event) => {\n                if (event && event.uuid)\n                    this.indexEvent(event);\n                success && success(event);\n            }\n        }, options);\n    }\n\n    loadGroupEvent(params, success, options?: any) {\n        return this.sendRequest({\n            url: 'calbuilder/element/group',\n            data: params,\n            success: (data) => success(this.modifyEvent(data && data.items || []))\n        }, options);\n    }\n\n    loadOrgEvents(params, callback, options) {\n        this._loadOnDifferYear(this._loadOrgEvents, params, callback, options);\n    }\n\n    _loadOrgEvents(params, callback, options) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/mainboard/view',\n            data: params,\n            success: (data) => callback(this.modifyEvent(data && data.items || []))\n        }, options);\n    }\n\n    loadCommunityEvents(params, callback, options) {\n        this._loadOnDifferYear(this._loadCommunityEvents, params, callback, options);\n    }\n\n    _loadCommunityEvents(params, callback, options) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/mainboard/published',\n            data: params,\n            success: (data) => callback(this.modifyEvent(data && data.items || [])),\n            useOrgId: true\n        }, options);\n    }\n\n    loadAllPublishEvents(params, callback, options) {\n        this._loadOnDifferYear(this._loadAllPublishEvents, params, callback, options);\n    }\n\n    _loadAllPublishEvents(params, callback, options) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/mainboard/published',\n            data: params,\n            success: (data) => callback(this.modifyEvent(data && data.items || [])),\n            removeOrgId: true\n        }, options);\n    }\n\n    loadPublishEvents(params, callback: Function, options?: any) {\n        // Load role\n        this.loadRole(params.orgid,  () => {\n            // Reviewer\n            if (this.isMyOrg(params.orgid)) {\n                this.loadOrgEvents(params, callback, options);\n            } else {\n                this.loadCommunityEvents(params, callback, options);\n            }\n        }, options);\n    }\n\n    getReviewEvents(params, callback, options) {\n        this._loadOnDifferYear(this._getReviewEvents, params, callback, options);\n    }\n\n    _getReviewEvents(params, callback, options) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/reviewlist',\n            data: params,\n            success: (data) => callback(this.modifyEvent(data && data.items || []))\n        }, options);\n    }\n\n    getViewEvents(params, callback, options) {\n        this._loadOnDifferYear(this._getViewEvents, params, callback, options);\n    }\n\n    _getViewEvents(params, callback, options) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/viewlist',\n            data: params,\n            success: (data) => callback(this.modifyEvent(data && data.items || []))\n        }, options);\n    }\n\n    reviewSearchEvents(params, callback, options) {\n        this._loadOnDifferYear(this._reviewSearchEvents, params, callback, options);\n    }\n\n    // members: \",,\"\n    _reviewSearchEvents(params, callback, options) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/reviewsearch',\n            data: params,\n            success: (data) => callback(this.modifyEvent(data && data.items || []))\n        }, options);\n    }\n\n    getOwnEvents(params, callback, options?: any) {\n        this._loadOnDifferYear(this._getOwnEvents, params, callback, options);\n    }\n\n    _getOwnEvents(params, callback, options) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'calbuilder/element/list',\n            data: params,\n            success: (data) => callback(this.modifyEvent(data && data.items || []))\n        }, options);\n    }\n\n    getListEvents(params: any, callback: any, options?: any): any {\n        let promises = [];\n        params.orgid = params.orgid || this.getOrgId();\n\n        // Load review event\n        this.loadRole(params.orgid, () => {\n            // My events\n            promises.push(new Promise((resolve) => {\n                let _options = $.extend({}, options);\n                _options.error = function () {\n                    resolve([]);\n                };\n                this.getOwnEvents(params, resolve, _options);\n            }));\n\n            if (this.isReviewer(params.orgid)) {\n                // Reviewer\n                promises.push(new Promise((resolve) => {\n                    let _options = $.extend({}, options);\n                    _options.error = function () {\n                        resolve([]);\n                    };\n                    this.getReviewEvents(params, resolve, _options);\n                }));\n\n            } else if (this.isViewer(params.orgid)) {\n                // Viewer\n                promises.push(new Promise((resolve) => {\n                    let _options = $.extend({}, options);\n                    _options.error = function () {\n                        resolve([]);\n                    };\n                    this.getViewEvents(params, resolve, _options);\n                }));\n\n            }\n\n            // Load all promises\n            Promise.all(promises).then( (values) => {\n                let events = [];\n                values.forEach((value) => events = events.concat(value || []));\n                events = this.removeEventDuplicate(events);\n                callback(this.modifyEvent(events));\n            });\n\n        }, options);\n\n    }\n\n    modifyEvent(events) {\n        if (!events)\n            return;\n        this.removeEventDuplicate(events);\n        events.forEach((item) => this.indexEvent(item));\n        this.sortEvents(events);\n        return events;\n    }\n\n    removeEventDuplicate(events) {\n        if (events.length > 1) {\n            for (let i = 1; i < events.length; i++) {\n                for (let j = i - 1; j >= 0; j--) {\n                    if (events[i].uuid === events[j].uuid && events[i].day === events[j].day) {\n                        events.splice(i, 1);\n                        --i;\n                        break;\n                    }\n                }\n            }\n        }\n        return events;\n    }\n\n    sortEvents(events) {\n        // sort by start date\n        this.sortEventStart(events);\n        this.sortEventPriority(events);\n        return events;\n    }\n\n    sortEventStart(events) {\n        this._sort(events, 'from');\n        return events;\n    }\n\n    sortEventPriority(events) {\n        // sort by priority on day\n        for (let i = 0; i < events.length; i++) {\n            let item = events[i];\n            item._order = Number(item._order) || 0;\n\n            if (item._order > 0) {\n                moveFirst(item);\n                i = events.indexOf(item);\n            }\n        }\n\n        function moveFirst(item) {\n            if (item._order !== 0) {\n                let index = events.indexOf(item);\n                if (index > 0) {\n                    let tmp = events[index - 1];\n                    if (item.day === tmp.day && (tmp._order === 0 || item._order < tmp._order)) {\n                        events[index] = tmp;\n                        events[index - 1] = item;\n                        moveFirst(item);\n                    }\n                }\n            }\n        }\n\n        return events;\n    }\n\n\n    _sort(arr, orderBy?: any) {\n        for (let i = 1; i < arr.length; i++) {\n            if (i === 0)\n                continue;\n\n            let item = arr[i],\n                prev = arr[i - 1];\n\n            if (item[orderBy] < prev[orderBy]) {\n                arr[i] = prev;\n                arr[i - 1] = item;\n                i -= 2;\n            }\n        }\n    }\n\n    // keywords: string[]\n    searchEventsByKeywords(events, keywords) {\n        if (keywords && keywords.length > 0) {\n            return events.filter((event) => {\n                for (let i = 0; i < keywords.length; i++) {\n                    if (event._index.indexOf(keywords[i]) < 0) {\n                        return false;\n                    }\n                }\n                return true;\n            });\n        }\n        return events.slice();\n    }\n\n    indexEvent(event) {\n        // Save event with link to get later\n        event.objectId = event.uuid + event.mode + event.day;\n        this._mapEvents[event.objectId] = event;\n        this._mapEvents[event.uuid] = event;\n\n        if (!event._indexed) {\n\n            this.indexEventMembers(event);\n\n            if (window['beforeIndexEvent']) {\n                window['beforeIndexEvent'](event);\n            }\n\n            event.subjectDisplay = this.formatTextDisplay(event.subject || '');\n            event.locationDisplay = this.formatTextDisplay(event.location || '');\n\n            this.indexRepeat(event);\n            this.indexEventAttribute(event);\n            this.indexEventDate(event);\n            this.indexEventSearch(event);\n            this.indexCustom(event);\n\n            event.category = event.category || '';\n            event.categoryIcon = CalCategoryIcon[event.category];\n\n            event.department = event.departID;\n\n            event._indexed = true;\n        }\n        return event;\n    }\n\n    indexEventMembers(event) {\n        let obj: any = {};\n\n        for (let k in CalAttendeeRole) {\n            obj[k] = [];\n        }\n\n        event.members = event.members || [];\n        event.attendees = [];\n\n        event.members.forEach((item) => {\n\n            item.name = this.attendeeDisplay(item);\n            item.value = this.attendeeValue(item);\n\n            // Type attendee\n            if (item.alias) {\n                item.type = CalAttendeeType.ALIAS;\n            } else if (item.username) {\n                item.type = CalAttendeeType.USER;\n            } else {\n                item.type = CalAttendeeType.ORGAN;\n            }\n\n            obj[item.role] = obj[item.role] || [];\n            obj[item.role].push(item);\n\n            if (item.role === CalAttendeeRole.CREATOR) {\n                event.creator = item.username;\n                event.fullname = item.fullname;\n                event.isCreator = this.usernameIsMe(event.creator);\n                event.creatorStr = event.fullname + '(' + event.creator + ')';\n            } else {\n                event.attendees.push(item);\n            }\n        });\n\n        event.chairmanStr = this._groupMember2String(obj.CHAIRMAN);\n        event.memberStr = this._groupMember2String(obj.MEMBER);\n\n        // Todo: test prepare str\n        event.prepareStr = this._groupMember2String(obj.PREPARER);\n        event.watcherStr = event.observerStr = this._groupMember2String(obj.OBSERVER);\n\n        event.membersDecode = obj;\n    }\n\n    _groupMember2String(members) {\n        let str = '';\n        let data = this.groupAttendeeByOrgan(members);\n        for (let k in data) {\n            let items = data[k];\n            let organ = items.filter((item) => item.type === CalAttendeeType.ORGAN)[0];\n            if (organ) {\n                str += '<b>' + organ.organName + '</b>: ';\n            }\n            // Todo: consider to use this.buildMemberShow\n            items.forEach((item) => {\n                if (item.type !== CalAttendeeType.ORGAN) {\n                    str += item.name + ', ';\n                }\n            });\n            str = str.slice(0, -2);\n            str += '<br>';\n        }\n        return str.slice(0, -4);\n    }\n\n    indexEventAttribute(event?: any) {\n        for (let k in event.attribute) {\n            event['_' + k] = event.attribute[k];\n        }\n        event._order = Number(event._order) || 0;\n\n        if (event._subType) {\n            event.type = event._subType;\n        }\n    }\n\n    initEvent(calEvent) {\n        calEvent = $.extend({}, calEvent);\n        this._initEventDate(calEvent);\n        calEvent.startTime = calEvent.from.format('H:i');\n        calEvent.toTime = calEvent.to.format('H:i');\n        return calEvent;\n    }\n\n    _initEventDate(event: CalEvent | any) {\n        if (event) {\n            let date;\n            if (event && event.uuid) {\n                date = new Date(event.year, 0, event.day);\n                if (date.getTime()) {\n                    event.from = new Date(date.getTime() + event.startTime * 60 * 1000);\n                    event.to = new Date(date.getTime() + event.toTime * 60 * 1000);\n                }\n            }\n            if (!date || !date.getTime()) {\n                date = new Date();\n                date.setHours(date.getHours() + 1, 0, 0, 0);\n                event.from = date;\n                date = new Date(date);\n                date.setHours(date.getHours() + 1);\n                event.to = date;\n            }\n        }\n    }\n\n    indexEventDate(event) {\n        this._initEventDate(event);\n\n        // all day event\n        event.allDay = event._allday === 'true';\n\n        event.timeStr = this.formatDateStr(event.from);\n        if (event.allDay) {\n            event.startTimeStr = event.toTimeStr = this.resources.allDay;\n            event.hourStr = this.resources.allDay;\n        } else {\n            event.startTimeStr = this.formatTimeStr(event.from);\n            event.toTimeStr = this.formatTimeStr(event.to);\n            event.hourStr = event.startTimeStr + ' - ' + event.toTimeStr;\n        }\n\n        event.timeStr += '; ' + event.hourStr;\n\n        event.start = event.from;\n        event.end = event.to;\n\n        // Time create and update\n        if (event.createTime) {\n            event.createDate = new Date(event.createTime);\n            event.createDateStr = this.formatDateTimeStr(event.createDate);\n\n        }\n        if (event.updateTime) {\n            event.updateDate = new Date(event.updateTime);\n            event.updateDateStr = this.formatDateTimeStr(event.updateDate);\n        }\n\n        let hourUpdated = new Date().getTime() - (event.updateTime || event.createTime);\n        hourUpdated /= (60 * 60 * 1000);\n        if (hourUpdated < 0) {\n            hourUpdated = 0;\n        }\n        if (hourUpdated <= this.TIME_NEW_UPDATE) {\n            event.recentUpdated = true;\n            event.lastUpdateStr = this.getTextForMinutes(hourUpdated * 60);\n        }\n    }\n\n    indexEventSearch(event) {\n\n        // Index data to search\n        event._index = '';\n        event._members = [];\n\n        if (event.subject) {\n            event._index = vnToLatin(event.subject.toLowerCase());\n        }\n\n        // Index location to search\n        if (event.location) {\n            event._index += ' ' + vnToLatin(event.location.toLowerCase());\n        }\n\n        for (let i = 0; i < event.members.length; i++) {\n            let member = event.members[i];\n            if (member.fullname)\n                event._index += ' ' + vnToLatin(member.fullname.toLowerCase());\n            if (member.username) {\n                event._index += ' ' + member.username.toLowerCase();\n\n                // attendee\n                if (member.role !== CalAttendeeRole.CREATOR) {\n                    event._members.push(member.username);\n                }\n            }\n        }\n\n        // Attachments\n        if (event.attachments) {\n            event.attachments.forEach((file) => {\n                file.orgid = event.firmUUID;\n            });\n        }\n    }\n\n    indexRepeat(event: any) {\n        //\"FREQ=WEEKLY;UNTIL=20170707;INTERVAL=1;BYDAY=MO\"\n        if (event.rrule) {\n            let obj: any = {};\n            event.rrule.split(';').forEach((item) => {\n                item = item.split('=');\n                if (item[0] === 'FREQ') {\n                    obj.type = obj.rrule = obj.rrmode = item[1];\n                } else if (item[0] === 'BYDAY') {\n                    obj.wkdays = item[1].split(',');\n                }\n            });\n            if (event.lstart) {\n                obj.lstart = new Date(event.lstart);\n            }\n            if (event.until) {\n                obj.until = new Date(event.until);\n            }\n            event.repeat = obj;\n        }\n    }\n\n    // Custom index\n    indexCustom(event) {\n\n    }\n\n    getEventStatus = (mode) => this.resources.statuses[mode];\n\n    isReviewer(orgid?: any) {\n        orgid = orgid || this.getOrgId();\n        return this._userRoles[orgid] && !!this._userRoles[orgid].reviewer;\n    }\n\n    isOwnReviewer(orgid?: any) {\n        orgid = orgid || this.getOrgId();\n        return this._userRoles[orgid] && !!this._userRoles[orgid].own_reviewer;\n    }\n\n    isViewer(orgid?: any): any {\n        orgid = orgid || this.getOrgId();\n        return this._userRoles[orgid] && !!this._userRoles[orgid].viewer;\n    }\n\n    getQueryParams(query?: any) {\n        let params = {};\n        query = query || location.search;\n        query.replace('?', '').split('&').forEach((item) => {\n            if (item) {\n                let equalIndex = item.indexOf('=');\n                if (equalIndex > -1)\n                    params[item.slice(0, equalIndex)] = item.slice(equalIndex + 1);\n            }\n        });\n        return params;\n    }\n\n    buildQueryString(params?: any) {\n        let query = '';\n        for (let k in params) {\n            query += k + '=' + encodeURIComponent(params[k]) + '&';\n        }\n        return query.slice(0, -1);\n    }\n\n    getUserAvatar(usercode, domain?: any) {\n        return AjaxAPI.getUrl('system/userprofile/photo', domain) +\n            '?usercode=' + usercode + '&thumbnail=50';\n    }\n\n    getPermissionOnEvent(event, callback: Function, currentOrganId?: any, options?: any) {\n        let mode = event.mode;\n        if (this.isOther(mode)) {\n            callback();\n            return;\n        }\n        if (!event.uuid) {\n            return callback({\n                save: true,\n                saveCreate: true\n            });\n        }\n\n        currentOrganId = currentOrganId || this.getOrgId() || event.firmUUID;\n\n        this.loadRole(currentOrganId, () => {\n\n            this.indexEvent(event);\n\n            let permissions;\n            const canReview = this.isReviewer(currentOrganId) ||\n                (this.isOwnReviewer(currentOrganId) && this.canOwnReviewEvent(event));\n            const canReviewUpdate = !this.isCreate(mode) && !this.isCancel(mode) && canReview;\n            if (event.firmUUID === currentOrganId) {\n                const isEditMyEvent = this.canUpdateOwnEvent(event);\n\n                if (event.type === CalSubType.PERSONAL && !this.getConfigValue('PERSONAL_CAN_PUBLISH')) {\n                    // Personal calendar\n                    permissions = {\n                        save: isEditMyEvent,\n                        delete: isEditMyEvent\n                    };\n                } else {\n\n                    permissions = {\n                        save: isEditMyEvent || canReviewUpdate,\n                        approve: canReview && (this.isSent(mode) || isEditMyEvent),\n                        reject: canReview && this.isSent(mode),\n                        send: isEditMyEvent && !canReview,\n                        revert: (this.isSent(mode) && event.isCreator) ||\n                            ((this.isCancel(mode) || this.isPublish(mode)) && canReview),\n                        cancel: canReview && this.isPublish(mode),\n                        delete: isEditMyEvent\n                    };\n                }\n\n            } else {\n                // External update attendees\n                permissions = {};\n                if (this.isPublish(event.mode) && this.hasFirmAttendee(event, currentOrganId) &&\n                        this.canExternalUpdateEvent(event, currentOrganId)) {\n                    permissions = {updateAttendee: true};\n                }\n            }\n            permissions.print = true;\n            permissions.exportInvitation = this.catIsInvitation(event.category) && event._templateId;\n\n            callback(permissions);\n        }, options);\n    }\n\n    canUpdateOwnEvent(event: CalEvent): boolean {\n        return event.isCreator && this.isCreate(event.mode);\n    }\n\n    canReviewEvent(event: CalEvent): boolean {\n        return this.isReviewer(event.firmUUID);\n    }\n\n    canOwnReviewEvent(event: CalEvent): boolean {\n        return this.isOwnReviewer(event.firmUUID) && event.isCreator;\n    }\n\n    canUpdateAttendee(event: CalEvent, ownOrganId: string) {\n        return this.isFirmEvent(event, ownOrganId) && (this.canUpdateOwnEvent(event) ||\n            this.canOwnReviewEvent(event) ||\n            this.canReviewEvent(event)) ;\n    }\n\n    canExternalUpdateEvent(event: CalEvent, organId: string): boolean {\n        return this.isPublish(event.mode) && !this.isFirmEvent(event, organId) && this.isReviewer(organId);\n    }\n\n    isFirmEvent(event: CalEvent, ownOrganId: string) {\n        return event.firmUUID === ownOrganId;\n    }\n\n    isCreate = (mode: number) => mode === CalMode.CREATE;\n\n    isPublish = (mode: number) => mode === CalMode.PUBLISH;\n\n    isSent = (mode: number) => mode === CalMode.SENT;\n\n    isCancel = (mode: number) => mode === CalMode.CANCEL;\n\n    isOther = (mode: number) => mode === CalMode.OTHER;\n\n    searchAnyAttendee(params, callback, options?: any) {\n        this.searchUserAsAttendee(params, (users) => {\n            this.searchOrganAsAttendee(params, (orgs) => {\n                orgs.forEach((org) => users.push(org));\n                callback(users);\n            });\n        }, options);\n    }\n\n    searchUserAsAttendee(params, callback, options?: any) {\n        let organId = params.orgid || this.getOrgId();\n        let organName = this.getOrgNameById(organId);\n        this.loadOrganMembers(organId, (members) => {\n            let keyword = params.keyword || '';\n            let limit = params.limit || -1;\n            let attendees = [];\n            keyword = vnToLatin(keyword).toLowerCase();\n            for (let i = 0; i < members.length; i++) {\n                let member = members[i];\n\n                if (!keyword || member._index.indexOf(keyword) > -1) {\n                    let attendee = this.memberToAttendee(member);\n                    attendee.organId = organId;\n                    attendee.organName = organName;\n                    attendees.push(attendee);\n\n                    if (limit > 0 && attendees.length >= limit) {\n                        break;\n                    }\n                }\n            }\n            callback(attendees);\n        }, options);\n    }\n\n    searchOrganAsAttendee(params, callback, options?: any) {\n        this.loadOrgByKeyword(params, (organs) => {\n            callback(organs.map((organ) => this.organToAttendee(organ)));\n        }, options);\n    }\n\n    insertPrefixAttendee(fullname: string) {\n        if (this.getConfigValue('PREFIX_ATTENDEE_NAME')) {\n            return this.getConfigValue('PREFIX_ATTENDEE_NAME') + fullname;\n        }\n        return fullname;\n    }\n\n    memberToAttendee(member): CalAttendee {\n        return {\n            username: member.username,\n            fullname: member.fullname,\n            display: this.insertPrefixAttendee(member.fullname),\n            type: CalAttendeeType.USER\n        }\n    }\n\n    organToAttendee(organ): CalAttendee {\n        return {\n            organId: organ.firmUUID,\n            organName: organ.firmName,\n            type: CalAttendeeType.ORGAN\n        }\n    }\n\n    aliasToAttendee(alias: string, organId: string): CalAttendee {\n        organId = organId || this.getOrgId();\n        return {\n            alias: alias,\n            organId: organId,\n            organName: this.getOrgNameById(organId),\n            type: CalAttendeeType.ALIAS\n        }\n    }\n\n    // Search user and orgs to select when create calendar\n    loadAttendeeByName(params, callback, options?: any): any {\n        if (!params || !params.keyword)\n            return callback([]);\n\n        // Limit user search\n        params.limit = params.limit || 5;\n\n        this.loadUserByKeyword(params, (users) => {\n            this.loadOrgByKeyword(params, (orgs) => {\n                callback(users.concat(orgs));\n            });\n        }, options);\n    }\n\n    loadUserByKeyword(params, callback, options?: any) {\n        // Load all users and search on client\n        this.searchAttendee({\n            orgid: params.orgid\n        }, (members) => {\n            let users = [];\n            let keyword = vnToLatin(params.keyword.toLowerCase());\n            for (let i = 0; i < members.length; i++) {\n                let user = members[i];\n                if (user._index.indexOf(keyword) > -1) {\n                    users.push({\n                        name: user.fullname,\n                        value: user.username,\n                        type: CalAttendeeType.USER,\n                        member: user\n                    });\n\n                    if (users.length >= params.limit) {\n                        break;\n                    }\n                }\n            }\n            callback(users);\n        }, options);\n    }\n\n    loadOrgByKeyword(params, callback, options?: any) {\n        let data = [];\n        this._loadOrgans((orgs) => {\n            // Filter orgs match\n            let key = vnToLatin(params.keyword).toLowerCase();\n            for (let i = 0; i < orgs.length; i++) {\n                let item = orgs[i];\n                if (item._index.indexOf(key) > -1) {\n                    data.push(item);\n                    if (data.length >= params.limit)\n                        break;\n                }\n            }\n            callback(data);\n        }, options);\n    }\n\n    getFileUrl(item, domain?: string, event?: CalEvent) {\n        if (!item)\n            return '';\n        let orgid = item.orgid || this.getOrgId();\n        let _role = this._userRoles[orgid];\n        let url;\n        if (_role && _role.isAuth && this.isMyOrg(orgid)) {\n            url = 'calbuilder/binary/view';\n        } else if (this.hasFirmAttendee(event, this.getOrgId())) {\n            orgid = this.getOrgId();\n            url = 'calbuilder/binary/view';\n        } else {\n            url = 'calbuilder/mainboard/binary/view';\n        }\n        return this.getUrlByOrgId(url, orgid, domain) + '?fileID=' + item.uuid + '&element=' + item.folder + '&orgid=' + orgid;\n    }\n\n    getFileViewUrl(item, domain?: string, event?: CalEvent) {\n        let url = this.getFileUrl(item, domain, event);\n        if (item.file && item.file.slice(-3).toLowerCase() === \"pdf\") {\n            url += '&view=pdf&t=' + new Date().getTime();\n        }\n        return url;\n    }\n\n    hasFirmAttendee(event: CalEvent, organId: string) {\n        if (event && organId) {\n            for (let i = 0; i < event.members.length; i++) {\n                let member = event.members[i];\n                if (member.type === CalAttendeeType.ORGAN && member.organId === organId) {\n                    return true;\n                }\n            }\n        }\n    }\n\n    getOrgByUid(uuid: string) {\n        for (let i = 0; i < this._organs.length; i++) {\n            if (this._organs[i].uuid === uuid) {\n                return this._organs[i];\n            }\n        }\n    }\n\n    getOrgById(orgId: string) {\n        for (let i = 0; i < this._organs.length; i++) {\n            if (this._organs[i].firmUUID === orgId) {\n                return this._organs[i];\n            }\n        }\n    }\n\n    getOrgNameById(orgId: string) {\n        let organ = this.getOrgById(orgId);\n        return organ && organ.firmName || '';\n    }\n\n    getOrgByPrefix(prefix: string) {\n        for (let i = 0; i < this._organs.length; i++) {\n            if (this._organs[i].firmPrefix === prefix) {\n                return this._organs[i];\n            }\n        }\n    }\n\n    getUrlByOrgId(url, orgid, domain?: any) {\n        let item = this.getOrgById(orgid);\n        return AjaxAPI.getUrl(url, domain, item && item.firmPrefix);\n    }\n\n    loadRole(orgid, callback, options?: any) {\n\n        orgid = orgid || this.getOrgId();\n\n        if (this._userRoles[orgid]) {\n            return callback(this._userRoles[orgid]);\n        }\n\n        this.sendRequest({\n            url: this.roleUrl,\n            data: {orgid: orgid},\n            success: (data) => {\n                try {\n                    data = JSON.parse(data);\n                    if (data.isAuth) {\n                        this._userRoles[orgid] = data;\n                        iNet.usercode = data.usercode;\n                    }\n                    callback(data);\n                } catch (e) {\n                    callback({});\n                }\n            },\n            error: () => {\n                callback({});\n            }\n        }, options, true);\n    }\n\n    loadRoles(organIds, callback, options?: any) {\n        let promises = [];\n        organIds.forEach((organId) => {\n            promises.push(new Promise((resolve => {\n                this.loadRole(organId, resolve, options);\n            })));\n        });\n        Promise.all(promises).then((values) => callback(values));\n    }\n\n    generateEventWeekView(events, date?: any, firstDay?: any) {\n        let segEvents = [];\n        let startWeek = DateUtils.getDateStartWeek(date, firstDay);\n        for (let i = 0; i < 7; i++) {\n            let dayOfYear = DateUtils.dayOfYear(startWeek);\n            segEvents.push(this.generateEventView(\n                events.filter((event) => {\n                    return event.day === dayOfYear;\n                }),\n                startWeek\n            ));\n            startWeek.setDate(startWeek.getDate() + 1);\n        }\n        return segEvents;\n    }\n\n    getLastUpdateSegEvents(segEvents) {\n        let lastUpdate;\n        segEvents.forEach((segEvent) => {\n            segEvent.items.forEach((event) => {\n                let lastUpdateEvent = event.updateDate || event.createDate;\n                if (!lastUpdate || lastUpdate < lastUpdateEvent) {\n                    lastUpdate = lastUpdateEvent;\n                }\n            });\n        });\n        return lastUpdate;\n    }\n\n    generateEventView(events, date) {\n        date = new Date(date);\n        return {\n            day: DateUtils.dayOfYear(date),\n            display: this.getDisplayByDay(date.getDay()),\n            dayStr: this.formatDateStr(date),\n            isToday: DateUtils.dateIsToday(date),\n            date: date,\n            items: events\n        }\n    }\n\n    getDisplayByDay(day?: any) {\n        return this.resources.days[day];\n    }\n\n    buildMembers(members: any, role?: any) {\n        members.forEach((member) => member.role = role || CalAttendeeRole.MEMBER);\n        return members;\n    }\n\n    groupAttendeeByOrgan(attendees: CalAttendee[]) {\n        let data = {};\n        attendees.forEach(function (attendee) {\n            data[attendee.organId] = data[attendee.organId] || [];\n            data[attendee.organId].push(attendee);\n        });\n        return data;\n    }\n\n    groupAttendeeByOrganRole(event: CalEvent,\n                             attendees: CalAttendee[],\n                             ownOrganId: string,\n                             callback: Function,\n                             options?: any) {\n        if (attendees.length < 1) {\n            return callback([]);\n        }\n\n        let groupByOrgans = this.groupAttendeeByOrgan(attendees);\n        let organIds = Object.keys(groupByOrgans);\n        if (organIds.indexOf(ownOrganId) < 0) {\n            organIds.push(ownOrganId);\n        }\n        this.loadRoles(organIds, () => {\n            let internalUpdate = !event.uuid || this.canUpdateAttendee(event, ownOrganId);\n            let data = [];\n\n            Object.keys(groupByOrgans).forEach((organId) => {\n                let isMyOrgan = organId === ownOrganId;\n                let externalUpdate = isMyOrgan && this.canExternalUpdateEvent(event, organId);\n                let attendees = groupByOrgans[organId];\n                data.push({\n                    organId: organId,\n                    organName: this.getOrgNameById(organId),\n                    internalUpdate: internalUpdate,\n                    externalUpdate: externalUpdate,\n                    updateAttendee: internalUpdate || externalUpdate,\n                    attendees: attendees,\n                    canRemoveAttendee: function (attendee) {\n                        return internalUpdate || (externalUpdate && attendee.type !== CalAttendeeType.ORGAN);\n                    },\n                    canUpdateState: (attendee) => {\n                        return attendee.readTime !== undefined && isMyOrgan && this.attendeeIsMe(attendee);\n                    }\n                });\n            });\n            callback(data);\n        }, options);\n    }\n\n    buildMemberStr(item?: any) {\n        item.members = item.members || [];\n        return item.members.map((item) => item.name).join(',');\n    }\n\n    buildMemberShow(members) {\n        return (members || []).map((item) => item.name).join(';');\n    }\n\n    modifyDataUpdate(data, event?: any) {\n        let attendeeJson = [];\n        // Remove all members and rebuild\n        if (data.attendee) {\n\n            let newAttendees = data.attendee.filter(function (attendee) {\n                return attendee.readTime === undefined;\n            });\n\n            if (event && event.uuid) {\n                let remainAttendees = data.attendee.filter(function (attendee) {\n                    return attendee.readTime !== undefined;\n                });\n                event.members.forEach((member) => {\n                    if (member.role !== CalAttendeeRole.CREATOR) {\n                        if (remainAttendees.indexOf(member) < 0) {\n                            attendeeJson.push(this.attendeeRemoveJson(member));\n                        }\n                    }\n                });\n            }\n\n            newAttendees.forEach((attendee) => attendeeJson.push(this.attendeeAddJson(attendee)));\n        }\n\n        // Secure text update\n        if (data.subject) {\n            data.subject = this.formatTextUpdate(data.subject);\n        }\n        if (data.location) {\n            data.location = this.formatTextUpdate(data.location);\n        }\n\n        data.attendee = JSON.stringify(attendeeJson);\n\n        // Personal calendar\n        if (!this.getConfigValue('PERSONAL_CAN_PUBLISH') && data.type === CalSubType.PERSONAL) {\n            data.mode = CalMode.CREATE;\n        }\n\n        if (data.type === CalSubType.MEET_PEOPLE || data.type === CalSubType.PERSONAL) {\n            data._subType = data.type;\n            data.type = data.type.split(';')[0];\n        } else {\n            data._subType = '';\n        }\n\n        return data;\n    }\n\n    attendeeAddJson(attendee: CalAttendee) {\n        let obj: any = {\n            organId: attendee.organId,\n            organName: attendee.organName,\n            role: attendee.role || CalAttendeeRole.MEMBER\n        };\n        switch (attendee.type) {\n            case CalAttendeeType.USER:\n                obj.members = attendee.username + ':' + attendee.fullname;\n                obj.display = attendee.display;\n                break;\n            case CalAttendeeType.ORGAN:\n                if (this.getConfigValue('EVENT_BETWEEN_UNIT')) {\n                    obj.firms = attendee.organId + ':' + attendee.organName;\n                }\n                break;\n            default:\n                obj.alias = attendee.alias || attendee.organName;\n        }\n        return obj;\n    }\n\n    attendeeRemoveJson(attendee: CalAttendee) {\n        let obj: any = {\n            organId: attendee.organId\n        };\n        switch (attendee.type) {\n            case CalAttendeeType.USER:\n                obj.members = attendee.username + ':REMOVE';\n                break;\n            case CalAttendeeType.ORGAN:\n                obj.firms = attendee.organId + ':REMOVE';\n                break;\n            default:\n                obj.alias = attendee.alias + ':REMOVE';\n        }\n        return obj;\n    }\n\n    _convertOrg(data) {\n        data = data || [];\n        for (let i = 0; i < data.length; i++) {\n            let item = data[i];\n            item.firmName = item.orgName || item.name;\n            item.firmPrefix = item.uriPrefix || item.prefix;\n            item.firmUUID = item.organId || item.organiId || '';\n            this.indexOrgSearch(item);\n        }\n\n        // sort by name\n        data.sort((a, b) => {\n            return a.firmName.localeCompare(b.firmName);\n        });\n\n        return data;\n    }\n\n    viewEventOnModal(objectId) {\n        if (this._mapEvents[objectId]) {\n            iNet.plugins.ready((plugins) => {\n                if (plugins.xcalendar) {\n                    plugins.xcalendar.openView(this._mapEvents[objectId]);\n                }\n            });\n        }\n    }\n\n    // Save and get event\n    getEventByObjectId(objectId) {\n        return this._mapEvents[objectId];\n    }\n\n    getTextForMinutes(minutes?: any) {\n        minutes = parseInt(minutes) || 1;\n        if (minutes >= 60) {\n            return Math.round(minutes / 60) + ' ' + this.resources.hour;\n        } else {\n            return minutes + ' ' + this.resources.minute;\n        }\n    }\n\n    groupEventBySession(events) {\n        let data = {\n            allday: [],\n            morning: [],\n            afternoon: [],\n            evening: []\n        };\n        events.forEach((item) => {\n            if (item.allDay) {\n                data.allday.push(item);\n            } else if (item.from.getHours() < 12) {\n                data.morning.push(item);\n            } else if (item.from.getHours() < 18) {\n                data.afternoon.push(item);\n            } else {\n                data.evening.push(item);\n            }\n        });\n\n        for (let k in data) {\n            this.sortEvents(data[k]);\n        }\n\n        return data;\n    }\n\n    groupEventByPerson(events, persons, date) {\n        let data = {\n            persons: [],\n            segEvents: this.generateEventWeekView(events, date)\n        };\n        let eventByDays = data.segEvents.map(function (segEvent) {\n            return segEvent.items;\n        });\n\n        persons.forEach((person) => {\n            let eventDays = eventByDays.map((events) =>\n                events.filter(event => this.memberIsAttendee(event, person.name)));\n            data.persons.push({\n                person: person,\n                eventDays: eventDays\n            });\n        });\n\n        return data;\n    }\n\n    groupEventByLeaders(events: CalEvent[], organId: string, callback: Function, options?: any) {\n        this.loadLeaders(organId, (leaders) => {\n            let dataLeaders = [];\n            let otherEvents = [];\n            leaders.forEach((leader) => dataLeaders.push({\n                username: leader.name,\n                fullname: leader.value,\n                events: []\n            }));\n            events.forEach((event) => {\n                let isFound;\n                for (let i = 0; i < dataLeaders.length; i++) {\n                    let item = dataLeaders[i];\n                    if (this.memberIsAttendee(event, item.username)) {\n                        isFound = true;\n                        item.events.push(event);\n                    }\n                }\n                if (!isFound) {\n                    otherEvents.push(event);\n                }\n            });\n            callback(dataLeaders, otherEvents);\n        }, options, true);\n    }\n\n    meIsCreator(event: CalEvent): boolean {\n        for (let i = event.members.length - 1; i >= 0; i--) {\n            if (event.members[i].role === CalAttendeeRole.CREATOR && this.attendeeIsMe(event.members[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    attendeeIsMe(attendde: CalAttendee): boolean {\n        return this.usernameIsMe(attendde.username);\n    }\n\n    attendeeDisplay(attendde: CalAttendee) {\n        return attendde.alias || attendde.display || attendde.fullname || attendde.username || attendde.organName;\n    }\n\n    attendeeValue(attendde: CalAttendee) {\n        return attendde.alias || attendde.username || attendde.organId;\n    }\n\n    formatTextDisplay(text: string) {\n        let display = this.formatTextUpdate(text);\n\n        // break line\n        display = display.replace(/\\n/g, '<br>');\n\n        return display;\n    }\n\n    formatTextUpdate(text: string) {\n        let $fragment = $('<div>').html(text);\n        $fragment.find('style,script').remove();\n        return $fragment.html();\n    }\n\n    memberIsAttendee(event: CalEvent, member: string) {\n        // for (let i = 0; i < event.members.length; i++) {\n        //     if (event.members[i].role !== CalAttendeeRole.CREATOR && event.members[i].username === member) {\n        //         return true;\n        //     }\n        // }\n        for (let i = 0; i < event.members.length; i++) {\n            if (event.members[i].username === member) {\n                return true;\n            }\n        }\n    }\n\n    getAttendeeByUsername(event: CalEvent, username: string) {\n        for (let i = 0; i < event.members.length; i++) {\n            if (event.members[i].username === username) {\n                return event.members[i];\n            }\n        }\n    }\n\n    getAttendeeIsMe(event: CalEvent): CalAttendee {\n        for (let i = 0; i < event.members.length; i++) {\n            let member = event.members[i];\n            if (member.role !== CalAttendeeRole.CREATOR && this.usernameIsMe(member.username)) {\n                return member;\n            }\n        }\n    }\n\n    eventIsViewed(event: CalEvent) {\n        let attendee = this.getAttendeeIsMe(event);\n        return !attendee || attendee.readTime;\n    }\n\n    usernameIsMe(username: String): boolean {\n        return username === iNet.usercode;\n    }\n\n    sendRequest(data: any, options?: any, cacheResponse?: any) {\n        let option = this._buildAjaxOptions(data, options);\n        if (cacheResponse) {\n            let keyCache = option.url;\n            if (option.data && Object.keys(option.data).length > 0) {\n                keyCache += JSON.stringify(option.data);\n            }\n            let dataCached = this.cacheDataTemp(keyCache);\n            if (dataCached) {\n                return option.success(dataCached);\n            }\n            this.addQueue(keyCache, (resolve) => {\n                let _option = $.extend({}, option);\n                _option.success = (data) => {\n                    this.cacheDataTemp(keyCache, data);\n                    resolve(data);\n                };\n                _option.error = (error) => {\n                    resolve(null, error);\n                };\n                AjaxAPI.sendRequest(_option);\n            }, (data, error) => {\n                if (error) {\n                    option.error && option.error(error);\n                } else {\n                    option.success && option.success(data);\n                }\n            });\n        } else {\n            return AjaxAPI.sendRequest(option);\n        }\n    }\n\n    postForm(data: any, options?: any) {\n        return AjaxAPI.postForm(this._buildAjaxOptions(data, options));\n    }\n\n    _buildAjaxOptions(data, options?: any) {\n\n        let option = $.extend({}, data, options);\n        let orgid = option.data && option.data.orgid || this.getOrgId();\n        let org = this.getOrgById(orgid);\n        let isLocalFirm = org && org.firmPrefix === iNet.path.slice(1);\n        let isUseOrgId = !option.removeOrgId && (isLocalFirm || option.useOrgId);\n        if (isUseOrgId) {\n            option.data = option.data || {};\n            option.data.orgid = orgid;\n        } else if (option.data) {\n            delete option.data.orgid;\n        }\n        option.url = this.getUrlByOrgId(option.url, orgid, option.domain);\n        return option;\n    }\n\n    _getOrganOnInit() {\n        let organ;\n\n        let params = this.getQueryParams();\n\n        // Get by url query\n        if (params['orgid']) {\n            this.setOrgId(params['orgid']);\n            organ = this.getOrgById(params['orgid']);\n        }\n\n        // get organ by firm prefix\n        if (!organ && iNet.firmPrefix !== 'smartcloud') {\n            organ = this.getOrgByPrefix(iNet.firmPrefix);\n        }\n\n        // Get organ active recently\n        if (!organ) {\n            let organId = this.getOrgId() || iNet.organId;\n            organ = this.getOrgById(organId);\n        }\n\n        // Get organ local\n        if (!organ) {\n            organ = this.getOrgByPrefix(iNet.path.slice(1));\n        }\n\n        // get organ first\n        if (!organ) {\n            organ = this._myOrgans && this._myOrgans[0] || this._organs && this._organs[0];\n        }\n\n        if (organ) {\n            this.setOrgId(organ.firmUUID);\n        }\n\n        return organ;\n    }\n\n    groupEventByCar(cars, events) {\n        let data = [];\n        cars.forEach(function (car) {\n            data.push({\n                car: car,\n                events: []\n            });\n        });\n\n        events.forEach(function (event) {\n            let carData = data[0];\n            if (event._carUUID) {\n                for (let i = 0; i < data.length; i++) {\n                    if (data[i].car.uuid === event._carUUID) {\n                        carData = data[i];\n                    }\n                }\n            }\n            carData.events.push(event);\n        });\n\n        return data;\n    }\n\n    filterMeetPeopleEvents(events) {\n        return events.filter(function (event) {\n            return event._subType === CalSubType.MEET_PEOPLE;\n        });\n    }\n\n    _loadOnDifferYear(executor, params, callback, options) {\n        if (!params.from || !params.to || params.from <= params.to) {\n            executor.apply(this, [params, callback, options]);\n        } else {\n            // Load in differ year\n            let promises = [];\n            let endOfYear = new Date(params.year + 1, 0);\n            endOfYear.setTime(endOfYear.getTime() - 1);\n\n            let params1 = $.extend({}, params);\n            let options1 = $.extend({}, options);\n            params1.to = DateUtils.dayOfYear(endOfYear);\n            promises.push(new Promise((resolve) => {\n                executor.apply(this, [params1, resolve, options1]);\n            }));\n\n            let params2 = $.extend({}, params);\n            let options2 = $.extend({}, options);\n            params2.year = params.year + 1;\n            params2.from = 1;\n            promises.push(new Promise((resolve) => {\n                executor.apply(this, [params2, resolve, options2]);\n            }));\n\n            Promise.all(promises).then((values) => {\n                let events = [].concat.apply([], values);\n                this.removeEventDuplicate(events);\n                callback(events);\n            });\n        }\n    }\n\n    loadMonthEvents(params, date, callback, options?: any) {\n        let from, to;\n        date = new Date(date);\n        // Start month\n        date.setDate(1);\n\n        // Start date of week\n        from = DateUtils.getDateStartWeek(date);\n\n        // End month\n        date.setMonth(date.getMonth() + 1);\n        date.setTime(date.getTime() - 1);\n\n        // End date of week\n        to = DateUtils.getDateEndWeek(date);\n\n        params = $.extend({}, params, this.getRangeParams(from, to));\n\n        if (this.isMyOrg(params.orgid)) {\n            this.getListEvents(params, callback, options);\n        } else {\n            this.loadPublishEvents(params, callback, options);\n        }\n    }\n\n    getExportUrl(calEvent, domain) {\n        if (calEvent && calEvent.uuid && calEvent._templateId) {\n            return this.getUrlByOrgId('calbuilder/invitation/export', calEvent.firmUUID, domain) +\n                '?templateID=' + calEvent._templateId +\n                '&element=' + calEvent.uuid;\n        }\n    }\n\n    getWeekParams(date) {\n        let weekRange = DateUtils.getWeekRange(date);\n        return this.getRangeParams(weekRange.startWeek, weekRange.endWeek);\n    }\n\n    getRangeParams(from, to) {\n        return {\n            year: from.getFullYear(),\n            from: DateUtils.dayOfYear(from),\n            to: DateUtils.dayOfYear(to)\n        }\n    }\n\n    dateEqualWeekParams(date, weekParams) {\n        let params = this.getWeekParams(date);\n        return date && weekParams && params.year === weekParams.year &&\n            params.from === weekParams.from &&\n            params.to === weekParams.to;\n    }\n\n    eventIsOnRange(event: CalEvent, params?: any) {\n        return (params.startTime >= event.startTime && params.startTime < event.toTime) ||\n            (params.toTime <= event.toTime && params.toTime > event.startTime) ||\n            (params.startTime <= event.startTime && params.toTime >= event.toTime);\n    }\n\n    verifyDuplicateEvents(params, callback: Function, options?: any) {\n        let duplicateEvents = [];\n        this.loadPublishEvents({\n            year: params.year,\n            day: params.day,\n            orgid: params.orgid || this.getOrgId()\n        }, (events) => {\n            let allEvents = [];\n\n            if (this.catIsCar(params.category)) {\n                events = events.filter((event) => this.catIsCar(event.category));\n            } else {\n                events = events.filter((event) => !this.catIsCar(event.category));\n            }\n\n            const detector = (username) => {\n                let obj: any = {\n                    username: username,\n                    events: []\n                };\n\n                events.forEach((event) => {\n                    let member = this.getAttendeeByUsername(event, username);\n                    if (member) {\n                        obj.fullname = member.fullname;\n                        obj.events.push(event);\n                        allEvents.push(event);\n                    }\n                });\n\n                if (obj.events.length > 0) {\n                    duplicateEvents.push(obj);\n                }\n            };\n            events = events.filter((event) => {\n                return event.mode === CalMode.PUBLISH && event.uuid !== params.element &&\n                    this.eventIsOnRange(event, params);\n            });\n            if (params.attendee) {\n                params.attendee.forEach((attendee) => detector(attendee.username));\n            }\n\n            // Todo: creator is attendee\n            let isExist = false;\n            for (let i = 0; i < duplicateEvents.length; i++) {\n                if (duplicateEvents[i].username === iNet.usercode) {\n                    isExist = true;\n                    break;\n                }\n            }\n            if (!isExist) {\n                detector(iNet.usercode);\n            }\n            duplicateEvents['allEvents'] = this.removeEventDuplicate(allEvents);\n            callback(duplicateEvents);\n        }, options);\n    }\n\n    needVerifyDuplicate(params, event) {\n        var isEventPublished = event.mode === CalMode.PUBLISH;\n        var actionPublish = !isEventPublished && Number(params.mode) === CalMode.PUBLISH;\n        var isTimeChanged = event.uuid && (\n            (params.startTime && event.startTime !== params.startTime) ||\n            (params.toTime && event.toTime !== params.toTime) ||\n            (params.day && event.day !== params.day)\n        ) && isEventPublished;\n        return actionPublish || isTimeChanged;\n    }\n\n    subjectDisplayWithMaxLength(event) {\n        // Subject max length\n        var maxLength = Number(this.getConfigValue('SUBJECT_DISPLAY_MAX_LENGTH')) || 0;\n        // Display view more\n        if (maxLength > 0 && maxLength < event.subject.length) {\n            var subjectDisplay = event.subject.substr(0, maxLength);\n            subjectDisplay = this.formatTextDisplay(subjectDisplay);\n            subjectDisplay += '...';\n            return this.formatTextDisplay(subjectDisplay);\n        }\n        return event.subjectDisplay;\n    }\n\n    // SubFirm Dictionary Utils\n    dictCreate(data: DictionaryData, callback: Function, options?: any) {\n        return this.sendRequest({\n            type: 'post',\n            url: 'subfirm/dictionary/create',\n            data: data,\n            success: callback\n        }, options);\n    }\n\n    dictUpdate(data: DictionaryData, callback: Function, options?: any) {\n        data.dictID = data.dictID || data.uuid;\n        return this.sendRequest({\n            type: 'post',\n            url: 'subfirm/dictionary/update',\n            data: data,\n            success: callback\n        }, options);\n    }\n\n    dictRemove(data: DictionaryData, callback: Function, options?: any) {\n        data.dictID = data.dictID || data.uuid;\n        return this.sendRequest({\n            type: 'post',\n            url: 'subfirm/dictionary/remove',\n            data: data,\n            success: callback\n        }, options);\n    }\n\n    dictList(params, callback: Function, options?: any, cacheResponse?: boolean) {\n        // reference: required\n        return this.sendRequest({\n            type: 'post',\n            url: 'subfirm/dictionary/list',\n            data: params,\n            success: (data) => callback(data && data.items || []),\n            error: () => callback([])\n        }, options, cacheResponse);\n    }\n\n    // Leader\n    loadLeaders(organId: string, callback: Function, options?: any, cacheResponse?: boolean) {\n        let params = {\n            orgid: organId || this.getOrgId(),\n            reference: LEADER_REFERENCE\n        };\n        this.dictList(params, function (leaders) {\n            leaders.sort(function (a, b) {\n                return b.order - a.order;\n            });\n            callback(leaders);\n        }, options, cacheResponse);\n    }\n\n    leaderCreateOrUpdate(data: DictionaryData, callback: Function, options?: any) {\n        if (!data.uuid) {\n            data.reference = LEADER_REFERENCE;\n            this.dictCreate(data, callback, options);\n        } else {\n            this.dictUpdate(data, callback, options);\n        }\n    }\n\n    leaderRemove(data: DictionaryData, callback: Function, options?: any) {\n        this.dictRemove(data, callback, options);\n    }\n}\n","export const LEADER_REFERENCE = 'CAL_BUILDER_LEADER';\n","import {CalBuilder} from \"./CalBuilder\";\nexport let xCalendar = new CalBuilder();\nxCalendar._applyConfig();","import {\n    AfterViewInit,\n    Component,\n    ElementRef,\n    EventEmitter,\n    Input,\n    OnDestroy,\n    Output,\n    ViewChild\n} from '@angular/core';\nimport {CalendarService} from \"../calendar.service\";\nimport {CalEvent} from \"../utils/model/CalEvent\";\nimport {ModalDirective} from \"ngx-bootstrap\";\ndeclare let $:any;\n\n@Component({\n    selector: 'calendar-dialog-delete',\n    templateUrl: './dialog-delete.component.html',\n    styleUrls: ['./dialog-delete.component.css']\n})\nexport class CalendarDialogDelete implements AfterViewInit, OnDestroy{\n    @Input() calEvent: CalEvent;\n    @Output() onDelete = new EventEmitter();\n    @ViewChild(ModalDirective) confirmDialog: ModalDirective;\n    @ViewChild('dialogDelete') dialogDelete: ElementRef;\n\n    dialogTitle: string = 'Lá»ch cÃ´ng tÃ¡c';\n    dialogContent: string = '';\n\n    private _$dialogDelete;\n\n    constructor(private calendarService: CalendarService) {}\n\n    ngAfterViewInit(): void {\n        this._initDialogDelete();\n    }\n\n    ngOnDestroy(): void {\n        this._destroyDialogDelete();\n    }\n\n    hide() {\n        this.confirmDialog.hide();\n    }\n\n    delete() {\n        this.calendarService.removeEvent({\n            element: this.calEvent.uuid,\n            orgid: this.calEvent.firmUUID\n        }, () => {\n            this.hide();\n            this.onDelete.emit();\n        });\n    }\n\n    show() {\n        this.dialogContent = 'Báº¡n cÃ³ Äá»ng Ã½ xÃ³a sá»± kiá»n <b>\"' + this.calEvent.subject + '\"</b> khÃ´ng?';\n        this.confirmDialog.show();\n    }\n\n    private _initDialogDelete() {\n        this._$dialogDelete = $(this.dialogDelete.nativeElement).hide();\n\n        // Click outside to close\n        this.hide = this.hide.bind(this);\n        document.body.addEventListener('click', this.hide);\n\n        // Prevent close\n        this._$dialogDelete.on('click', (e) => e.stopPropagation());\n\n        // Append modal to body\n        $(document.body).append(this._$dialogDelete);\n    }\n\n    private _destroyDialogDelete() {\n        document.body.removeEventListener('click', this.hide);\n        this._$dialogDelete.remove();\n    }\n}\n","import {CalRepeat} from \"./utils/model/CalEvent\";\nimport * as moment_ from \"moment\";\nconst moment = moment_;\nmoment.locale('vi');\n\nexport class CalendarUtils {\n    static repeatTypes = [\n        {label: 'HÃ ng ngÃ y', value: 'DAILY'},\n        {label: 'HÃ ng tuáº§n', value: 'WEEKLY'},\n        {label: 'HÃ ng thÃ¡ng', value: 'MONTHLY'}\n    ];\n\n    static weekDays = [\n        {label: 'T2', title: 'Thá»© hai', value: 'MO'},\n        {label: 'T3', title: 'Thá»© ba', value: 'TU'},\n        {label: 'T4', title: 'Thá»© tÆ°', value: 'WE'},\n        {label: 'T5', title: 'Thá»© nÄm', value: 'TH'},\n        {label: 'T6', title: 'Thá»© sÃ¡u', value: 'FR'},\n        {label: 'T7', title: 'Thá»© báº£y', value: 'SA'},\n        {label: 'CN', title: 'Chá»§ nháº­t', value: 'SU'}\n    ];\n\n    static getRepeatText(data: CalRepeat): string {\n        let display = '';\n        for (let i = 0; i < CalendarUtils.repeatTypes.length; i++) {\n            if (CalendarUtils.repeatTypes[i].value === data.rrmode) {\n                display = CalendarUtils.repeatTypes[i].label;\n            }\n        }\n        if (data.rrmode === 'WEEKLY') {\n            display +=  ' - ' + CalendarUtils._getTextRepeatWeek(data.wkdays);\n        }\n        return display;\n    }\n\n    static _getTextRepeatWeek(wkdays: string[]): string {\n        if (wkdays) {\n            return CalendarUtils.weekDays.filter(day => {\n                return wkdays.indexOf(day.value) > -1;\n            }).map(day => {\n                return day.title;\n            }).join(', ');\n        }\n        return '';\n    }\n\n    static displayDay(date: Date) {\n        let str = moment(date).format('dddd, d MMMM');\n        if (new Date().getFullYear() !== date.getFullYear()) {\n            str += ' nÄm ' + date.getFullYear();\n        }\n        return str.slice(0, 1).toUpperCase() + str.slice(1);\n    }\n\n    static displayDate(date: Date) {\n        return moment(date).format('[NgÃ y] LL');\n    }\n\n    static displayWeek(date: Date) {\n        return moment(date).format('[Tuáº§n] w [nÄm] Y');\n    }\n\n    static displayMonth(date: Date) {\n        return moment(date).format('[ThÃ¡ng] MM [nÄm] Y');\n    }\n\n    static displayTime(date: Date) {\n        return moment(date).format('HH:mm');\n    }\n\n    static computePosByPoint(element: HTMLElement, e: MouseEvent, padding?: number) {\n        let bounds = element.getBoundingClientRect();\n        let halfHeight = bounds.height / 2;\n        let halfWidth = bounds.width / 2;\n        let direction;\n        let pos: any = {\n            left: e.x - halfWidth,\n            top: e.y - halfHeight\n        };\n\n        padding = padding || 5;\n\n        // Position out of width\n        if (innerWidth < pos.left + bounds.width + padding) {\n            pos.left = innerWidth - padding - bounds.width;\n        } else if (pos.left < padding) {\n            pos.left = padding;\n        }\n\n        // Position out of height\n        if (innerHeight < pos.top + bounds.height + padding) {\n            pos.top = innerHeight - padding - bounds.height;\n        } else if (pos.top < padding) {\n            pos.top = padding;\n        }\n\n        // Detect best position\n        let deltaTop = e.pageY;\n        let deltaBottom = innerHeight - e.pageX;\n        let deltaLeft = e.pageX;\n        let deltaRight = innerWidth - e.pageY;\n\n        let deltaMax = Math.max(deltaTop, deltaRight, deltaBottom, deltaLeft);\n\n        switch (deltaMax) {\n            case deltaTop:\n                direction = 'top';\n                pos.top -= halfHeight + padding;\n                break;\n            case deltaBottom:\n                direction = 'bottom';\n                pos.top += halfHeight + padding;\n                break;\n            case deltaLeft:\n                direction = 'left';\n                pos.left -= halfWidth + padding;\n                break;\n            case deltaRight:\n                direction = 'right';\n                pos.left += halfWidth + padding;\n                break;\n        }\n\n        return {\n            direction: direction,\n            position: pos,\n            elementBounds: bounds\n        };\n    }\n\n    static computePosByTargetEl(element: HTMLElement, target: HTMLElement, jsEvent: MouseEvent, padding?: number) {\n        let elementBounds = element.getBoundingClientRect();\n        let targetBounds = target.getBoundingClientRect();\n        let pos: any = {};\n        let direction: any = {};\n        padding = padding || 10;\n\n        let deltaRect = {\n            top: targetBounds.top,\n            right: innerWidth - targetBounds.right,\n            bottom: innerHeight - targetBounds.bottom,\n            left: targetBounds.left\n        };\n        let maxX = Math.max(deltaRect.left, deltaRect.right);\n        let maxY = Math.max(deltaRect.top, deltaRect.bottom);\n\n        // Get click point when left and right not enough modal\n        if (elementBounds.width > maxX) {\n            deltaRect.left = jsEvent.pageX;\n            deltaRect.right = innerWidth - jsEvent.pageX;\n        }\n\n        // Get click point when top and bottom not enough modal\n        if (elementBounds.height > maxY) {\n            deltaRect.top = jsEvent.pageY;\n            deltaRect.bottom = innerHeight - jsEvent.pageY;\n        }\n\n        // X direction\n        if (deltaRect.left > deltaRect.right) {\n            direction.left = true;\n            pos.left = deltaRect.left - elementBounds.width;\n        } else {\n            direction.right = true;\n            pos.left = innerWidth - deltaRect.right;\n        }\n\n        // Y direction\n        if (deltaRect.top > deltaRect.bottom) {\n            direction.top = true;\n            pos.top = deltaRect.top - elementBounds.height;\n        } else {\n            direction.bottom = true;\n            pos.top = innerHeight - deltaRect.bottom;\n        }\n\n        // Best dimension to display\n        if (maxX * elementBounds.width > maxY * elementBounds.height) {\n            // By x\n            let targetHeight = innerHeight - deltaRect.bottom - deltaRect.top;\n            if (direction.top) {\n                pos.top += targetHeight;\n            } else {\n                pos.top -= targetHeight;\n            }\n        } else {\n            // By y\n            let targetWidth = innerWidth - deltaRect.left - deltaRect.right;\n            if (direction.left) {\n                pos.left += targetWidth;\n            } else {\n                pos.left -= targetWidth;\n            }\n        }\n\n        // Out of width\n        if (pos.left < padding) {\n            pos.left = padding;\n        } else if (pos.left + elementBounds.width > innerWidth) {\n            pos.left = innerWidth - elementBounds.width - padding;\n        }\n\n        // Out of height\n        if (pos.top < padding) {\n            pos.top = padding;\n        } else if (pos.top + elementBounds.height > innerHeight) {\n            pos.top = innerHeight - elementBounds.height - padding;\n        }\n\n        // compute with document scroll\n        pos.top += document.scrollingElement.scrollTop;\n        pos.left += document.scrollingElement.scrollLeft;\n\n        return pos;\n    }\n}\n","import {CalEvent} from \"../utils/model/CalEvent\";\nimport {CalAttendee} from \"../utils/model/CalAttendee\";\nimport {HtmlUtils} from \"inet-core\";\nimport {CalendarUtils} from \"../CalendarUtils\";\ndeclare let iNet: any;\n\nexport class CalendarEvent {\n    subject: string;\n    summary: string;\n    repeatText: string = '';\n    timeDisplay: string = '';\n    event: CalEvent;\n    myAttendee: CalAttendee;\n\n    constructor(event: CalEvent) {\n        this.event = event;\n        this.subject = HtmlUtils.formatHtmlDisplay(event.subject);\n        this.summary = HtmlUtils.formatHtmlDisplay(event.summary);\n        if(event.members) {\n            this.myAttendee = event.members.find(item => {\n                return item.role !== 'CREATOR' && item.username === iNet.username;\n            });\n        }\n        if (event.repeat) {\n            this.repeatText = CalendarUtils.getRepeatText(event.repeat);\n        } else {\n            this.repeatText = '';\n        }\n        this.timeDisplay = CalendarUtils.displayDay(event.start);\n        if (event.attribute._allday !== 'true') {\n            this.timeDisplay += ` â ${CalendarUtils.displayTime(event.start)} - ${CalendarUtils.displayTime(event.end)}`;\n        }\n    }\n}","import {AfterViewInit, Component, ElementRef, EventEmitter, OnDestroy, Output, ViewChild} from '@angular/core';\nimport {Router} from '@angular/router';\nimport {CalEvent} from \"../utils/model/CalEvent\";\nimport {CalendarDialogDelete} from \"../dialog-delete/dialog-delete.component\";\nimport {CalendarEvent} from \"../model/CalendarEvent\";\nimport {CalendarUtils} from \"../CalendarUtils\";\ndeclare let $:any;\n\n@Component({\n    templateUrl: './dialog-view.component.html',\n    styleUrls: ['./dialog-view.component.css']\n})\nexport class CalendarDialogViewComponent implements AfterViewInit, OnDestroy {\n    @Output() onChange = new EventEmitter();\n    @ViewChild('modalView') modalView: ElementRef;\n    @ViewChild('dialogRemove') viewDeleteModal: CalendarDialogDelete;\n    calendarEvent: CalendarEvent;\n    calEvent: CalEvent;\n    maxHeight: number;\n    titleOverlay: boolean;\n    private _showModal: boolean;\n    private _targetEl: HTMLElement;\n    private _jsEvent: MouseEvent;\n    private _timer;\n    private _scrollTimer;\n    private _$modalView;\n    private _onChange: Function;\n\n    constructor(private router: Router) {}\n\n    ngAfterViewInit() {\n        this._initModalView();\n        this._addScrollUpdatePos();\n    }\n\n    ngOnDestroy() {\n        this._destroyModalView();\n        this._removeScrollUpdatePos();\n    }\n\n    editEvent() {\n        this.hide();\n        this.router.navigate(['/calendar/event', this.calendarEvent.event.uuid || '']);\n    }\n\n    changeEvent() {\n        this.hide();\n        this.onChange.emit();\n        this._onChange();\n    }\n\n    viewEvent(event: CalEvent, jsEvent: MouseEvent, target: HTMLElement, onChange: Function) {\n        this._onChange = onChange;\n        this.calendarEvent = new CalendarEvent(event);\n        this.calEvent = event;\n        this._targetEl = target;\n        this._jsEvent = jsEvent;\n        this._syncBodyHeight();\n        this._preventScrolling();\n        jsEvent.stopPropagation();\n        setTimeout(() => this._openModal(jsEvent, target), 100)\n    }\n\n    hide() {\n        this._showModal = false;\n        this._$modalView.hide();\n        this._$modalView.css('opacity', 0);\n    }\n\n    show() {\n        this._showModal = true;\n        this._$modalView.show();\n    }\n\n    removeEvent() {\n        this.viewDeleteModal.show();\n    }\n\n    private _preventScrolling() {\n        $(document.scrollingElement).css('overflow', 'hidden');\n        clearTimeout(this._scrollTimer);\n        this._scrollTimer = setTimeout(() => {\n            $(document.scrollingElement).css('overflow', '');\n        }, 600);\n    }\n\n    private _syncBodyHeight() {\n        this.maxHeight = innerHeight - 150;\n    }\n\n    private _initModalView() {\n        this._$modalView = $(this.modalView.nativeElement).hide();\n\n        // Click outside to close\n        this.hide = this.hide.bind(this);\n        document.body.addEventListener('click', this.hide);\n\n        // Prevent close\n        this._$modalView.on('click', (e) => e.stopPropagation());\n\n        // Append modal to body\n        $(document.body).append(this._$modalView);\n    }\n\n    private _destroyModalView() {\n        document.body.removeEventListener('click', this.hide);\n        this._$modalView.remove();\n    }\n\n    private _addScrollUpdatePos() {\n        this._scrollUpdatePos = this._scrollUpdatePos.bind(this);\n        document.addEventListener('scroll', this._scrollUpdatePos, true);\n    }\n\n    private _removeScrollUpdatePos() {\n        document.removeEventListener('scroll', this._scrollUpdatePos);\n    }\n\n    private _scrollUpdatePos() {\n        // Delay update pos for performance\n        if (this._showModal && this._jsEvent && this._targetEl) {\n            clearTimeout(this._timer);\n            this._timer = setTimeout(() => this._openModal(this._jsEvent, this._targetEl), 100);\n        }\n    }\n\n    private _openModal(jsEvent, target: HTMLElement) {\n        // Show to get real size\n        this.show();\n\n        let pos = CalendarUtils.computePosByTargetEl(this.modalView.nativeElement, target, jsEvent);\n\n        let transformCss = 'translate3d(' + pos.left + 'px,' + pos.top + 'px,0)';\n        // Use transform translate3d to boot performance\n        this._$modalView.css({\n            '-webkit-transition-duration': '300ms',\n            'transition-duration': '300ms',\n            'opacity': '1',\n            '-webkit-transform': transformCss,\n            'transform': transformCss,\n        });\n    }\n}\n","import {Injectable, ComponentFactoryResolver, Injector, ApplicationRef, ComponentRef} from '@angular/core';\nimport {SuggestionService} from 'inet-core';\nimport {xCalendar} from \"./utils/xCalendar\";\nimport {CalEvent} from \"./utils/model/CalEvent\";\nimport * as moment_ from \"moment\";\nimport { CalendarDialogViewComponent } from './dialog-view/dialog-view.component';\nconst moment = moment_;\ndeclare let iNet: any;\nmoment.locale('vi');\n\n@Injectable()\nexport class CalendarService {\n    myOrg = {\n        organId: iNet.organId,\n        orgName: iNet.orgName,\n        firmPrefix: iNet.firmPrefix\n    };\n    locationKeySuggestion = 'xcalendar_location';\n\n    private _ready: boolean;\n    private _fns: Function[] = [];\n    private _viewModalRef: ComponentRef<CalendarDialogViewComponent>;\n\n    constructor(\n        private suggestService: SuggestionService,\n        private componentFactoryResolver: ComponentFactoryResolver,\n        private injector: Injector,\n        private appRef: ApplicationRef,\n    ) {\n        xCalendar.roleUrl = 'unicorn/page/calendar/role';\n        xCalendar.setOrgId(this.myOrg.organId);\n        xCalendar.ready(() => {\n            xCalendar.loadRole(this.myOrg.organId, (role) => {\n                xCalendar.setOrgId(this.myOrg.organId);\n                this._ready = true;\n                this._triggerReady();\n            });\n        });\n    }\n\n    ready(callback: Function) {\n        if (this._ready) {\n            callback();\n        } else {\n            this._fns.push(callback);\n        }\n    }\n\n    private _triggerReady() {\n        this._fns.forEach(fn => fn());\n        this._fns = [];\n    }\n\n    searchLocation(content: string, callback: Function) {\n        if (!content) {\n            return;\n        }\n        let params = {\n            keyword: this.locationKeySuggestion,\n            content: content\n        };\n        this.suggestService.loadSuggestion(params, callback);\n    }\n\n    saveLocation(content: string, callback: Function) {\n        if (!content) {\n            return;\n        }\n        let params = {\n            keyword: this.locationKeySuggestion,\n            content: content\n        };\n        this.suggestService.saveSuggestion(params, callback);\n    }\n\n    createEvent(params, callback) {\n        this.ready(() => xCalendar.create(params, callback));\n    }\n\n    updateEvent(params, callback) {\n        this.ready(() => xCalendar.update(params, callback));\n    }\n\n    removeEvent(params, callback) {\n        this.ready(() => xCalendar.remove(params, callback));\n    }\n\n    attendeeSearch(params, callback) {\n        this.ready(() => xCalendar.loadUserByKeyword(params, callback));\n    }\n\n    loadAttendees(callback) {\n        this.ready(() => xCalendar.searchAttendee({}, callback));\n    }\n\n    loadEvents(params, callback) {\n        this.ready(() => xCalendar.getListEvents(params, callback));\n    }\n\n    loadMonthEvents(date, callback) {\n        this.ready(() => xCalendar.loadMonthEvents({}, date, callback));\n    }\n\n    loadEvent(params, callback) {\n        this.ready(() => xCalendar.loadEvent(params, callback));\n    }\n\n    deleteAttachment(params, callback: Function) {\n        this.ready(() => xCalendar.deleteAttachment(params,callback));\n    }\n\n    viewEvent(event: CalEvent, jsEvent: MouseEvent, target: HTMLElement, onChange: Function) {\n        this._initViewModal();\n        this._viewModalRef.instance.viewEvent(event, jsEvent, target, onChange);\n    }\n\n    hideViewModal() {\n        if (this._viewModalRef) {\n            this._viewModalRef.instance.hide();\n        }\n    }\n\n    private _initViewModal() {\n        if (this._viewModalRef) {\n            return;\n        }\n        const componentFactory = this.componentFactoryResolver.resolveComponentFactory(CalendarDialogViewComponent);\n        this._viewModalRef = componentFactory.create(this.injector);\n        this.appRef.attachView(this._viewModalRef.hostView);\n    }\n}\n","import {Component, Output, EventEmitter} from '@angular/core';\nimport {CalendarService} from \"../calendar.service\";\nimport {CalEvent} from \"../utils/model/CalEvent\";\nimport {DateUtils} from \"../utils/common/DateUtils\";\n\n@Component({\n    selector: 'calendar-widget-today',\n    templateUrl: './calendar-today.component.html',\n    styleUrls: ['./calendar-today.component.css']\n})\nexport class CalendarTodayComponent {\n    @Output() onChange = new EventEmitter<any>();\n    events: CalEvent[] = [];\n    colors = [\n        // '#438EB9',\n        '#007bff',\n        '#3CA54A',\n        '#FF9800',\n        '#EF5B49',\n        '#77901B',\n        '#7D5392',\n        '#808080'\n    ];\n\n    private _date: Date = new Date();\n\n    constructor(private calendarService: CalendarService) {\n        this.calendarService.ready(() => this.loadTodayEvents());\n    }\n\n    loadTodayEvents() {\n        if (!this._date) {\n            return;\n        }\n        this.calendarService.loadEvents({\n            day: DateUtils.dayOfYear(this._date),\n            year: this._date.getFullYear()\n        }, (events) => {\n            events.forEach((e) => this._initEventStatus(e));\n            this.events = events.slice(0, 3); // Maximum 3 events\n        });\n    }\n\n    onViewEvent(event: CalEvent, jsEvent: MouseEvent, targetEl: HTMLElement) {\n        this.calendarService.viewEvent(event, jsEvent, targetEl, () => {\n            this.loadTodayEvents();\n            this.onChange.emit(true);\n        });\n    }\n\n    private _initEventStatus(event) {\n        let now = new Date();\n\n        event.progressing = event.start < now && event.end > now;\n        event.ended = event.end < now;\n        event.pending = event.start > now;\n\n        if (event.progressing) {\n            event.statusText = 'Äang diá»n ra';\n            event.statusColor = this.colors[0];\n        } else if (event.pending) {\n            event.statusText = 'ChÆ°a diá»n ra';\n            event.statusColor = this.colors[5];\n        } else {\n            event.statusText = 'Káº¿t thÃºc';\n            event.statusColor = this.colors[6];\n        }\n\n        event.style = {\n            'background-color': this.colors[event.mode]\n        };\n    }\n}\n","import {Component, OnDestroy, ViewChild, AfterViewInit, OnInit} from '@angular/core';\nimport {ActivatedRoute, NavigationEnd, Router} from '@angular/router';\nimport {CalendarService} from './calendar.service';\nimport {NotificationService, ResourceLoaderService} from 'inet-core';\nimport {xCalendar} from \"./utils/xCalendar\";\nimport {DateUtils} from \"./utils/common/DateUtils\";\nimport { Calendar } from '@fullcalendar/core';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport timeGridPlugin from '@fullcalendar/timegrid';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport {EventInput} from \"@fullcalendar/core/structs/event\";\nimport {OptionsInput, ViewOptionsInput} from \"@fullcalendar/core/types/input-types\";\nimport * as moment_ from \"moment\";\nimport {filter} from \"rxjs/operators\";\nimport {CalendarTodayComponent} from \"./calendar-today/calendar-today.component\";\nimport {CalendarUtils} from \"./CalendarUtils\";\nconst moment = moment_;\n\n@Component({\n    selector: 'inet-calendar',\n    templateUrl: './calendar.component.html',\n    styleUrls: ['./calendar.component.css'],\n})\nexport class CalendarComponent implements AfterViewInit, OnDestroy {\n    @ViewChild('calendarRef') calendarRef;\n    @ViewChild(CalendarTodayComponent) calendarWidget: CalendarTodayComponent;\n    viewTypes: CalendarViewMode[] = [\n        new CalendarViewMode('NgÃ y', CalendarMode.timeGridDay, {\n            columnHeaderText: (date: Date) => {\n                let str = moment(date).format('dddd, D/M/Y');\n                return str.slice(0, 1).toUpperCase() + str.slice(1);\n            },\n            titleFormat: () => CalendarUtils.displayDate(this.calendar.getDate())\n        }),\n        new CalendarViewMode('Tuáº§n', CalendarMode.timeGridWeek, {\n            titleFormat: () => CalendarUtils.displayWeek(this.calendar.getDate())\n        }),\n        new CalendarViewMode('ThÃ¡ng', CalendarMode.dayGridMonth, {\n            titleFormat: () => CalendarUtils.displayMonth(this.calendar.getDate())\n        })\n    ];\n    defaultMode: CalendarMode = CalendarMode.dayGridMonth;\n    viewTitle: string;\n    calendarConfig: OptionsInput = {\n        plugins: [dayGridPlugin, timeGridPlugin, interactionPlugin],\n        themeSystem: 'bootstrap',\n        firstDay: 1,\n        locale: 'vi',\n        allDaySlot: true,\n        allDayText: 'Cáº£ ngÃ y',\n        header: false,\n        nowIndicator: true,\n        navLinks: true, // can click day/week names to navigate views\n        editable: true,\n        droppable: true,\n        eventLimit: true, // allow \"more\" link when too many events\n        selectable: true,\n        selectMirror: true,\n        weekends: true,\n        views: {},\n        businessHours: {\n            daysOfWeek: [ 1, 2, 3, 4, 5],  // Monday - Friday\n            startTime: '00:01',\n            endTime: '23:59'\n        },\n        eventDrop: (arg) => this._updateEventTime(arg),\n        eventResize: (arg) => this._updateEventTime(arg),\n        select: (arg) => this._selectRange(arg),\n        eventClick: (arg) => this._viewEvent(arg),\n        eventDragStart: () => this._hideViewDialog(),\n        datesRender: () => this._calendarChange(),\n        height: function () {\n            return innerHeight - 59;\n        }\n    };\n    calendar: Calendar;\n    isToday: boolean;\n    private _eventTimer: any;\n    private _modeCache: string = '__calendar_mode__';\n    private _routerObserver;\n    private _events: any[] = [];\n    private _currentRange: {start: Date, end: Date};\n    constructor(\n        private calendarService: CalendarService,\n        private route: ActivatedRoute,\n        private router: Router,\n        private resourceLoader: ResourceLoaderService,\n        private notify: NotificationService\n    ) {\n        // Apply cache config\n        Object.assign(this.calendarConfig, this._getDataView());\n\n        // Merge view config\n        this.viewTypes.forEach((view) => {\n            if (view.options) {\n                this.calendarConfig.views[view.value] = view.options;\n            }\n        });\n\n        // Use locale\n        moment.locale(this.calendarConfig.locale.toString());\n    }\n\n    ngAfterViewInit() {\n        this._init();\n        this._hideViewDialog();\n    }\n\n    ngOnDestroy() {\n        this.calendar.destroy();\n        if (this._routerObserver) {\n            this._routerObserver.unsubscribe();\n        }\n    }\n\n    private _init() {\n        this.calendar = new Calendar(this.calendarRef.nativeElement, this.calendarConfig);\n        this.calendar.render();\n\n        // Change date view\n        this._routerObserver = this.router.events.pipe(filter(event => event instanceof NavigationEnd))\n            .subscribe((event: NavigationEnd) => this._onNavigated(event));\n    }\n\n    private _updateEventTime(args) {\n        let event;\n        if (args.oldEvent) {\n            event = this._events[Number(args.oldEvent.id)];\n        } else {\n            event = this._events[Number(args.event.id)];\n        }\n        if(event.mode !== 1){\n            let toTime;\n            if (args.event.allDay) {\n                toTime = 23 * 60 + 59;\n            } else {\n                toTime = args.event.end.getHours() * 60 + args.event.end.getMinutes();\n            }\n            let params = {\n                element: event.uuid,\n                year: args.event.start.getFullYear(),\n                day: DateUtils.dayOfYear(args.event.start),\n                startTime: args.event.start.getHours() * 60 + args.event.start.getMinutes(),\n                toTime: toTime,\n                _allday: args.event.allDay\n            };\n            if (event.repeat) {\n                Object.assign(params, event.repeat);\n            }\n            this.calendarService.updateEvent(params, (data, err) => {\n                if (!data) {\n                    this.notify.showMessage('Cáº­p nháº­t lá»ch khÃ´ng thÃ nh cÃ´ng: ' + err.status, 'error');\n                    args.revert();\n                    return;\n                }\n                this.reloadEvents();\n            });\n        } else {\n            // Can't change event\n            args.revert();\n        }\n    }\n\n    createEvent() {\n        let date = new Date();\n        date.setHours(date.getHours() + 1, 0);\n        this._createEvent(date, new Date(date.getTime() + 60 * 60 * 1000));\n    }\n\n    private _loadEvents(forceChange: boolean = false) {\n        this._hideViewDialog();\n        clearTimeout(this._eventTimer);\n        this._eventTimer = setTimeout(() => {\n            this._loadRangeEvents(forceChange);\n        }, 500);\n    }\n\n    private _createEvent(start: Date, end: Date, allDay: boolean = false) {\n        const dataBase64 = window.btoa(JSON.stringify({\n            start: start.valueOf(),\n            end: end.valueOf(),\n            attribute: {\n                allday: allDay + ''\n            }\n        }));\n        this.router.navigate(['/calendar/create', dataBase64]);\n        this._hideViewDialog();\n    }\n\n    private _selectRange(info) {\n        this._createEvent(info.start, info.end, info.start.getTime() === (info.end.getTime() - 24 * 60 * 60 * 1000));\n    }\n\n    private _calendarChange() {\n        if (this.calendar.view.type === CalendarMode.dayGridDay) {\n            this.calendar.changeView(CalendarMode.timeGridDay);\n            // Trigger change\n            setTimeout(() => this._calendarChange());\n            return;\n        }\n        setTimeout(() => {\n            this._updateInfo();\n            this._loadEvents();\n        });\n    }\n\n    private _updateInfo() {\n        this.viewTitle = this.calendar.view.title;\n        this.viewTypes.forEach((view) => view.active = view.value === this.calendar.view.type);\n        this._checkIsToday();\n        this._updateViewParams();\n    }\n\n    private _checkIsToday() {\n        const range = {\n            start: this.calendar.view.activeStart,\n            end: this.calendar.view.activeEnd,\n        };\n        this.isToday = this._dateInRange(new Date(), range);\n    }\n\n    private _loadRangeEvents(forceChange?: boolean){\n        if (forceChange ||this._outOfRange()) {\n            this._currentRange = this._getRange();\n            this.calendarService.loadEvents(xCalendar.getRangeParams(this._currentRange.start, this._currentRange.end),\n                (events) => this._renderEvents(events || []));\n            this.calendar.removeAllEventSources();\n        }\n    }\n\n    // Range view default is 6 week\n    private _getRange() {\n        let start = new Date(this.calendar.getDate());\n        let end: Date;\n        start.setDate(1);\n        start.setHours(0, 0, 0, 0);\n        while (start.getDay() !== this.calendarConfig.firstDay) {\n            start.setDate(start.getDate() - 1);\n        }\n        end = new Date(start.getTime() + 6 * 7 * 24 * 60 * 60 * 1000);\n        return {\n            start: start,\n            end: end\n        };\n    }\n\n    private _outOfRange(): boolean {\n        if (!this._currentRange) {\n            return true;\n        }\n        return !(this._dateInRange(this.calendar.view.currentStart) && this._dateInRange(this.calendar.view.currentEnd));\n    }\n\n    private _dateInRange(date: Date, range?: {start: Date, end: Date}) {\n        range = range || this._currentRange;\n        return date >= range.start && date <= range.end;\n    }\n\n    private _renderEvents(events){\n        this._events = events;\n        let eventInputs = events.map((event, index) => {\n            let eventInput: EventInput = {\n                id: index,\n                uuid: event.uuid,\n                allDay: event.allDay,\n                title: event.subject,\n                start: event.start,\n                end: event.end,\n            };\n            if (event.end < new Date()) {\n                // Event on the past\n                eventInput.textColor = '#999';\n                eventInput.color = '#ddd';\n            } else if (event.isCreator) {\n                // Owner event\n                eventInput.textColor = '#fff';\n                eventInput.color = '#4da0d8';\n            } else {\n                // Other event\n                eventInput.textColor = '#333';\n                eventInput.color = '#99ed96';\n            }\n            return eventInput;\n        });\n        this._addEventSource(eventInputs);\n    }\n\n    private _viewEvent(args) {\n        let event = this._events[Number(args.event.id)];\n        this.calendarService.viewEvent(event, args.jsEvent, args.jsEvent.currentTarget, () => this.reloadEvents());\n    }\n\n    private _addEventSource(events) {\n        this.calendar.addEventSource({\n            events: events\n        });\n    }\n\n    private _onNavigated(event: NavigationEnd) {\n        const viewData = this._getDataView();\n        this.calendar.changeView(viewData.defaultView, viewData.defaultDate);\n    }\n\n    changeView(type) {\n        this.calendar.changeView(type.value);\n    }\n\n    onPrev() {\n        this.calendar.prev();\n    }\n\n    onNext() {\n        this.calendar.next();\n    }\n\n    onToday() {\n        this.calendar.changeView(CalendarMode.timeGridDay, new Date());\n    }\n\n    private _getCalendarMode(mode: CalendarMode | string) {\n        for (let i = 0; i < this.viewTypes.length; i++) {\n            if (this.viewTypes[i].value === mode) {\n                return this.viewTypes[i];\n            }\n        }\n    }\n\n    private _updateViewParams() {\n        let params = [\n            this.calendar.view.type,\n            moment(this.calendar.getDate()).format('YYYY-M-D')\n        ];\n        this.router.navigate(['/calendar/v/' + params.join('/')]);\n    }\n\n    private _getDataView() {\n        let segments = this.route.snapshot.url;\n        let modeView = this._cacheModeView();\n        let date: Date;\n        if (segments.length > 1) {\n            modeView = segments[0].path;\n            date = new Date(segments[1].path);\n        }\n        if (!date || !date.getTime()) {\n            date = new Date();\n        }\n        if (!this._getCalendarMode(modeView)) {\n            modeView = this._getCalendarMode(this.defaultMode).value;\n        }\n        this._cacheModeView(modeView);\n        return {\n            defaultView: modeView,\n            defaultDate: date,\n        };\n    }\n\n    private _cacheModeView(modeView?: string) {\n        if (modeView === undefined) {\n            return localStorage.getItem(this._modeCache);\n        } else {\n            localStorage.setItem(this._modeCache, modeView);\n        }\n    }\n\n    reloadEvents() {\n        this._hideViewDialog();\n        this._loadEvents(true);\n        this.calendarWidget.loadTodayEvents();\n    }\n\n    private _hideViewDialog() {\n        this.calendarService.hideViewModal();\n    }\n}\n\nexport class CalendarViewMode {\n    name: string;\n    value: CalendarMode;\n    options: ViewOptionsInput;\n    active: boolean = false;\n    constructor(name: string, value: CalendarMode, options?: ViewOptionsInput) {\n        this.name = name;\n        this.value = value;\n        this.options = options;\n    }\n}\n\nexport enum CalendarMode {\n    dayGridDay = 'dayGridDay',\n    timeGridDay = 'timeGridDay',\n    timeGridWeek = 'timeGridWeek',\n    dayGridMonth = 'dayGridMonth'\n}","import {AfterViewInit, Component, ElementRef, EventEmitter, OnDestroy, Output, ViewChild} from '@angular/core';\nimport { CalendarService } from '../calendar.service';\nimport {CalRepeat} from \"../utils/model/CalEvent\";\nimport {CalendarUtils} from \"../CalendarUtils\";\ndeclare let $:any;\n\n@Component({\n  selector: 'calendar-repeat-modal',\n  templateUrl: './dialog-repeat.component.html',\n  styleUrls: ['./dialog-repeat.component.css']\n})\nexport class CalendarDialogRepeatComponent implements AfterViewInit, OnDestroy{\n  @Output() onRepeat = new EventEmitter<CalRepeat>();\n  @ViewChild('repeatModal') repeatModal: ElementRef;\n  @ViewChild('repeatStart') repeatStart;\n  @ViewChild('repeatUntil') repeatUntil;\n  start: any;\n  until: any;\n  rrmode: any;\n  repeatTypes: any[];\n  weekDays: any[];\n  data: any = {};\n  $modal: any;\n  dateFormat: string = 'DD/MM/YYYY';\n\n  constructor(\n    private calendarService: CalendarService,\n  ) {\n    this.repeatTypes = CalendarUtils.repeatTypes;\n    this.weekDays = CalendarUtils.weekDays;\n  }\n\n  ngAfterViewInit() {\n    this.$modal = $(this.repeatModal.nativeElement);\n    document.body.appendChild(this.repeatModal.nativeElement);\n  }\n\n  ngOnDestroy() {\n    if (this.$modal.is(':visible')) {\n      this.$modal.modal('hide').on('hidden.bs.modal', function () {\n        $(this).remove();\n      });\n    } else {\n      this.$modal.remove();\n    }\n  }\n\n  openRepeat(data: any) {\n    this.data = data || {};\n    this.initData();\n    this.$modal.modal('show');\n  }\n\n  saveRepeat() {\n    this.onRepeat.emit(this.getRepeatData());\n  }\n\n  changeWeekDay(item) {\n    item.checked = !item.checked;\n    if (this.getWeekDayChecked().length < 1) {\n      item.checked = true;\n    }\n  }\n\n  changeDate() {\n    if (!this.start || !this.start.getTime()) {\n      this.start = new Date();\n    }\n    if (!this.until || !this.until.getTime() || this.start >= this.until) {\n      this.until = new Date(this.start.getFullYear(), this.start.getMonth(), this.start.getDate());\n      this.until.setMonth(this.until.getMonth() + 1);\n    }\n  }\n\n  getRepeatData(): CalRepeat {\n    const params = {\n      rrmode: this.rrmode,\n      lstart: this.start.getTime(),\n      until: this.until.getTime(),\n      wkdays: []\n    };\n\n    if (params.rrmode == 'WEEKLY') {\n\n      // this.weekDays.forEach(item => {\n      //   if (item.checked) {\n      //     params.wkdays += item.value + ',';\n      //   }\n      // });\n      // params.wkdays = params.wkdays.slice(0, -1);\n        params.wkdays = this.getWeekDayChecked().map(item => item.value);\n    }\n\n    return params;\n  }\n\n  getWeekDayChecked() {\n    return this.weekDays.filter(item => {\n      return item.checked;\n    });\n  }\n\n  private initData() {\n    this.rrmode = this.data.rrmode || 'DAILY';\n    this.start = new Date(this.data.lstart);\n    this.until = new Date(this.data.until);\n    this.changeDate();\n\n    if (this.data.wkdays) {\n      this.weekDays.forEach(item => {\n        if (this.data.wkdays.indexOf(item.value) > -1) {\n          item.checked = true;\n        }\n      });\n    } else {\n      this.weekDays[(this.start.getDay() + 6) % 7].checked = true;\n    }\n  }\n}\n","import {Component, EventEmitter, Input, OnInit, Output, TemplateRef} from '@angular/core';\n\n@Component({\n    selector: 'file-list',\n    templateUrl: './file-list.component.html',\n    styleUrls: ['./file-list.component.css']\n})\nexport class FileListComponent implements OnInit {\n    @Input() fileEl: HTMLInputElement;\n    @Input() files: FileListItem[] = [];\n    @Input() removable: boolean = true;\n    @Input() template: TemplateRef<any>;\n\n    @Output() onClick = new EventEmitter<any>();\n    @Output() onRemove = new EventEmitter<FileListItem>();\n\n    ngOnInit(): void {\n        this._initFileEl();\n    }\n\n    clickFile(file: FileListItem, event) {\n        this.onClick.emit({file, event});\n    }\n\n    removeFile(file: FileListItem) {\n        const index = this.files.indexOf(file);\n        if (index > -1) {\n            this.files.splice(index, 1);\n            this.onRemove.emit(file);\n        }\n    }\n\n    addFiles(files: FileList | File[]) {\n        // Read as base64 if image\n        for (let i  = 0; i < files.length; i++) {\n            let file = files[i];\n            if (this._fileIsImage(file)) {\n                file['image'] = true;\n                this._readImageBase64(file);\n            }\n            this.files.push(file);\n        }\n    }\n\n    private _initFileEl() {\n        if (this.fileEl) {\n            this.fileEl.addEventListener('change', (e) => {\n                const files = this.fileEl.files;\n                if (files.length > 0) {\n                    // Read as base64 if image\n                    this.addFiles(files);\n\n                    // Reset file\n                    this.fileEl.value = '';\n                }\n            });\n        }\n    }\n\n    private _readImageBase64(file) {\n        const reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = function() {\n            file.url = reader.result;\n        };\n    }\n\n    private _fileIsImage(file: FileListItem) {\n        return file.type && file.type.indexOf('image') > -1;\n    }\n}\n\nexport interface FileListItem extends File {\n    id?: string;\n    url?: string;\n    image?: boolean;\n}\n","import {Component, Input, OnChanges, OnDestroy, SimpleChanges, TemplateRef, ViewChild} from '@angular/core';\nimport {xCalendar} from \"../utils/xCalendar\";\nimport {CalEvent} from \"../utils/model/CalEvent\";\nimport {CalAttachment} from \"../utils/model/CalAttachment\";\nimport {CalendarService} from \"../calendar.service\";\nimport {BsModalRef, BsModalService} from \"ngx-bootstrap\";\nimport {FileListComponent} from \"../remote-module/filelist/list/file-list.component\";\n\n@Component({\n    selector: 'calendar-attachment-list',\n    templateUrl: './attachment-list.component.html',\n    styleUrls: ['./attachment-list.component.css']\n})\nexport class AttachmentListComponent implements OnChanges, OnDestroy {\n    @Input() calEvent: CalEvent;\n    @Input() fileEl: HTMLInputElement;\n    @Input() removable: boolean;\n    @ViewChild(FileListComponent) fileList: FileListComponent;\n    files: any[] = [];\n    modalRef: BsModalRef;\n    confirmMessage: string;\n    private _file;\n    constructor(private calendarService: CalendarService,\n                private modalService: BsModalService) {\n\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if (changes.calEvent) {\n            this._attachmentToFiles();\n        }\n    }\n\n    ngOnDestroy(): void {\n        if (this.modalRef) {\n            this.modalRef.hide();\n        }\n    }\n\n    viewAttachment(file, event: CalEvent) {\n        window.open(xCalendar.getFileViewUrl(file.data, null, event));\n    }\n\n    removeAttachment(file, template: TemplateRef<any>) {\n        if (file.id) {\n            this._file = file;\n            this.confirmMessage = 'Tá»p tin <b>\"' + file.name + '\"</b> sáº½ bá» xoÃ¡?';\n            this.modalRef = this.modalService.show(template);\n        } else {\n            this.fileList.removeFile(file);\n        }\n    }\n\n    removeFile() {\n        if (!this._file) {\n            return;\n        }\n        this.modalRef.hide();\n        this.calendarService.deleteAttachment({fileID: this._file.id, element: this.calEvent.uuid},() => {});\n        this.fileList.removeFile(this._file);\n        this._file = null;\n    }\n\n    private _attachmentToFiles() {\n        if (this.calEvent && this.calEvent.attachments) {\n            this.files = this.calEvent.attachments.map((item: CalAttachment) => {\n                return {\n                    name: item.file,\n                    type: item.mimetype,\n                    size: item.size,\n                    id: item.gridfsUUID,\n                    data: item\n                };\n            });\n        } else {\n            this.files = [];\n        }\n    }\n}\n","import {AfterViewInit, Component, ElementRef, ViewChild} from '@angular/core';\nimport {FormControl, FormGroup, Validators} from \"@angular/forms\";\nimport {CalendarService} from \"../calendar.service\";\nimport {CalendarDialogRepeatComponent} from \"../dialog-repeat/dialog-repeat.component\";\nimport {ActivatedRoute, Router} from \"@angular/router\";\nimport {NotificationService, HttpClientService} from 'inet-core';\nimport {CalendarDialogDelete} from \"../dialog-delete/dialog-delete.component\";\nimport {AttachmentListComponent} from \"../attachment-list/attachment-list.component\";\nimport {CalEvent, CalRepeat} from \"../utils/model/CalEvent\";\nimport {CalAttendee} from \"../utils/model/CalAttendee\";\nimport * as moment_ from 'moment';\nimport {vnToLatin} from \"../utils/common/Accent\";\nimport {CalAttendeeType} from \"../utils/model/CalAttendeeType\";\nimport {xCalendar} from \"../utils/xCalendar\";\nimport {Observable} from \"rxjs\";\nimport {debounceTime, distinctUntilChanged} from \"rxjs/operators\";\nimport {TypeaheadMatch} from \"ngx-bootstrap\";\nimport {CalendarUtils} from \"../CalendarUtils\";\nconst moment = moment_;\ndeclare let iNet: any;\n\n@Component({\n    selector: 'app-calendar-form',\n    templateUrl: './calendar-form.component.html',\n    styleUrls: [\n        './calendar-form.component.css'\n    ]\n})\nexport class CalendarFormComponent implements AfterViewInit {\n    @ViewChild('repeatModal') repeatModal: CalendarDialogRepeatComponent;\n    @ViewChild('dialogRemove') viewDeleteModal: CalendarDialogDelete;\n    @ViewChild('titleInput') titleInput: ElementRef;\n    @ViewChild('attendeeInput') attendeeInput: ElementRef;\n    @ViewChild(AttachmentListComponent) fileList: AttachmentListComponent;\n    event: CalEvent = {};\n    repeatText: string;\n    eventNotFound: boolean;\n    timeError: boolean;\n    attendeeModal: any;\n    formData = {\n        title: '',\n        date: '',\n        startTime: '',\n        toTime: '',\n        location: '',\n        summary: '',\n        state: '',\n        notes: '',\n        repeat: false,\n        _allday: ''\n    };\n    attendees: CalAttendee[] = [];\n    private _attendees: CalAttendee[] = [];\n\n    constructor(private route: ActivatedRoute,\n                private calendarService: CalendarService,\n                private notify: NotificationService,\n                private router: Router,\n                private http: HttpClientService) {\n        this.calendarService.ready(() => {\n            let params = this.route.snapshot.paramMap;\n            if (params.get('id')) {\n                this.calendarService.loadEvent({\n                    element: params.get('id')\n                }, (event) => {\n                    if (!event) {\n                        this.eventNotFound = true;\n                        return;\n                    }\n                    this.event = event;\n                    this.attendees = event.attendees;\n                    if(event.members) {\n                        this.event.myAttendee = event.members.find(item => {\n                            return item.role !== 'CREATOR' && item.username === iNet.username;\n                        });\n                    }\n                    this._initForm();\n                });\n            } else {\n                let event;\n                try {\n                    event = JSON.parse(atob(params.get('data')));\n                    event.start = new Date(event.start);\n                    event.end = new Date(event.end);\n                } catch (e) {\n                    event = {};\n                    event.start = new Date();\n                    event.start.setHours(event.start.getHours() + 1, 0, 0, 0);\n                    event.end = new Date(event.start.getTime() + 60 * 60 * 1000);\n                }\n                this.event = event;\n                this._initForm();\n            }\n        });\n        this.calendarService.loadAttendees((attendees) => this._attendees = attendees);\n    }\n\n    ngAfterViewInit(): void {\n        this.titleInput.nativeElement.focus();\n    }\n\n    private _initForm() {\n        let values = {\n            title: this.event.subject || '',\n            date: this.event.start,\n            startTime: moment(this.event.start).format('HH:mm'),\n            toTime: moment(this.event.end).format('HH:mm'),\n            location: this.event.location || '',\n            summary: this.event.summary || '',\n            _allday: this.event.attribute && this.event.attribute['allday'] === 'true' || false,\n            state: 'NEEDS_ACTION',\n            notes: '',\n            repeat: false,\n        };\n        if (this.event.myAttendee) {\n            values.state = this.event.myAttendee.state;\n            values.notes = this.event.myAttendee.notes || '';\n        }\n        Object.assign(this.formData, values);\n        if (this.event.repeat) {\n            this.setRepeatData(this.event.repeat);\n        }\n    }\n\n    createEvent() {\n        let data = this._getFormData();\n        if (!data) {\n            return;\n        }\n        this.http.showLoading('Äang xá»­ lÃ½...');\n        if (data.element) {\n            this.calendarService.updateEvent(data, (data) => {\n                if (data) {\n                    this._onSuccess();\n                } else {\n                    this.notify.showMessage('Cáº­p nháº­t lá»ch khÃ´ng thÃ nh cÃ´ng', 'error');\n                }\n            });\n            this._updateMyState();\n        } else {\n            this.calendarService.createEvent(data, (data) => {\n                if (data) {\n                    this._onSuccess();\n                } else {\n                    this.notify.showMessage('Táº¡o lá»ch khÃ´ng thÃ nh cÃ´ng', 'error');\n                }\n            });\n        }\n    }\n\n    private _onSuccess() {\n        this.router.navigate(['/calendar']);\n    }\n\n    private _getFormData() {\n        if (!this._validate()) {\n            return;\n        }\n        let data = this.formData;\n        let params: any = {\n            subject: data.title,\n            summary: data.summary,\n            location: data.location,\n            startTime: this.getMinutes(data._allday ? '00:00' : data.startTime),\n            toTime: this.getMinutes(data._allday ? '23:59' : data.toTime),\n            _allday: data._allday\n        };\n        let date = moment(data.date);\n        params.day = date.dayOfYear();\n        params.year = date.year();\n        if (this.event.uuid) {\n            params.element = this.event.uuid;\n        }\n        if (data.repeat && this.event.repeat) {\n            Object.assign(params, this.event.repeat);\n            if(params.wkdays){\n                params.wkdays = params.wkdays.join(',');\n            }\n        }\n        this.fileList.files.forEach((file, index) => {\n            if (!file.id) {\n                params['file' + index] = file;\n            }\n        });\n        if (params.location) {\n            this.calendarService.saveLocation(params.location, () => {});\n        }\n        params.attendee = this.attendees;\n        xCalendar.modifyDataUpdate(params, this.event);\n        return params;\n    }\n\n    private _hasAttendee(attendee: CalAttendee) {\n        for (let i = 0; i < this.attendees.length; i++) {\n            if (this.attendees[i].username === attendee.username) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    attendeeSearch = new Observable(subscriber => {\n        let value = this.attendeeModal.trim();\n        if (!value) {\n            subscriber.next([]);\n            return;\n        }\n        value = vnToLatin(value);\n        subscriber.next(this._attendees.filter((item) => item['_index'].indexOf(value) > -1).slice(0, 10));\n    }).pipe(debounceTime(200), distinctUntilChanged());\n\n    addAttendee(e: TypeaheadMatch) {\n        let attendee = e.item;\n        this.attendeeModal = '';\n        if (!this._hasAttendee(attendee)) {\n            attendee.type = CalAttendeeType.USER;\n            this.attendees.push(attendee);\n        }\n    }\n\n    locationSearch = new Observable(subscriber => {\n        let value = this.formData.location;\n        if (!value) {\n            subscriber.next([]);\n            return;\n        }\n        this.calendarService.searchLocation(value, (items) => subscriber.next(items.map(item => item.content)));\n    }).pipe(debounceTime(200), distinctUntilChanged());\n\n    private _validate(): boolean {\n        if (!this.formData.title.trim() || !this.formData.date) {\n            return false;\n        }\n        if (!this.formData._allday) {\n            if (this.getMinutes(this.formData.startTime) >= this.getMinutes(this.formData.toTime)) {\n                this.timeError = true;\n                return false;\n            }\n        }\n        this.timeError = false;\n        return true;\n    }\n\n    setRepeatData(data: CalRepeat) {\n        if (!data) {\n            this._clearRepeat();\n            return;\n        }\n        this.event.repeat = data;\n        this.repeatText = CalendarUtils.getRepeatText(data);\n        this.formData.repeat = true;\n    }\n\n    openRepeat(checked: boolean) {\n        if (checked) {\n            this.repeatModal.openRepeat({\n                lstart: this.event.lstart\n            });\n        }\n        this._clearRepeat();\n    }\n\n    onEditRepeat(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.repeatModal.openRepeat(this.event.repeat);\n    }\n\n    private _clearRepeat() {\n        this.repeatText = '';\n        this.formData.repeat = false;\n    }\n\n    private _updateMyState() {\n        if (!this.event.myAttendee) {\n            return;\n        }\n        this.calendarService.loadEvent({\n            state: this.formData.state,\n            notes: this.formData.notes,\n            element: this.event.uuid\n        }, function () {});\n    }\n\n    goBack() {\n        history.back();\n    }\n\n    onRemoveEvent(event){\n        if (event) {\n            event.preventDefault();\n            event.stopPropagation();\n        }\n        this.viewDeleteModal.show();\n    }\n\n    private getMinutes(hourStr: string): number {\n        let hours = hourStr.split(':');\n        return Number(hours[0]) * 60 + Number(hours[1]);\n    }\n}","import {Component, OnInit, Input, Output, EventEmitter} from '@angular/core';\nimport * as moment_ from 'moment';\nconst moment = moment_;\n\n@Component({\n    selector: 'calendar-viewer',\n    templateUrl: './calendar-viewer.component.html',\n    styleUrls: ['./calendar-viewer.component.css']\n})\nexport class CalendarViewerComponent implements OnInit {\n\n    @Input() dateFormat: string = 'MMMM/YYYY';\n\n    @Input() locale: string = 'vi';\n\n    @Input() firstDay: number = 1;\n\n    @Input() limitEvent: number = 3;\n\n    @Input() view: CalendarViewerMode = CalendarViewerMode.MONTH;\n\n    @Input() set date(date: Date) {\n        let _date;\n        if (!date || !date.getTime()) {\n            _date = new Date();\n        } else {\n            _date = new Date(date);\n        }\n\n        _date.setHours(0, 0, 0, 0);\n\n        if (this.view === CalendarViewerMode.MONTH) {\n            // Set date start month\n            _date.setDate(1);\n        }\n\n        // current date view\n        if (this._date && _date.getTime() === this._date.getTime()) {\n            return;\n        }\n\n        this._date = _date;\n\n        this._render();\n    }\n\n    @Output() onChange = new EventEmitter<Date>();\n    @Output() onActive = new EventEmitter<CalendarViewerDate>();\n\n    get date(): Date {\n        return new Date(this._date);\n    }\n\n    dateTitle: string;\n\n    dates: CalendarViewerDate[] = [];\n    weekDates: CalendarViewerDate[][] = [];\n    weekTitles: string[];\n    dateActive: CalendarViewerDate;\n\n    private _date: Date;\n\n    constructor() {\n\n    }\n\n    ngOnInit() {\n        if (!this._date) {\n            this.date = new Date();\n        }\n    }\n\n    setEvents(events, date: Date) {\n        let dateViewer = this._getDateViewer(date);\n        if (dateViewer) {\n            dateViewer.events = events;\n        }\n    }\n\n    clearEvents() {\n        this.dates.forEach(dateViewer => dateViewer.events = null);\n    }\n\n    toDay() {\n        this.date = new Date();\n    }\n\n    prev() {\n        if (this.view === CalendarViewerMode.MONTH) {\n            this._prevMonth();\n        } else {\n            this._prevWeek();\n        }\n        this._render();\n    }\n\n    next() {\n        if (this.view === CalendarViewerMode.MONTH) {\n            this._nextMonth();\n        } else {\n            this._nextWeek();\n        }\n        this._render();\n    }\n\n    activeDate(dateViewer: CalendarViewerDate) {\n        this.dateActive = dateViewer;\n\n        // Move to target month\n        if (dateViewer.outOfRange) {\n            this.date = dateViewer.date;\n        }\n\n        this.onActive.emit(dateViewer);\n    }\n\n    focusDate(date: Date) {\n        let dateViewer = this._getDateViewer(date);\n        if (dateViewer) {\n            this.activeDate(dateViewer);\n        }\n    }\n\n    private _nextMonth() {\n        this._date.setMonth(this._date.getMonth() + 1);\n    }\n\n    private _prevMonth() {\n        this._date.setMonth(this._date.getMonth() - 1);\n    }\n\n    private _nextWeek() {\n        this._date.setDate(this._date.getDate() + 7);\n    }\n\n    private _prevWeek() {\n        this._date.setDate(this._date.getDate() - 7);\n    }\n\n    private _render() {\n        if (this.view === CalendarViewerMode.MONTH) {\n            this._renderMonth();\n        } else {\n            this._renderWeek();\n        }\n\n        this.onChange.emit(this.date);\n    }\n\n    private _renderMonth() {\n        let date = this._getDateStartWeek();\n\n        this.dates = [];\n        this.weekDates = [];\n        while (this.weekDates.length <= 6) {\n            this.weekDates.push(this._createWeekDate(date));\n            // detect date is end month\n            if (date.getMonth() !== this._date.getMonth()) {\n                break;\n            }\n        }\n\n        this._renderTitle();\n        this._renderWeekTitle(this.weekDates[0]);\n    }\n\n    private _renderWeek() {\n        let date = this._getDateStartWeek();\n        this.dates = [];\n        this.weekDates = [this._createWeekDate(date)];\n        this.weekDates[0].forEach(date => date.outOfRange = false);\n        this._renderTitle();\n        this._renderWeekTitle(this.weekDates[0]);\n    }\n\n    private _createWeekDate(date: Date): CalendarViewerDate[] {\n        var weekDates: CalendarViewerDate[] = [];\n\n        for (let i = 0; i < 7; i++) {\n            let dateViewer = {\n                date: new Date(date),\n                time: date.getTime(),\n                outOfRange: this._date.getMonth() !== date.getMonth(),\n                today: this._isToday(date)\n            };\n            weekDates.push(dateViewer);\n            this.dates.push(dateViewer);\n            date.setDate(date.getDate() + 1);\n        }\n\n        return weekDates;\n    }\n\n    private _renderWeekTitle(weekDates: CalendarViewerDate[]) {\n        this.weekTitles = [];\n        weekDates.forEach((viewerDate: CalendarViewerDate) => {\n            this.weekTitles.push(moment(viewerDate.date).locale(this.locale).format('dd'));\n        });\n    }\n\n    private _renderTitle() {\n        this.dateTitle = moment(this._date).locale(this.locale).format(this.dateFormat);\n    }\n\n    private _getDateStartWeek(): Date {\n        let date = new Date(this._date);\n        let startWeekFromNow = date.getDay() - this.firstDay;\n\n        if (date.getDay() < this.firstDay) {\n            startWeekFromNow += 7;\n        }\n\n        // Set date start week\n        date.setDate(date.getDate() - startWeekFromNow);\n\n        return date;\n    }\n\n    private _isToday(date: Date) {\n        var now = new Date();\n        return now.getDate() === date.getDate() && now.getMonth() === date.getMonth() && now.getFullYear() === date.getFullYear();\n    }\n\n    private _getDateViewer(date: Date) {\n        let _date = new Date(date);\n        _date.setHours(0, 0, 0, 0);\n        for (let i = 0; i < this.dates.length; i++) {\n            if (this.dates[i].time === _date.getTime()) {\n                return this.dates[i];\n            }\n        }\n    }\n}\n\nexport interface CalendarViewerDate {\n    date: Date;\n    time: number;\n    outOfRange: boolean;\n    today: boolean;\n    events?: any[];\n}\n\nexport enum CalendarViewerMode {\n    MONTH = 'month',\n    WEEK = 'week'\n}\n","import {Component, OnInit, ViewChild, Input,ElementRef} from '@angular/core';\nimport {CalendarViewerComponent, CalendarViewerDate} from \"../calendar-viewer/calendar-viewer.component\";\nimport {xCalendar} from \"../utils/xCalendar\";\nimport {CalendarService} from \"../calendar.service\";\nimport {CalEvent} from \"../utils/model/CalEvent\";\n\n@Component({\n    selector: 'calendar-widget',\n    templateUrl: './calendar-widget.component.html',\n    styleUrls: ['./calendar-widget.component.css']\n})\nexport class CalendarWidgetComponent implements OnInit {\n    @ViewChild('calendarViewer') calendarViewer: CalendarViewerComponent;\n    @ViewChild('viewToggle') viewToggle: ElementRef;\n    @Input() locale: string = 'vi';\n    @Input() dateFormat: string = 'dddd, D/M/YYYY';\n    activeDateViewer: CalendarViewerDate;\n    activeDateTitle: string;\n    colors = [\n        '#438EB9',\n        '#3CA54A',\n        '#FF9800',\n        '#EF5B49',\n        '#77901B',\n        '#7D5392',\n        '#808080'\n    ];\n    private _date: Date;\n\n    constructor(private calendarService: CalendarService) {}\n\n    ngOnInit() {\n        this.loadEvents();\n    }\n\n    changeMonth(date: Date) {\n        this._date = date;\n        this.calendarViewer.clearEvents();\n        this.loadEvents();\n    }\n\n    activeDate(e: CalendarViewerDate) {\n        this.activeDateViewer = e;\n        this.activeDateTitle = xCalendar.formatDate(e.date, this.dateFormat);\n    }\n\n    loadEvents() {\n        if (!this._date) {\n            return;\n        }\n\n        this.calendarService.loadMonthEvents(this._date, (events) => {\n            events.sort(function (a, b) {\n                return a.day - b.day;\n            });\n\n            this._groupEventByDate(events).forEach((group) => {\n                this.calendarViewer.setEvents(group.events, group.date);\n            });\n\n            // Focus today\n            if (!this.activeDateViewer) {\n                this.calendarViewer.focusDate(new Date());\n            }\n        });\n    }\n\n    onViewEvent(event: CalEvent, jsEvent: MouseEvent, targetEl: HTMLElement) {\n        this.calendarService.viewEvent(event, jsEvent, targetEl, () => this.loadEvents());\n    }\n\n    private _groupEventByDate(events) {\n        let groups = [];\n\n        events.forEach(event => {\n            let group;\n            let date = new Date(event.from);\n            date.setHours(0, 0, 0, 0);\n\n            for (let i = 0; i < groups.length; i++) {\n                if (groups[i].date.getTime() === date.getTime()) {\n                    group = groups[i];\n                    break;\n                }\n            }\n\n            if (!group) {\n                group = {\n                    events: [],\n                    date: date\n                };\n                groups.push(group);\n            }\n\n            this._initEventStatus(event);\n\n            group.events.push(event);\n\n        });\n\n        // sort event by time\n        groups.forEach((group) => {\n           group.events.sort((a, b) => a.startTime - b.startTime);\n        });\n\n        return groups;\n    }\n\n    private _initEventStatus(event) {\n        let now = new Date();\n\n        event.progressing = event.start < now && event.end > now;\n        event.ended = event.end < now;\n        event.pending = event.start > now;\n\n        if (event.progressing) {\n            event.statusText = 'Äang diá»n ra';\n            event.statusColor = this.colors[0];\n        } else if (event.pending) {\n            event.statusText = 'ChÆ°a diá»n ra';\n            event.statusColor = this.colors[5];\n        } else {\n            event.statusText = 'Káº¿t thÃºc';\n            event.statusColor = this.colors[6];\n        }\n\n        event.style = {\n            'background-color': this.colors[event.mode]\n        };\n    }\n}\n","import {Component, DoCheck, EventEmitter, Input, IterableDiffers, Output} from '@angular/core';\nimport {CalAttendee} from \"../utils/model/CalAttendee\";\nimport {CalAttendeeState} from \"../utils/model/CalAttendeeState\";\n\n@Component({\n  selector: 'calendar-attendee-list',\n  templateUrl: './attendee-list.component.html',\n  styleUrls: ['./attendee-list.component.css']\n})\n\nexport class CalendarAttendeeListComponent implements DoCheck {\n  @Input() attendees: CalAttendee[] = [];\n  @Input() editable: boolean = false;\n  @Input() expandable: boolean = false;\n  @Output() onDelete = new EventEmitter();\n\n  differ: any;\n  stateText: string;\n  expandEnable: boolean = true;\n  expanded: boolean = true;\n\n  constructor(differs: IterableDiffers) {\n    this.differ = differs.find([]).create(null);\n  }\n\n  ngDoCheck() {\n    const change = this.differ.diff(this.attendees);\n\n    // Detect push item on array\n    if (change) {\n      this.generateDetail();\n    }\n  }\n\n  removeAttendee(attendee) {\n    let index = this.attendees.indexOf(attendee);\n    if (index > -1) {\n      this.attendees.splice(index, 1);\n      this.onDelete.emit();\n    }\n  }\n\n  generateDetail() {\n    let accept: number = 0,\n        reject: number = 0,\n        unknown: number = 0;\n    let arr: string[] = [];\n\n    this.attendees.forEach(function (item) {\n        if (item.state === CalAttendeeState.ACCEPTED) {\n            item._stateText = 'Tham dá»±';\n            accept++;\n        } else if (item.state === CalAttendeeState.DECLINED) {\n            item._stateText = 'KhÃ´ng tham dá»±';\n            reject++;\n        } else if (item.state === CalAttendeeState.NEEDS_ACTION) {\n            item._stateText = 'ChÆ°a quyáº¿t Äá»nh';\n            unknown++;\n        }\n    });\n\n    if (accept) {\n      arr.push(accept + ' cÃ³');\n    }\n    if (reject) {\n      arr.push(reject + ' khÃ´ng');\n    }\n    if (unknown) {\n      arr.push(unknown + ' chÆ°a quyáº¿t Äá»nh');\n    }\n    this.stateText = arr.join(', ');\n  }\n\n  expandAttendees() {\n    if (this.expandEnable) {\n      this.expanded = !this.expanded;\n    }\n  }\n\n  getStateIcon(attendee) {\n    let cls;\n    switch(attendee.state) {\n      case 'ACCEPTED':\n        cls = 'fa-check accept';\n        break;\n      case 'DECLINED':\n        cls = 'fa-check accept';\n        break;\n      default:\n        cls = 'fa-check unknown';\n    }\n    return 'attendee-info fa ' + cls;\n  }\n}\n","import {NgModule} from '@angular/core';\nimport {Routes, RouterModule} from '@angular/router';\nimport {CalendarComponent} from \"./calendar.component\";\nimport {CalendarFormComponent} from \"./form/calendar-form.component\";\n\nconst routes: Routes = [\n    {\n        path: 'calendar/v',\n        children: [{\n            path: '**',\n            component: CalendarComponent\n        }]\n    },\n    {\n        path: 'calendar/event',\n        children: [\n            {\n                path: ':id',\n                component: CalendarFormComponent\n            },\n            {\n                path: '**',\n                redirectTo: 'create',\n                pathMatch: 'full'\n            }\n        ]\n    },\n    {\n        path: 'calendar/create',\n        children: [\n            {\n                path: ':data',\n                component: CalendarFormComponent\n            },\n            {\n                path: '**',\n                component: CalendarFormComponent\n            }\n        ]\n    },\n    {\n        path: 'calendar',\n        redirectTo: 'calendar/v',\n        pathMatch: 'full'\n    }\n];\n\n@NgModule({\n    imports: [RouterModule.forChild(routes)],\n    exports: [RouterModule]\n})\nexport class CalendarRoutingModule {\n}\n","import {Injectable} from '@angular/core';\n\ndeclare let iNet: any;\n\nconst FILES_FORMAT = [\n    'unknown', 'text', 'archive', 'audio', 'video',\n    'png', 'jpg', 'gif', 'tiff', 'svg', 'ai', 'psd', 'dwg',\n    'avi', 'fla', 'mp2', 'mp3', 'mp4', 'aac', 'flac', 'wma', 'wav', 'mxf',\n    'iso', 'mdf', 'nrg',\n    'zip', '7z', 'arj', 'rar',\n    'pdf', 'doc', 'rtf', 'txt', 'xls', 'ppt',\n    'css', 'csv', 'html', 'json', 'js', 'xml',\n    'dbf', 'exe'\n];\n\nconst FILES_EDIT_FORMAT = [\n    'doc', 'docx', 'odt', 'ods', 'xls', 'xlsx',\n    'ppt', 'pps', 'pptm', 'pptx','pot', 'potx',\n    'dot', 'dotx', 'docm','dotx', 'csv' , 'sxw']\n;\n\nconst FILES_VIEW_FORMAT = ['pdf', 'png', 'jpg' ,'jpeg' , 'gif'];\n\nconst UNKNOWN = 'unknown';\n\n@Injectable()\nexport class FileFormatService {\n\n    constructor() {}\n\n    getImagePath(): string {\n        let path =  iNet.commonImageFolder;\n        const lastIndex = path.lastIndexOf('/');\n        if (lastIndex === path.length - 1) {\n            return path.substring(0, lastIndex);\n        }\n        return path;\n    }\n\n    getFileFormatPath(): string {\n        return `${this.getImagePath()}/format`;\n    }\n\n    getUrlByExt(ext: string) {\n        const path = this.getFileFormatPath();\n        if (FILES_FORMAT.indexOf(ext) > -1) {\n            return `${path}/${ext.toLowerCase()}.svg`\n        }\n        return `${path}/${UNKNOWN}.svg`\n    }\n\n    getUrlByName(name: string) {\n        return this.getUrlByExt(this.getExtByName(name));\n    }\n\n    getExtByName(name: string) {\n        return name.split('.').pop().toLowerCase() || UNKNOWN;\n    }\n\n    getEditFormats(): string[] {\n        return FILES_EDIT_FORMAT;\n    }\n\n    getViewFormats(): string[] {\n        return FILES_VIEW_FORMAT;\n    }\n\n}\n","import {Pipe, PipeTransform} from '@angular/core';\nimport {FileFormatService} from \"./file-format.service\";\n\n@Pipe({\n    name: 'fileExt'\n})\nexport class FileExtPipe implements PipeTransform {\n    constructor(private formatService: FileFormatService) {\n    }\n\n    transform(name: string): string {\n        return this.formatService.getExtByName(name);\n    }\n}\n","import {Pipe, PipeTransform} from '@angular/core';\nimport {FileFormatService} from \"./file-format.service\";\n\n@Pipe({\n    name: 'fileIcon'\n})\nexport class FileIconPipe implements PipeTransform {\n\n    constructor(private formatService: FileFormatService) {\n\n    }\n\n    transform(name: string): string {\n        return this.formatService.getUrlByName(name);\n    }\n\n}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {FileExtPipe} from './file-ext.pipe';\nimport {FileIconPipe} from './file-icon.pipe';\nimport {FileFormatService} from './file-format.service';\nimport {FileListComponent} from \"./list/file-list.component\";\n\n@NgModule({\n    imports: [\n        CommonModule\n    ],\n    declarations: [\n        FileIconPipe,\n        FileExtPipe,\n        FileListComponent\n    ],\n    exports: [\n        FileIconPipe,\n        FileExtPipe,\n        FileListComponent\n    ],\n    providers: [FileFormatService]\n})\nexport class FileListModule {\n}\n","import {Component, ElementRef, EventEmitter, Input, OnDestroy, OnInit, Output, ViewChild} from '@angular/core';\nimport {TimepickerComponent} from \"ngx-bootstrap\";\ndeclare let $:any;\n\n@Component({\n    selector: 'time-picker-modal',\n    templateUrl: './time-picker-modal.component.html',\n    styleUrls: ['./time-picker-modal.component.css']\n})\nexport class TimePickerModalComponent implements OnInit, OnDestroy {\n    @Input() arrowkeys: boolean = true;\n    @Input() hourStep: number = 1;\n    @Input() max: Date;\n    @Input() min: Date;\n    @Input() minuteStep: number = 15;\n    @Input() mousewheel: boolean = true;\n    @Input() readonlyInput: boolean = false;\n    @Input() secondsStep: number = 10;\n    @Input() showMeridian: boolean;\n    @Input() showMinutes: boolean = true;\n    @Input() showSeconds: boolean;\n    @Input() showSpinners: boolean = true;\n\n    @Input() set time(date: Date | null) {\n        this._timeDate = date;\n        this.timeStr = TimePickerModalComponent._formatDate(date);\n        this.onChange.emit(this.timeStr);\n    }\n\n    get time(): Date {\n        return this._timeDate;\n    }\n\n    @Output() onChange = new EventEmitter();\n    @ViewChild('timePicker') timePicker: TimepickerComponent;\n    timeStr: string;\n    $modal: any;\n    $modalContent: any;\n    private _timeDate: Date;\n\n    constructor(\n        public el: ElementRef\n    ) {\n    }\n\n    ngOnInit() {\n        this.$modal = $(this.el.nativeElement).detach().addClass('modal');\n        this.$modalContent = this.$modal.find('.time-picker-modal');\n\n        // Touched close\n        this.$modal.on('mousedown click', (e) => {\n            if (e.target.isSameNode(this.$modal[0])) {\n                this.close();\n            }\n        })\n    }\n\n    ngOnDestroy() {\n        this.$modal.remove();\n    }\n\n    close() {\n        this.$modal.detach();\n    }\n\n    open(css: any) {\n        this.$modalContent.css(css);\n        document.body.appendChild(this.$modal[0]);\n    }\n\n    private static _formatDate(date: Date) {\n        if (!date || !date.getTime()) {\n            return '';\n        } else {\n            return ('0' + date.getHours()).slice(-2) + ':' + ('0' + date.getMinutes()).slice(-2);\n        }\n    }\n}\n","import {Directive, ElementRef, EventEmitter, forwardRef, HostListener, Input, OnInit, Output} from '@angular/core';\nimport {TimePickerModalComponent} from \"./time-picker-modal/time-picker-modal.component\";\nimport {ControlValueAccessor, NG_VALUE_ACCESSOR} from \"@angular/forms\";\n\nexport const DEFAULT_VALUE_ACCESSOR: any = {\n  provide: NG_VALUE_ACCESSOR,\n  useExisting: forwardRef(() => TimePickerModalDirective),\n  multi: true\n};\n\n@Directive({\n  selector: '[timePicker]',\n  providers: [DEFAULT_VALUE_ACCESSOR]\n})\nexport class TimePickerModalDirective implements OnInit, ControlValueAccessor {\n  @Output() valueChange = new EventEmitter<string>();\n  @Input() timePickerModal: TimePickerModalComponent;\n  @HostListener('focus') onFocus() {\n    this.open();\n    this.onChange();\n  }\n  @HostListener('change') onChange() {\n    this.timePickerModal.time = this.getDateInput();\n  }\n  private propagateChange;\n  constructor(private el: ElementRef) { }\n\n  ngOnInit() {\n    if (!this.timePickerModal) {\n      console.error('[TimePickerModalDirective] Missing timePickerModal');\n    }\n    this.timePickerModal.onChange.subscribe((timeStr) => {\n      this.writeValue(timeStr);\n      if (this.propagateChange) {\n        this.propagateChange(timeStr);\n      }\n    });\n  }\n\n  writeValue(value: string) {\n    this.el.nativeElement.value = value;\n    this.valueChange.emit(value);\n  }\n\n  registerOnChange(fn: any) {\n    this.propagateChange = fn;\n  }\n\n  registerOnTouched(fn: any) {\n    \n  }\n\n  open() {\n    let bounding = this.el.nativeElement.getBoundingClientRect();\n    let css = {\n      left: bounding.left\n    };\n    if (bounding.top + 150 < innerHeight) {\n      // Show bottom\n      css['top'] = bounding.top + bounding.height + 2;\n    } else {\n      // Show top\n      css['bottom'] = bounding.top - 2;\n    }\n    this.timePickerModal.open(css);\n  }\n\n  close() {\n    this.timePickerModal.close();\n  }\n\n  private getDateInput(): Date | null {\n    let value = this.getValue();\n    if (!value) {\n      return null;\n    }\n    let date = new Date();\n    date.setMinutes(0);\n    // HH:mm:ss format\n    let times: any[];\n    if (value.indexOf(':') > -1) {\n      times = value.split(':');\n    } else {\n      times = [];\n      for (let i = 0; i < value.length + 1; i += 2) {\n        times.push(value.substr(i, 2));\n      }\n    }\n    times[0] = Number(times[0]);\n    times[1] = Number(times[1]) || 0;\n    // Invalid time\n    if (!times[0] && times[0] !== 0) {\n      return null;\n    }\n    date.setHours(times[0]);\n    date.setMinutes(times[1]);\n    return date;\n  }\n\n  private getValue() {\n    return this.el.nativeElement.value.trim();\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {TimepickerModule} from \"ngx-bootstrap\";\nimport {TimePickerModalComponent} from \"./time-picker-modal/time-picker-modal.component\";\nimport {TimePickerModalDirective} from \"./time-picker-modal.directive\";\nimport {FormsModule} from \"@angular/forms\";\n\n/**\n * TimePickerModal: https://valor-software.com/ngx-bootstrap/#/timepicker#timepicker-config\n *\n * <input type=\"text\" class=\"form-control\" timePicker [timePickerModal]=\"timeEndModal\" [(ngModel)]=\"timeStr\">\n * <time-picker-modal #timeEndModal></time-picker-modal>\n *\n */\n\n@NgModule({\n  imports: [\n    TimepickerModule.forRoot(),\n    CommonModule,\n    FormsModule\n  ],\n  declarations: [\n    TimePickerModalDirective,\n    TimePickerModalComponent\n  ],\n  exports: [\n    TimePickerModalDirective,\n    TimePickerModalComponent,\n  ]\n})\nexport class TimePickerModalModule { }\n","import {NgModule} from '@angular/core';\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\nimport {CalendarComponent} from './calendar.component';\nimport {CalendarDialogRepeatComponent} from './dialog-repeat/dialog-repeat.component';\nimport {CalendarFormComponent} from './form/calendar-form.component';\nimport {BsDatepickerModule, ModalModule, TimepickerModule, TypeaheadModule} from 'ngx-bootstrap';\nimport {HttpClientModule} from '@angular/common/http';\nimport {CommonModule} from '@angular/common';\nimport {\n    CoreModule,\n    ResourceLoaderService,\n    SuggestionService\n} from 'inet-core';\nimport {CalendarTodayComponent} from \"./calendar-today/calendar-today.component\";\nimport {CalendarWidgetComponent} from \"./calendar-widget/calendar-widget.component\";\nimport {CalendarDialogViewComponent} from \"./dialog-view/dialog-view.component\";\nimport {CalendarAttendeeListComponent} from \"./attendee-list/attendee-list.component\";\nimport {CalendarDialogDelete} from \"./dialog-delete/dialog-delete.component\";\nimport {AttachmentListComponent} from \"./attachment-list/attachment-list.component\";\nimport {CalendarService} from \"./calendar.service\";\nimport {CalendarViewerComponent} from \"./calendar-viewer/calendar-viewer.component\";\nimport {CalendarRoutingModule} from \"./calendar-routing.module\";\nimport {FileListModule} from \"./remote-module/filelist/file-list.module\";\nimport {TimePickerModalModule} from \"./remote-module/time-picker/time-picker-modal.module\";\n\n@NgModule({\n    imports: [\n        BsDatepickerModule.forRoot(),\n        TimepickerModule.forRoot(),\n        ModalModule.forRoot(),\n        TypeaheadModule.forRoot(),\n        ReactiveFormsModule,\n        CommonModule,\n        FormsModule,\n        CoreModule,\n        FileListModule,\n        CommonModule,\n        TimePickerModalModule,\n        HttpClientModule,\n        CalendarRoutingModule\n    ],\n    exports: [\n        CalendarComponent,\n        CalendarDialogRepeatComponent,\n        CalendarFormComponent,\n        CalendarTodayComponent,\n        CalendarWidgetComponent,\n        CalendarDialogViewComponent,\n        CalendarAttendeeListComponent,\n        CalendarDialogDelete,\n        AttachmentListComponent,\n        CalendarViewerComponent\n    ],\n    declarations: [\n        CalendarComponent,\n        CalendarDialogRepeatComponent,\n        CalendarFormComponent,\n        CalendarTodayComponent,\n        CalendarWidgetComponent,\n        CalendarDialogViewComponent,\n        CalendarAttendeeListComponent,\n        CalendarDialogDelete,\n        AttachmentListComponent,\n        CalendarViewerComponent\n    ],\n    providers: [\n        CalendarService,\n        ResourceLoaderService,\n        SuggestionService\n    ],\n    entryComponents: [\n        CalendarDialogViewComponent\n    ]\n})\nexport class CalendarModule {\n\n}\n"]}