!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("@angular/common/http"),require("rxjs/operators"),require("rxjs/add/operator/map"),require("rxjs/add/observable/of"),require("rxjs/add/operator/do"),require("@angular/common"),require("vertx3-eventbus-client")):"function"==typeof define&&define.amd?define("inet-core",["exports","@angular/core","rxjs","@angular/common/http","rxjs/operators","rxjs/add/operator/map","rxjs/add/observable/of","rxjs/add/operator/do","@angular/common","vertx3-eventbus-client"],e):e((t=t||self)["inet-core"]={},t.ng.core,t.rxjs,t.ng.common.http,t.rxjs.operators,t.rxjs["add/operator/map"],t.rxjs["add/observable/of"],t.rxjs["add/operator/do"],t.ng.common,t.EventBus)}(this,(function(t,e,n,r,o,i,s,a,c,u){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function l(t,e){function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var h=function(){function t(){return this.elementId="loading-indicator",t.instance=t.instance||this}return t.prototype.setElementId=function(t){this.elementId=t},t.prototype.getElementId=function(){return this.elementId},t.prototype.getIndicator=function(){if(t.loadingIndicator&&t.loadingIndicator.container)return t.loadingIndicator;var e,n,r=document.getElementById(this.getElementId());if(r){var o=r.getElementsByTagName("span");o&&o.length>0&&(e=r.getElementsByTagName("span")[0])&&e.innerText&&(n=e.innerText)}return t.loadingIndicator=new f(r,e,n),t.loadingIndicator},t.prototype.getLoadingIndicator=function(){var t=this;return new Promise((function(e,n){setTimeout((function(){return e(t.getIndicator())}))}))},t.prototype.showLoading=function(t){this.getLoadingIndicator().then((function(e){e&&e.container&&(e.element&&(e.element.innerText=t||e.message||e.container.title),e.container.style.display="block")}))},t.prototype.hideLoading=function(){this.getLoadingIndicator().then((function(t){t&&t.container&&(t.container.style.display="none")}))},t.prototype.complete=function(){this.hideLoading()},t.prototype.ngOnDestroy=function(){this.complete()},t.instance=null,t.loadingIndicator=null,t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[]},t}();var f=function(t,e,n){void 0===n&&(n=""),this.container=t,this.element=e,this.message=n};var A=function(){function t(){}return t.prototype.encodeKey=function(t){return d(t)},t.prototype.encodeValue=function(t){return d(t)},t.prototype.decodeKey=function(t){return decodeURIComponent(t)},t.prototype.decodeValue=function(t){return decodeURIComponent(t)},t}();function d(t){return encodeURIComponent(t)}var y=function(t){function n(e,n){var o=t.call(this,e)||this;return o.loadingService=n,o.headers=new r.HttpHeaders({"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}),o}return l(n,t),n.prototype.convertToHttpParams=function(t){return t?Object.getOwnPropertyNames(t).reduce((function(e,n){return e.set(n,null==t[n]?"":t[n])}),new r.HttpParams({encoder:new A})):null},n.prototype.getJSON=function(t,e){return this.get(t,{params:this.convertToHttpParams(e),headers:this.headers})},n.prototype.postJSON=function(t,e){return this.post(t,this.convertToHttpParams(e),{headers:this.headers})},n.prototype.putJSON=function(t,e){return this.put(t,this.convertToHttpParams(e),{headers:this.headers})},n.prototype.deleteJSON=function(t,e){return this.delete(t,{params:this.convertToHttpParams(e),headers:this.headers})},n.prototype.convertToFormData=function(t){var e=new FormData;return t?(Object.keys(t).forEach((function(n){e.append(n,null==t[n]?"":t[n])})),e):e},n.prototype.downloadFile=function(t,e){if(e){var n=document.createElement("form");n.method="POST",n.action=t,n.enctype="multipart/form-data",Object.keys(e).forEach((function(t){var r=document.createElement("input");r.name=t,r.value=null==e[t]?"":e[t],r.type="hidden",n.appendChild(r)})),document.body.appendChild(n),n.submit(),document.body.removeChild(n)}},n.prototype.showLoading=function(t){this.loadingService.showLoading(t)},n.prototype.hideLoading=function(){this.loadingService.hideLoading()},n.decorators=[{type:e.Injectable}],n.ctorParameters=function(){return[{type:r.HttpHandler},{type:h}]},n}(r.HttpClient);var g=function(){function t(e){return this.http=e,t.instance=t.instance||this}return t.prototype.logout=function(){this.http.post(iNet.getPUrl("system/logout"),{username:iNet.username}).subscribe((function(t){var e=document.createElement("iframe");e.setAttribute("src",t.uuid),e.addEventListener("load",(function(){location.reload()})),document.body.appendChild(e)}),(function(t){}))},t.prototype.getAvatar=function(t,e){return e=e||50,iNet.getPUrl("system/userprofile/photo")+"?usercode="+t+"&thumbnail="+e},t.prototype.isExternalUser=function(){return"true"==iNet.externalUser},t.prototype.isCommunity=function(){return this.isExternalUser()||"smartcloud"==iNet.firmPrefix||"community"==iNet.firmPrefix},t.prototype.getOrg=function(){return this.http.get(iNet.getPUrl("plugin/organization/list")).pipe(o.map((function(t){return t.elements})))},t.prototype.searchOrgan=function(t){return void 0===t&&(t={}),this.http.postJSON(iNet.getPUrl("plugin/organization/search"),t).pipe(o.map((function(t){return t.elements})))},t.prototype.getSystemApplication=function(){var t=this;return this.applications?n.of(this.applications):(this.$appCache||(this.$appCache=this.http.postJSON(iNet.getPUrl("system/application/list")).pipe(o.tap((function(e){return t.applications=e.elements}))).pipe(o.map((function(t){return t.elements}))).pipe(o.shareReplay(1))),this.$appCache)},t.prototype.searchFirmAccount=function(t,e){this.http.postJSON(iNet.getPUrl("plugin/firmaccount/list"),t).subscribe((function(t){e(t)}),(function(t){e(null,t)}))},t.prototype.updateLanguage=function(t,e){this.http.postJSON(iNet.getPUrl("system/userprofile/languageupdate"),{intl:t}).subscribe((function(n){e&&e(t)}),(function(n){e&&e(t)}))},t.prototype.getImageUrl=function(t){return t?0===t.indexOf("/")?this.getAssetsPath()+t:this.getAssetsPath()+"/"+t:""},t.prototype.getFileUrl=function(t){return t?0===t.indexOf("/")?this.getFileServerPath()+t:this.getFileServerPath()+"/"+t:""},t.prototype.getSsoRedirect=function(t){return iNet.getPUrl("ssorequest/redirect")+"?"+$.param(t)},t.prototype.convergePlugins=function(){return this.convergeSearch({converge:"plugins"})},t.prototype.convergeSearch=function(t){return this.http.postJSON(iNet.getPUrl("converge/search"),t)},t.prototype.setEnvironment=function(e){void 0===e&&(e={production:!1}),t.environment=e},t.prototype.getEnvironment=function(){return t.environment},t.prototype.getPath=function(t){void 0===t&&(t="");var e=t.lastIndexOf("/");return e===t.length-1?t.substring(0,e):t},t.prototype.getFileServerPath=function(){return this.getPath(iNet.fileServer)},t.prototype.getAssetsPath=function(){return this.getPath(iNet.imgFolder)},t.instance=null,t.environment={production:!1},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:y}]},t}();var m=function(){function t(e){return this.http=e,t.instance=t.instance||this}return t.prototype.saveSuggestion=function(t,e){if(t.keyword)return this.http.postJSON(iNet.getPUrl("system/suggestion/update"),t).subscribe((function(t){e&&e(t)}),(function(t){e&&e(null,t)}))},t.prototype.loadSuggestion=function(t,e){return this.http.postJSON(iNet.getPUrl("system/suggestion/hint"),t).subscribe((function(t){e(t&&t.items||[])}),(function(t){e([],t)}))},t.instance=null,t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:y}]},t}();var v={sH:0,sT:0,cH:0},b=function(){function t(t){var e=this;this.elm=t,this.scrollPercent=70,this.isSubmit=!1,this.isUserScrollingDown=function(t){return t[0].sT<t[1].sT},this.isScrollExpectedPercent=function(t){return(t.sT+t.cH)/t.sH>e.scrollPercent/100}}return t.prototype.ngAfterViewInit=function(){this.registerScrollEvent(),this.streamScrollEvents(),this.requestCallbackOnScroll()},t.prototype.registerScrollEvent=function(){this.scrollEvent$=n.fromEvent(this.elm.nativeElement,"scroll")},t.prototype.streamScrollEvents=function(){var t=this;this.userScrolledDown$=this.scrollEvent$.map((function(t){return{sH:t.target.scrollHeight,sT:t.target.scrollTop,cH:t.target.clientHeight}})).pairwise().filter((function(e){return t.isUserScrollingDown(e)&&t.isScrollExpectedPercent(e[1])}))},t.prototype.requestCallbackOnScroll=function(){var t=this;this.requestOnScroll$=this.userScrolledDown$,this.immediateCallback&&(this.requestOnScroll$=this.requestOnScroll$.startWith([v,v])),this.requestOnScroll$.exhaustMap((function(){return t.scrollCallback()})).subscribe((function(t){console.log(t)}),(function(t){return console.log(t)}))},t.prototype.isScrollSubmit=function(){return this.isSubmit},t.decorators=[{type:e.Directive,args:[{selector:"[appInfiniteScroller]"}]}],t.ctorParameters=function(){return[{type:e.ElementRef}]},t.propDecorators={scrollCallback:[{type:e.Input}],immediateCallback:[{type:e.Input}],scrollPercent:[{type:e.Input}],isSubmit:[{type:e.Input}]},t}();var S=function(){};var _=function(){function t(){}return t.prototype.showMessage=function(t,e,n,r){},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[]},t}(),P=function(){};var I=function(t){function e(e,n,r){var o=t.call(this)||this;return o.pageNumber=e,o.pageSize=n,o.notifylist=r,o}return l(e,t),e}(P);var E=function(){};var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e}(E);var N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e}(E);var C=function(){function t(e){return this.http=e,this.roles=[],t.instance||(this.roles=this.parserRoleFrom(iNet.permission||{})),t.instance=t.instance||this}return t.prototype.load=function(){var t=this;return new Promise((function(e){window.iNet&&!iNet.isEmpty(iNet.prefix)&&iNet.enableLayout?t.http.postJSON(iNet.getPUrl("system/userrole/list")).subscribe((function(n){for(var r in n)t.append(n[r]);e(n)}),(function(t){e()})):e()}))},t.prototype.parserRoleFrom=function(t){var e=[];for(var n in t)"true"!==t[n]&&!0!==t[n]||e.push(n);return e},t.prototype.uniqueArray=function(t){return t.filter((function(t,e,n){return n.indexOf(t)==e}))},t.prototype.append=function(t){return this.roles=this.uniqueArray(this.roles.concat(t)),this.roles},t.prototype.hasRole=function(t){var e=this,n=t.split(",");return n.length>1?n.filter((function(t){return e.roles.indexOf(t)>-1})).length>0:this.roles.indexOf(t)>-1},t.prototype.ping=function(){if(!iNet.isEmpty(iNet.username)&&iNet.enableLayout){var t=document.createElement("iframe");t.style.display="none",t.setAttribute("src",iNet.getPUrl("common/page/ping")),t.onload=function(){try{var e=t.contentWindow.location.pathname||"";("cas/login".match(e)||[]).length>0&&window.location.reload()}catch(t){window.location.reload()}document.body.removeChild(t)},document.body.appendChild(t)}},t.instance=null,t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:y}]},t}();var U=function(){function t(t,e,n){this.templateRef=t,this.viewContainer=e,this.securityService=n}return t.prototype.ngOnInit=function(){this.applyPermission()},t.prototype.applyPermission=function(){this.securityService.hasRole(this.roleAccess)?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()},t.decorators=[{type:e.Directive,args:[{selector:"[roleAccess]"}]}],t.ctorParameters=function(){return[{type:e.TemplateRef},{type:e.ViewContainerRef},{type:C}]},t.propDecorators={roleAccess:[{type:e.Input,args:["roleAccess"]}]},t}();var w=function(){function t(){}return t.prototype.transform=function(t){return iNet.getSSOUrl(t)},t.decorators=[{type:e.Pipe,args:[{name:"ssoUrl"}]}],t}(),j=function(){function t(e,n){return this.http=e,this.coreService=n,this.profile=null,this.systemProfile=null,this.$profileObservableCache={},this.inventory={},this.url={get:iNet.getPUrl("gl/contact/load"),view:iNet.getPUrl("system/userprofile/view"),update:iNet.getPUrl("system/userprofile/update"),change_password:iNet.getPUrl("system/account/passsword"),photo:iNet.getPUrl("system/userprofile/photo")},t.instance=t.instance||this}return t.prototype.loadSystemProfile=function(){var t=this;return this.http.postJSON(this.url.view).map((function(t){return t})).do((function(e){t.systemProfile=e,t.profile=e.user}))},t.prototype.getSystemProfile=function(){return this.systemProfile?n.Observable.of(this.systemProfile):(this.$systemProfileCache||(this.$systemProfileCache=this.loadSystemProfile().pipe(o.shareReplay(1))),this.$systemProfileCache)},t.prototype.getProfile=function(){return this.profile?n.Observable.of(this.profile):this.getSystemProfile().map((function(t){return t.user}))},t.prototype.update=function(t){return this.$cache=null,this.http.postJSON(this.url.update,t)},t.prototype.changePassword=function(t){return this.http.postJSON(this.url.change_password,t)},t.prototype.getAvatarUrlByProfile=function(t){var e;return e=this.coreService.getFileUrl(t.avatar),this.getAvatarVersion()>0&&(e=e+"?version="+this.getAvatarVersion()),e},t.prototype.getAvatarUrl=function(){var t=this;return new Promise((function(e){e(t.url.photo)}))},t.prototype.getFullName=function(){var t=this;return new Promise((function(e){window.iNet&&!iNet.isEmpty(iNet.prefix)&&iNet.enableLayout?t.getProfile().subscribe((function(t){var n="";t.lastName&&(n+=t.lastName),t.middleName&&(n+=" "+t.middleName),t.firstName&&(n+=" "+t.firstName),t.name=n||iNet.displayName||iNet.username,e(t.name.trim())}),(function(t){e()})):e(window.iNet?iNet.displayName:"")}))},t.prototype.getSignPictureId=function(){var t=this;return new Promise((function(e){t.getSystemProfile().subscribe((function(t){var n="";t.user&&t.user.signPictureID&&(n=t.user.signPictureID),e(n)}),(function(t){e()}))}))},t.prototype.getSignVerifyNumber=function(){var t=this;return new Promise((function(e){t.getSystemProfile().subscribe((function(t){var n="";t.user&&t.user.signVerify&&(n=t.user.signVerify),e(n)}),(function(t){e()}))}))},t.prototype.increaseAvatarVersion=function(){localStorage.setItem("avatarVersion",(this.getAvatarVersion()+1).toString())},t.prototype.getAvatarVersion=function(){return Number(localStorage.getItem("avatarVersion"))},t.prototype.getProfileByUsername=function(t){var e=this;return this.inventory.hasOwnProperty(t)?n.Observable.of(this.inventory[t]):(this.$profileObservableCache[t]||(this.$profileObservableCache[t]=this.http.getJSON(this.url.get,{username:t}).do((function(n){return e.inventory[t]=n})).pipe(o.shareReplay(1))),this.$profileObservableCache[t])},t.prototype.getAvatarUrlByUsername=function(t){var e=this;return new Promise((function(n){e.getProfileByUsername(t).subscribe((function(t){t.avatar?n(e.coreService.getFileUrl(t.avatar)):n()}),(function(t){n()}))}))},t.prototype.getDefaultAvatarUrl=function(){return t.DEFAULT_AVATAR_URL},t.instance=null,t.DEFAULT_AVATAR_URL="data:image/jpeg;base64,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",t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:y},{type:g}]},t}();var x=function(){};var R=function(){};var k=function(){function t(){this._vi_accents=["à","á","ạ","ả","ã","â","ầ","ấ","ậ","ẩ","ẫ","ă","ằ","ắ","ặ","ẳ","ẵ","è","é","ẹ","ẻ","ẽ","ê","ề","ế","ệ","ể","ễ","ì","í","ị","ỉ","ĩ","ò","ó","ọ","ỏ","õ","ô","ồ","ố","ộ","ổ","ỗ","ơ","ờ","ớ","ợ","ở","ỡ","ù","ú","ụ","ủ","ũ","ư","ừ","ứ","ự","ử","ữ","ỳ","ý","ỵ","ỷ","ỹ","đ","À","Á","Ạ","Ả","Ã","Â","Ầ","Ấ","Ậ","Ẩ","Ẫ","Ă","Ằ","Ắ","Ặ","Ẳ","Ẵ","È","É","Ẹ","Ẻ","Ẽ","Ê","Ề","Ế","Ệ","Ể","Ễ","Ì","Í","Ị","Ỉ","Ĩ","Ò","Ó","Ọ","Ỏ","Õ","Ô","Ồ","Ố","Ộ","Ổ","Ỗ","Ơ","Ờ","Ớ","Ợ","Ở","Ỡ","Ù","Ú","Ụ","Ủ","Ũ","Ư","Ừ","Ứ","Ự","Ử","Ữ","Ỳ","Ý","Ỵ","Ỷ","Ỹ","Đ"],this._en_accents=["a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","e","e","e","e","e","e","e","e","e","e","e","i","i","i","i","i","o","o","o","o","o","o","o","o","o","o","o","o","o","o","o","o","o","u","u","u","u","u","u","u","u","u","u","u","y","y","y","y","y","d","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","E","E","E","E","E","E","E","E","E","E","E","I","I","I","I","I","O","O","O","O","O","O","O","O","O","O","O","O","O","O","O","O","O","U","U","U","U","U","U","U","U","U","U","U","Y","Y","Y","Y","Y","D"]}return t.prototype.viToEn=function(t){var e=this;return t.replace(/[^\u0000-\u007E]/g,(function(t){var n=e._vi_accents.indexOf(t);return n<0?t:e._en_accents[n]}))},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[]},t}();var D=function(){function t(){this.timeCache=3e5,this.__storage={},this.__queue={}}return t.prototype.promiseQueue=function(t,e,n){this.__queue[t]?this.__queue[t].push(n):(this.__queue[t]=[n],e(t))},t.prototype.resolveQueue=function(t,e,n){this.__queue[t]&&(this.__queue[t].forEach((function(t){try{t.apply(e,n)}catch(t){}})),delete this.__queue[t])},t.prototype.getData=function(t){var e=this.__storage[t];if(e&&(new Date).getTime()-e.time<=e.timeCache)return e.value},t.prototype.setData=function(t,e,n){var r=n&&n.timeCache||this.timeCache;this.__storage[t]={time:(new Date).getTime(),timeCache:r,value:e}},t.prototype.removeData=function(t){delete this.__storage[t]},t.prototype.clearData=function(){this.__storage={}},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[]},t}();var H=function(){function t(t){this.element=t,this.el=t.nativeElement,this._clientWidth=this.el.clientWidth}return Object.defineProperty(t.prototype,"minHeight",{get:function(){return this._minHeight},set:function(t){this._minHeight=t,this.updateMinHeight()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){return this._maxHeight},set:function(t){this._maxHeight=t,this.updateMaxHeight()},enumerable:!0,configurable:!0}),t.prototype.onResize=function(){this.el.clientWidth!==this._clientWidth&&(this._clientWidth=this.element.nativeElement.clientWidth,this.adjust())},t.prototype.onInput=function(){this.adjust()},t.prototype.ngAfterViewInit=function(){var t=window.getComputedStyle(this.el,null);"both"===t.resize?this.el.style.resize="horizontal":"vertical"===t.resize&&(this.el.style.resize="none"),this.adjust()},t.prototype.adjust=function(){this.el.style.overflow="hidden",this.el.style.height="auto",this.el.style.height=this.el.scrollHeight+"px"},t.prototype.updateMinHeight=function(){this.el.style.minHeight=this._minHeight+"px"},t.prototype.updateMaxHeight=function(){this.el.style.maxHeight=this._maxHeight+"px"},t.decorators=[{type:e.Directive,args:[{selector:"textarea[appAutoSize]",exportAs:"appAutoSize"}]}],t.ctorParameters=function(){return[{type:e.ElementRef}]},t.propDecorators={minHeight:[{type:e.Input,args:["minHeight"]}],maxHeight:[{type:e.Input,args:["maxHeight"]}],onResize:[{type:e.HostListener,args:["window:resize"]}],onInput:[{type:e.HostListener,args:["input"]}]},t}();var T=function(){function t(t){this._el=t,this.usercode=iNet.username}return t.prototype.ngOnInit=function(){this._el.nativeElement.addEventListener("error",this._loadAvatarError.bind(this)),this._setAvatar()},t.prototype.ngOnChanges=function(){this._setAvatar()},t.prototype._setAvatar=function(){this.usercode?this._el.nativeElement.src=iNet.getUrl("system/userprofile/photo")+"?usercode="+encodeURIComponent(this.usercode):this._loadAvatarError()},t.prototype._loadAvatarError=function(){this._el.nativeElement.src=j.DEFAULT_AVATAR_URL},t.decorators=[{type:e.Directive,args:[{selector:"img[userAvatar]"}]}],t.ctorParameters=function(){return[{type:e.ElementRef}]},t.propDecorators={usercode:[{type:e.Input}]},t}();var B=function(){function t(){this._loaded=[],this._version=""}return t.prototype.load=function(t,e){if(t.length<1)return e();this._loadResources(t,e)},t.prototype.loadJS=function(t,e){this._loadWithTagName("script",{type:"text/javascript",src:this.getFullUrlJS(t)},e)},t.prototype.loadCSS=function(t,e){this._loadWithTagName("link",{type:"text/css",rel:"stylesheet",href:t},e)},t.prototype.getFullUrlJS=function(t){return t.indexOf("//")<0&&iNet.fileServer?(t.startsWith("/")&&(t=t.substr(1,t.length)),iNet.fileServer+t):t},t.prototype.isLoaded=function(t){return this._loaded.indexOf(t)>-1},t.prototype._loadResources=function(t,e){var n=this,r=this._groupResources(t),o=function(){if(r.length<1)return e();n._loadGroups(r.splice(0,1)[0],o)};o()},t.prototype._groupResources=function(t){for(var e,n=[],r=0;r<t.length;r++)e||(e=[],n.push(e)),e.push(t[r]),t[r].sync&&(e=null);return n},t.prototype._loadGroups=function(t,e){var n=this,r=[];t.forEach((function(t){return r.push(n._load(t))})),Promise.all(r).then((function(){e()}))},t.prototype._load=function(t){var e=this;return new Promise((function(n){"css"===t.type?e.loadCSS(t.url,n):e.loadJS(t.url,n)}))},t.prototype._loadWithTagName=function(t,e,n){var r=this,o=e.src||e.href;if(this.isLoaded(o))return n();var i=document.createElement(t);for(var s in e)i[s]=e[s];i.onload=function(){r._loaded.push(o),n()},i.onerror=function(t){console.warn("Load resource error: "+o),console.warn(t),r._loaded.push(o),n()},document.head.appendChild(i)},t.prototype._initScriptVersion=function(){for(var t=$("script"),e=0;e<t.length;e++){var n=t[e].src,r=n.indexOf("?version=");if(r>-1){this._version=n.substr(r+1,n.length);break}}},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[]},t}();function Q(t){return function(){return t.load()}}var J=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[c.CommonModule,r.HttpClientModule],declarations:[U,b,H,T,w],exports:[U,b,H,T,w],providers:[g,y,_,k,j,D,B,{provide:e.APP_INITIALIZER,useFactory:Q,multi:!0,deps:[C]},C,h]}]}],t}(),M=function(){function t(t,e){this.onMessage=new n.Subject,this.onStateChange=new n.Subject,this.connect(t,e)}return t.prototype.stateChange=function(){this.onStateChange.next(this.readyState)},t}();var W={SEND:"send",PUBLISH:"publish"},L=function(){this.type=W.PUBLISH};var V=function(){};var q=function(t,e,n,r){this.content=this.alert=e,this.sender=t,n&&(this.joins=n||t),this.duration=r||"0"};var F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._socket?this._socket.readyState:null},enumerable:!0,configurable:!0}),e.prototype.stateChange=function(){this.readyState===WebSocket.OPEN&&this._ping(),t.prototype.stateChange.call(this)},e.prototype.connect=function(t,e){var n=this;this._socket=new WebSocket(t),this._socket.onmessage=function(t){var e=JSON.parse(t.data);e.sender&&n.onMessage.next(e)},this._socket.onopen=function(){return n.stateChange()},this._socket.onerror=function(){return n.stateChange()},this._socket.onclose=function(){return n.stateChange()}},e.prototype.close=function(){this._socket.close()},e.prototype.send=function(t){var e=this;return new Promise((function(n){try{e._socket.send(JSON.stringify(t)),n(!0)}catch(t){n(!1),console.warn("Send message failed",t)}}))},e.prototype._ping=function(){var t=this;this.readyState===WebSocket.OPEN&&(this._socket.send(JSON.stringify({type:"ping"})),setTimeout((function(){return t._ping()}),1e4))},e}(M);var K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._eventbus?this._eventbus.state:null},enumerable:!0,configurable:!0}),e.prototype.connect=function(t,e){if(t&&2===t.length){var n=t[0],r={keyapi:t[1]};this._connect(n,r,e)}},e.prototype._connect=function(t,e,n){var r=this;this._eventbus=new u(t,{transports:"websocket"}),this._eventbus.onopen=function(){r._eventbus.registerHandler(n,e,(function(t,e){e&&r.onMessage.next(e.body)})),r.stateChange()},this._eventbus.onclose=function(){return r.stateChange()},this._eventbus.onerror=function(){return r.stateChange()}},e.prototype.close=function(){this._eventbus.close()},e.prototype.send=function(t){var e=this;return new Promise((function(n){try{e._eventbus.publish(t.address,t.body),n(!0)}catch(t){n(!1),console.warn("Send message failed",t)}}))},e}(M);var z=function(){function t(){var e=this;return this.onMessage=new n.Subject,this.onStateChange=new n.Subject,this.sendTimeout=3e4,this._autoconnectAfter=5e3,this._autoconnectRepeat=4,this._autoconnectRetryAfter=3e4,this._envelopQueue=[],t.instance||this._getAccountInfo((function(){return e._register()})),t.instance=t.instance||this}return Object.defineProperty(t.prototype,"readyState",{get:function(){return this.socket?this.socket.readyState:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connecting",{get:function(){return this.readyState===WebSocket.CONNECTING||null===this.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connected",{get:function(){return this.readyState===WebSocket.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closing",{get:function(){return this.readyState===WebSocket.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closed",{get:function(){return this.readyState===WebSocket.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoconnect",{get:function(){return this._autoconnect},enumerable:!0,configurable:!0}),t.prototype.close=function(){this.socket.close()},t.prototype.send=function(t,e,n){return void 0===n&&(n=""),this.sendEnvelop(this.buildEnvelop(t,e,n))},t.prototype.sendEnvelop=function(t){var e=this;return this.connected?this.socket.send(t):new Promise((function(n){var r={e:t,f:n};r.timer=setTimeout((function(){return e._completeEnvelopQueue(r,!1)}),e.sendTimeout),e._envelopQueue.push(r)}))},t.prototype.buildEnvelop=function(t,e,n,r){void 0===n&&(n="");var o=new L;return o.address=t,o.body=new V,o.body.application=n,o.body.sender=this._username,o.body.alias=[t],o.body.message=new q(this._username,e,r||""),o},t.prototype._sendEnvelopQueue=function(){var t=this;this._envelopQueue.forEach((function(e){t.sendEnvelop(e.e).then((function(n){return t._completeEnvelopQueue(e,n)}))}))},t.prototype._completeEnvelopQueue=function(t,e){var n=this._envelopQueue.indexOf(t);n>=0&&this._envelopQueue.splice(n,1),t.f(e)},t.prototype._register=function(t){var e=this;$.ajax({url:iNet.getPUrl("account/register"),success:function(n){e.socket="string"==typeof n?new F(n,e._username):new K(n,e._username),e.socket.onStateChange.subscribe((function(){return e._stateChange()})),e.socket.onMessage.subscribe((function(t){e.onMessage.next(t)})),t&&t()},error:function(){throw t&&t(),new Error("Account register error")}})},t.prototype._getAccountInfo=function(t){var e=this;if(this._username)return t(this._username);$.ajax({url:iNet.getPUrl("system/userprofile/view"),success:function(n){e._username=n&&n.user&&(n.user.usercode||n.user.username)||"",t(e._username)},error:function(){return t(null)}})},t.prototype._stateChange=function(){this.closed&&!this.autoconnect&&this._runAutoConnect(),this._autoconnect||(this.connected&&this._sendEnvelopQueue(),this._cancelAutoConnect(),this.onStateChange.next())},t.prototype._runAutoConnect=function(){var t=this;this._autoconnect=!0,this._autoconectTimer=setTimeout((function(){if(!t.connected)return t._autoconectCount>=t._autoconnectRepeat?(t._cancelAutoConnect(),void setTimeout((function(){return t._runAutoConnect()}),t._autoconnectRetryAfter)):void t._register((function(){t._autoconectCount++,t.connected||t._runAutoConnect()}));t._cancelAutoConnect()}),this._autoconnectAfter)},t.prototype._cancelAutoConnect=function(){this._autoconnect=!1,this._autoconectCount=0,clearTimeout(this._autoconectTimer)},t.instance=null,t}();var Y=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return l(n,t),n.decorators=[{type:e.Injectable}],n}(z),G=function(){function t(){}return t.formatHtmlDisplay=function(e){return e.replace(t.formatPattern,"<br>")},t.formatPattern=new RegExp("(\\n)|(\\\\n)|(\\\\\\\\n)|↵","g"),t}();t.AccentService=k,t.AutoSizeDirective=H,t.AvatarDirective=T,t.CacheStorageService=D,t.CoreModule=J,t.CoreService=g,t.EnvelopBody=V,t.EnvelopMessage=q,t.ErrorMessage={CLIENT:"Client-side error occurred",SERVER:"Server-side error occurred",TYPE:"ERROR"},t.ErrorResponse=E,t.HtmlUtils=G,t.HttpClientService=y,t.HttpUrlEncodingCodec=A,t.InfiniteScrollerDirective=b,t.LoadingIndicator=f,t.LoadingIndicatorService=h,t.NewPassword=S,t.NotificationService=_,t.NotifyParams=I,t.Paging=P,t.ResourceLoaderService=B,t.ResponseData=O,t.ResponseElementsData=N,t.RoleAccessDirective=U,t.SSOUrlPipe=w,t.SecurityService=C,t.SuggestionService=m,t.UserProfile=x,t.UserProfileService=j,t.UserResponseData=R,t.WebSocketAbstract=M,t.WebSocketClient=z,t.WebSocketClientService=Y,t.WebSocketEnvelop=L,t.WebSocketJboss=F,t.WebSocketType=W,t.WebSocketVertx=K,t.initApp=Q,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=inet-core.umd.min.js.map